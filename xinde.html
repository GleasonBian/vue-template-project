<!--
 * @Description: 
 * @Author: gleason
 * @Github: https://github.com/GleasonBian
 * @Date: 2020-05-13 13:04:45
 * @LastEditors: OBKoro1
 * @LastEditTime: 2020-05-13 13:06:26
 -->
<!DOCTYPE html">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <base href="http://114.215.194.254:89/mygpsonline/" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>位置信息服务平台</title>
  <link rel="Shortcut icon" href="/mygpsonline/gpsonline/image/pic/logo.ico" type="image/x-icon" />
  <link rel="stylesheet" href="/mygpsonline/gpsonline/css/monitor/user/monitor.css" />
  <link rel="stylesheet" href="/mygpsonline/gpsonline/css/monitor/zTreeStyle.css" />
  <link rel="stylesheet" href="/mygpsonline/gpsonline/css/monitor/user/marker.css" />
  <link rel="stylesheet" href="/mygpsonline/gpsonline/css/monitor/user/userframe-c.css" />
  <link rel="stylesheet" href="/mygpsonline/gpsonline/css/monitor/v3/global.css" />
  <link rel="stylesheet" href="/mygpsonline/gpsonline/css/monitor/marker.css" type="text/css" />
  <link href="/mygpsonline/gpsonline/css/jquery-ui-1.10.3.custom.css" rel="stylesheet">
  <link rel="stylesheet" href="/mygpsonline/gpsonline/css/monitor/user/guanli.css" />
  <link rel="stylesheet" type="text/css" href="/mygpsonline/gpsonline/dingzhi/dingzhi.css" />
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/jquery-1.4.4.min.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/util/ajaxUtils.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/jquery.cookie.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/language.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/json2.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/marker/jquery.ztree.core-3.5.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/marker/jquery.ztree.excheck-3.5.min.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/marker/jquery.ztree.exedit-3.5.min.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/util/map.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/main/main.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/monitor/vhcTreeShowClient.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/monitor/monitor.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/inputsearch1.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/report/report.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/marker/marker.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/marker/markerMenu.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/marker/markersearch.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/jquery-ui-1.10.3.custom.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/monitor/mousewheel.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/streeView.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/electronicFence.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/fencesearch.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/shefang.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/vhcImg.js"></script>
  <script type="text/javascript" src="/mygpsonline/gpsonline/js/calendar/My97DatePicker/WdatePicker.js"></script>
  <script charset="utf-8"
    src="http://map.qq.com/api/js?v=2.exp&key=PDOBZ-YSJRS-U4WOK-6SFWT-LMMM2-TSFJP&libraries=convertor"></script>
  <!--
		   -->
  <script type="text/javascript">
    var basePath_ = "http://114.215.194.254:89/mygpsonline/";
    var basePath_ZH = "http://114.215.194.254:89/mygpsonline/gpsonline";
    var isEmbeddedPage = false;//用来表示此页面是内嵌监控页面
    String.prototype.trim = function () {
      return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
    }

    $("#open_right").hide();
    function closeleft() {
      $("#leftFrameCanvas").addClass("leftFrameCanvas_1");
      //$("#leftFrameCanvas").hide();
      //$("#rightFrameCanvas").css("left",0);
      $("#rightFrameCanvas").css("left", 400);
      $("#open_right").show();
      $("#open_left").hide();
      $("#open_right").css("left", 100);
      try {
        google.maps.event.trigger(map, 'resize');
      } catch (e) { }
    }
    function openleft() {
      $("#leftFrameCanvas").show();
      $("#leftFrameCanvas").removeClass("leftFrameCanvas_1");
      $("#leftFrameCanvas").addClass("leftFrameCanvas");
      $("#rightFrameCanvas").css("left", 300);
      $("#open_right").hide();
      $("#open_left").show();
      try {
        google.maps.event.trigger(map, 'resize');
      } catch (e) { }
    }
    (function ($) {
      jQuery.fn.center = function () {
        this.css('position', 'absolute');
        this.css('top', ($(window).height() - this.height()) / 2 + $(window).scrollTop() + 'px');
        this.css('left', ($(window).width() - this.width()) / 2 + $(window).scrollLeft() + 'px');
        return this;
      }
      jQuery.fn.queryCenter = function () {
        this.css('position', 'absolute');
        this.css('top', ($(window).height() - this.height()) / 2 + $(window).scrollTop() + 'px');
        this.css('left', ($(window).width() - this.width()) / 2 + $(window).scrollLeft() + 'px');
        return this;
      }
    })(jQuery);  //调用：$("#macoArea").center();
    $(function () {
      $(".list_main").height($(window).height() - ($(".main_top").height() + $(".idx_top").height()) - 20);

    });
    var managerIframe = null;	
  </script>
  <style>
    .label-icon {
      position: absolute;
      right: 25px;
      top: 90px;
    }

    #markerImagesrc.on {
      border-color: #999999 #999999 #FFFFFF;
      background-position: center;
    }

    #markerImagesrc {
      background-color: #FFFFFF;
      border: 1px solid #FFFFFF;
      display: inline-block;
      height: 34px;
      position: relative;
      width: 32px;
      z-index: 99;
      background: no-repeat;
      background-position: center;
    }

    #label-icon-list {
      background: none repeat scroll 0 0 #FFFFFF;
      border: 1px solid #999999;
      display: none;
      padding-bottom: 8px;
      position: absolute;
      right: 0;
      top: 32px;
      width: 300px;
      height: 120px;
      z-index: 9;
      overflow-y: auto;
      overflow-x: hidden;
    }

    ul {
      list-style-type: none;
    }

    #label-icon-list li {
      display: inline-block;
      float: left;
      margin: 3px;
      padding: 0;
    }

    li img {
      width: 27px;
      height: 27px;
      display: block;
    }

    div#electronicFence_tree_Menu {
      position: absolute;
      visibility: hidden;
      top: 0;
      background-color: #fff;
      text-align: left;
      padding: 2px;
      border: 1px solid #ccc;
      width: 80px;
    }

    div#electronicFence_tree_Menu ul li {
      margin: 1px 0;
      padding: 0 5px;
      cursor: pointer;
      list-style: none outside none;
      text-align: center;
    }

    /*.secondMenus li { padding:2px 5px; color:gray}*/

    .div#electronicFence_tree_Menu .lihover {
      color: #f00;
    }

    #markerGroupTree a {
      text-decoration: none;
    }

    #electronicFence_tree a {
      text-decoration: none;
    }


    div#marker_tree_Menu {
      position: absolute;
      visibility: hidden;
      top: 0;
      background-color: #fff;
      text-align: left;
      padding: 2px;
      border: 1px solid #ccc;
      width: 80px;
    }

    div#marker_tree_Menu ul li {
      margin: 1px 0;
      padding: 0 5px;
      cursor: pointer;
      list-style: none outside none;
      text-align: center;
    }

    /*.secondMenus li { padding:2px 5px; color:gray}*/

    .div#marker_tree_Menu .lihover {
      color: #f00;
    }

    /*报警信息表格分隔行信息样式*/
    .alarmrow0 td {
      background-color: #fff;
      font-weight: normal
    }

    .alarmrow1 td {
      background-color: #eee;
      font-weight: normal
    }

    /*报警信息表格分隔行信息样式*/
  </style>

  <style type="text/css">
    body {
      font-size: 12px;
    }

    .tanchukuang_wrap {
      background: #fff;
      border: 1px solid #afaeae;
      overflow: hidden;
    }

    .tanchukuang_wrap h3 {
      background: url(/mygpsonline/gpsonline/image/areaQueryVehicle/title_bg.gif) repeat-x;
      height: 33px;
      border-bottom: 1px solid #d7d7d7;
      font-size: 12px;
      margin: 0px;
      padding: 0px;
      line-height: 33px;
      color: #575757;
      padding-left: 10px;
      padding-right: 5px;
    }

    .tanchukuang_close {
      background: url(/mygpsonline/gpsonline/image/areaQueryVehicle/close.gif) no-repeat;
      width: 14px;
      height: 13px;
      display: block;
      float: right;
      margin-top: 10px;
    }

    .tanchukuang_main {
      color: #737373;
      line-height: 25px;
      font-weight: normal;
      padding: 10px 5px 10px 15px;
    }

    .box {
      width: 800px;
    }

    #obdinfo ul li {
      float: left;
      width: 50%
    }
  </style>

</head>

<body debug="false">
  <input type="hidden" id="zMsg" name="zMsg" value="null" />
  <input type="hidden" id="isFull" name="isFull" value="true" />
  <input type="hidden" id="serverip" value="114.215.194.254:89" />
  <input type="hidden" id="usertypeId" value="2" />
  <input type="hidden" id="userId" value="2547053" />
  <input type="hidden" id="uP" value="6e03a39847c297813d3d80a1935efd89                  " />
  <input type="hidden" id="uN" value="zczw" />
  <input type="hidden" id="serverUrl" value="http://114.215.194.254:89/mygpsonline/" />

  <input type="hidden" id="serverId" value="12150" />
  <div class="container">
    <b class="con_a">
      <b class="con_b">
        <div class="con_c">
          <!--top-->
          <div class="idx_top" id="idx_top" style="display:none">
            <!--header-->
            <div id="header">
              <div class="top">
                <b class="top_bg">
                  <!--logo-->
                  <div class="logo"></div>
                  <!--logo end-->

                  <!--right-->
                  <div class="site_bga">
                    <b class="site_bgb">
                      <ul class="site_links">
                        <li><var key="hello">您好</var>,<b><a href="javascript:;">zczw</a>[<span
                              id='userType'>&nbsp;</span>]</b></li>
                        <li class="sep">|</li>
                        <li><a href="javascript:openUpdatePwdWin();" title="修改密码">修改密码</a></li>
                        <li class="sep">|</li>

                        <li><a href="javascript:setSystemObject.openWin(0);"><var key="setSystem">设置</var></a></li>
                        <li class="sep">|</li>
                        <li><a href="javascript:openPopuWin('/mygpsonline/gpsonline/jsp/suggestWin.jsp');"><var
                              key="suggest">意见反馈</var></a></li>
                        <li class="sep">|</li>
                        <li><a href="javascript:outSys();"><var key="Exit">退出</var></a></li>
                      </ul>
                    </b>
                  </div>
                  <!--right end-->
                </b>
              </div>
            </div>
            <!--header end-->
            <!--menu-->
            <div id="nav_wrap">
              <ul id="nav">
                <!-- 定位监控 -->
                <li id="menu_track" class="current"><span><a href="javascript:;" style="text-decoration: none;"
                      hidefocus="hidefocus"><var key="menu_monitor">定位监控</var></a></span></li>
                <!-- 统计报表 -->
                <li id="menu_report"><span><a href="javascript:;" style="text-decoration: none;"
                      hidefocus="hidefocus"><var key="menu_report">统计报表</var></a></span></li>
                <!-- 设备管理 -->
                <li id="menu_manager" style="display: none;"><span><a href="javascript:;" style="text-decoration: none;"
                      hidefocus="hidefocus"><var key="menu_pro">后台管理</var></a></span></li>
              </ul>
            </div>
            <!--menu end-->
          </div>
          <!--top end-->
          <!--report开始-->
          <iframe id="report" name="report" src=""
            style="width:100%;height:100%;display:none;top:40px; position: absolute;" frameborder="0"></iframe>
          <!--report结束->
			   <!--product开始-->
          <iframe id="manager" name="manager" src="" style="width: 100%;height:100%;display:none;right: 3px;"
            frameborder="0"></iframe>
          <!--product结束->
                <!--main-->
          <div class="pageShowCanvas" id="index_main" style='top: 0px;top: 0px !important;'>
            <!--left-->
            <div id="leftFrameCanvas" class="leftFrameCanvas">
              <!-- 用户树 -->
              <div class="mod-prolist">
                <!--top-->
                <div class="main_top">
                  <!-- 过滤按钮 -->
                  <div class="navigate" id="myNavigate">
                    <ul>
                      <li class="navigate_item navigate_item_over" onclick="allEquipment(this);">
                        <span class="r">
                          <a href="javascript:;">
                            <div class="idx_ico_all"></div>
                            <var key="all">全部</var>(<span id="allcount"></span>)
                          </a> </span>
                      </li>
                      <li class="navigate_item" onclick="onlineEquipment(this);">
                        <span class="r">
                          <a href="javascript:;">
                            <div class="idx_ico_online"></div>
                            <var key="online">
                              在线
                            </var>(<span id="onlinecount"></span>)
                          </a>
                        </span>
                      </li>
                      <li class="navigate_item" onclick="unlineEquipment(this);">
                        <span class="r">
                          <a href="javascript:;">
                            <div class="idx_ico_offline"></div>
                            <var key="offline">
                              离线
                            </var>(<span id="unlinecount"></span>)
                          </a>
                        </span>
                      </li>
                    </ul>
                  </div>
                  <!-- 过滤 end -->
                  <!-- 设备搜索： -->
                  <div class="searchcvs">
                    <div class="ctnr">
                      <div style="float:left;">
                        <input value="设备ID/名称/SIM/分组/客户" name="searchinput" autocomplete="off" id="searchinput"
                          class="searchinput" onfocus="searchFocus(this)" onblur="searchBlur(this)" type="text" />
                      </div>
                      <div class="suggest" onmouseout="isSearchFocus = false;" onclick="viewSearchListAll()"></div>
                      <div class="car_type_lianxiang">
                        <div style="display: none;" id="searchListOutCanvas"><span>...</span></div>
                      </div>
                    </div>
                  </div>
                  <!-- 设备搜索 end -->
                </div>
                <!--top end-->
                <!--列表容器-->
                <input type="hidden" id="elSelected" value="" />
                <div class="list_main" id="leftList" onselectstart="return false">
                  <dl class="accordion" id="group" style="width: 97%; font-weight:normal;"></dl>
                </div>
              </div>
            </div>
            <!--left end-->

            <!--middle-->
            <div class="middle_shousuo">
              <a href="javascript:;" class="open_right" id="open_right" style="display: none;"
                onclick="openleft();"></a>
              <a href="javascript:;" onclick="closeleft();" class="open_left" id="open_left"></a>
            </div>
            <!--middle end-->

            <!--right-->
            <div id="rightFrameCanvas">
              <!--标注-->
              <div class="marker_wrap">
                <!--open-->
                <div class="marker_open" style="display: none;" id="biaozhu_open">
                  <!--top-->
                  <div class="marker_open_top">
                    <a class="marker_open_close" href="javascript:close()">
                      <span></span>
                    </a>
                    <div class="marker_title">
                      <a href="javascript:electronicFence.tree.hide();" class="ico_marker"></a>
                      <a href="javascript:electronicFence.tree.show();" class="ico_weilan" id="ico_weilan"
                        style="display: none;"></a>
                    </div>
                    <div id="marker_dot" class="marker_dot"></div>
                  </div>
                  <!--top end-->

                  <div class="marker_main_bg"></div>
                  <div class="marker_main">
                    <div style="position: absolute;">
                      <ul>
                        <li id="marker_pane">
                          <div class="marker_search marker_line">
                            <!-- 标注搜索开始： -->
                            <div class="searchcvs">
                              <div class="ctnr">
                                <div style="float:left;">
                                  <input value="请输入标注名称" style="width:160px;" name="markersearchinput"
                                    autocomplete="off" id="markersearchinput" class="searchinput"
                                    onfocus="markersearchFocus(this)" onblur="markersearchBlur(this)" type="text" />
                                </div>
                                <div class="suggest" onmouseout="ismarkerSearchFocus = false;"
                                  onclick="markerviewSearchListAll()"></div>
                                <div style="clear:left;width:200px;">
                                  <div
                                    style="display: none;position: absolute;background: #FFF; width: 207px;height: 200px; margin-left: -10px; border: 1px solid #95BCF0; margin-top: 3px;overflow: auto;"
                                    id="markersearchListOutCanvas"><span>...</span></div>
                                </div>
                              </div>
                              <!-- 标注搜索结束： -->
                            </div>
                          </div>
                          <div id="markerGroupTreeCanvas" style="width: 220px; height: 388px; overflow-y: auto;">
                            <ul id="markerGroupTree" class="ztree"></ul>
                          </div>
                        </li>
                        <li id="electronicFence_pane" style="display: none;">
                          <div class="marker_search marker_line">
                            <!-- 标注搜索开始： -->
                            <div class="searchcvs">
                              <div class="ctnr">
                                <div style="float:left;">
                                  <input value="请输入围栏名称" style="width:160px;" name="fencesearchinput" autocomplete="off"
                                    id="fencesearchinput" class="searchinput" onfocus="fencesearchFocus(this)"
                                    onblur="fencesearchBlur(this)" type="text" />
                                </div>
                                <div class="suggest" onmouseout="isfenceSearchFocus = false;"
                                  onclick="fenceviewSearchListAll()"></div>
                                <div style="clear:left;width:200px;">
                                  <div
                                    style="display: none;position: absolute;background: #FFF; width: 207px;height: 200px; margin-left: -10px; border: 1px solid #95BCF0; margin-top: 3px;overflow: auto;"
                                    id="fencesearchListOutCanvas"><span>...</span></div>
                                </div>
                              </div>
                              <!-- 标注搜索结束： -->
                            </div>
                          </div>
                          <div id="electronicFence_tree_canvas" style="width: 220px; height: 388px; overflow-y: auto;">
                            <ul id="electronicFence_tree" class="ztree"></ul>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <!--open end-->

                <!--close-->
                <a class="marker_close" style="display: block;" href="javascript:openMarkerPanel();" id="biaozhu_close">
                  <span></span>
                </a>
                <!--close end-->
              </div>
              <!--标注 end-->
              <div id="map_div">



                <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
                <html>

                <head>
                  <base href="http://114.215.194.254:89/mygpsonline/">
                  <title></title>
                  <meta http-equiv="pragma" content="no-cache">
                  <meta http-equiv="cache-control" content="no-cache">
                  <meta http-equiv="expires" content="0">
                  <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
                  <meta http-equiv="description" content="This is my page">
                  <style type="text/css">
                    #map_canvas {
                      height: 100%
                    }

                    #container {
                      height: 100%
                    }
                  </style>
                  <!--加载百度地图-->
                  <script type="text/javascript"
                    src="http://api.map.baidu.com/api?v=2.0&amp;ak=WVbVv3GM8fFnj8nwe1xNVMOc"></script>
                  <script type="text/javascript"
                    src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
                  <script type="text/javascript"
                    src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>

                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/baiduMap/baiduMap.js"></script>
                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/baiduMap/Menu.js"></script>

                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/language.js"></script>
                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/url.js"></script>

                  <!--加载谷歌地图-->
                  <script type="text/javascript"
                    src="http://ditu.google.cn/maps/api/js?sensor=false&libraries=drawing&key=AIzaSyDZis631eei5VArZqB-lP2DDOSgPrhLR5A"></script>
                  <script type="text/javascript"
                    src="http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=js"></script>

                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/monitor/infobox.js"></script>
                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/distance.js"></script>
                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/areaQuery.js"></script>
                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/tool/baiduAreaQuery.js"></script>
                  <script type="text/javascript" src="/mygpsonline/gpsonline/js/MianMap/MianMap.js"></script>
                  <!--加载高德地图 
    <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=311f25d6868ca0039f68575345df8e04"></script>
  	<script type="text/javascript" src="/mygpsonline/gpsonline/js/gaode/gaode.js"></script>-->
                  <script type="text/javascript">
                    var map;
                    var markersArray = [];
                    var id;
                    var msgid;
                    var msgname;
                    var url;
                    var carList;
                    var carIds = [];
                    var infowindow2;
                    var infowindowArray = [];
                    var vehicles = [];
                    var setT;
                    var alSwitch = false;
                    var drag = false;
                    var getType = "";
                    var num_s = 10;
                    function MapData() {
                      if (map) {
                        if (map.getBounds()) {
                          closeMask();
                          clearTimeout(setT);
                          if (alSwitch == false) {
                            alSwitch = true;
                            if (getType != "-1") {
                              countDown();    //每隔15秒执行函数al
                            }
                          }
                          google.maps.event.addListener(map, 'drag', function () {
                            clearTimeout(yanchiAl);
                            yanchiAl = setTimeout("al()", 500);
                          });
                        } else {
                          setTimeout("MapData()", 100);
                        }
                      } else {
                        setTimeout("MapData()", 100);
                      }
                    }
                    var pageIdArray = [];
                    var pageTimeArray = [];
                    function initialize(ids) {
                      if (alSwitch == false) {
                        countDown();    //每隔15秒执行函数al
                        alSwitch = true;
                      } // 172
                      num_s = getRefreshTime();
                      if (pagingRefreshObject.isPaging) {
                        var remainder = pagingRefreshObject.total % pagingRefreshObject.pageSize;
                        var shang = pagingRefreshObject.total / pagingRefreshObject.pageSize;
                        if (remainder > 0) {
                          shang++;
                        }
                        shang = Math.floor(shang);
                        for (var i = 0; i < shang; i++) {
                          var pageId = new Object();
                          if (remainder > 0 && i == shang - 1) {
                            pageId.min = i * pagingRefreshObject.pageSize;
                            pageId.max = remainder + 1;
                          } else {
                            pageId.min = i * pagingRefreshObject.pageSize;
                            pageId.max = pagingRefreshObject.pageSize;
                          }
                          pageIdArray.push(pageId);
                          pageTimeArray.push(0);
                        }
                      }
                      url = "http://114.215.194.254:89/mygpsonline/";
                      var obj = null;
                      if (obj != null) {
                        if (obj.mapType > 0) {
                          mapType = obj.mapType;
                        }
                      }

                      var weizhi_ = document.getElementById("weizhi");
                      var clientWidth = document.documentElement.clientWidth;
                      if (clientWidth > 865) {
                        weizhi_.style.width = clientWidth - 865 + "px";
                      }


                      var lat;
                      var lng;
                      setT = setTimeout("MapData()", 100);
                      if (ids == "") {
                        setTimeout("initialize(cartIds)", 5000);
                      } else if (ids == "-1") {
                        getType = "-1";
                        var mapOptions = {
                          center: new google.maps.LatLng(31.23, 121.47),
                          zoom: 4,
                          mapTypeId: google.maps.MapTypeId.ROADMAP,
                          mapTypeControlOptions: {
                            mapTypeIds: [google.maps.MapTypeId.ROADMAP, google.maps.MapTypeId.HYBRID, google.maps.MapTypeId.SATELLITE, "MAPabc"]
                          }
                        };
                        map = new google.maps.Map(document.getElementById("map_canvas"),
                          mapOptions);

                        addMAPabc(map);
                        var geocoder = new google.maps.Geocoder();
                        geocoder.geocode({ 'address': remote_ip_info.city }, function (results, status) {
                          if (status == google.maps.GeocoderStatus.OK) {
                            map.setCenter(results[0].geometry.location);
                            map.setZoom(8);
                          } else {
                            //alert("Geocode was not successful for the following reason: " + status); 
                          }
                        });
                      } else if (ids == "thresholds") {
                        if (mapType == 1) {
                          baiduMap("thresholds", true);
                          if (findbsCookie("isShowCarName") == true) {
                            $("#isShowCarName").attr("checked", true);
                            namekg = true;
                            showCarName();
                          }
                          if (markerObject.markerJson != null && markerObject.markerJson != "") {
                            showMarkerBaidu(markerObject.markerJson);
                          }
                          var myselect = document.getElementById("select");
                          myselect.options[0].selected = true;

                          closeMask();
                          clearTimeout(setT);

                        } else {
                          var mapOptions = {
                            center: new google.maps.LatLng(31.23, 121.47),
                            zoom: 4,
                            mapTypeId: google.maps.MapTypeId.ROADMAP,
                            mapTypeControlOptions: {
                              mapTypeIds: [google.maps.MapTypeId.ROADMAP, google.maps.MapTypeId.HYBRID, google.maps.MapTypeId.SATELLITE, "MAPabc"]
                            }
                          };
                          map = new google.maps.Map(document.getElementById("map_canvas"),
                            mapOptions);

                          addMAPabc(map);
                          var geocoder = new google.maps.Geocoder();
                          geocoder.geocode({ 'address': remote_ip_info.city }, function (results, status) {
                            if (status == google.maps.GeocoderStatus.OK) {
                              map.setCenter(results[0].geometry.location);
                              map.setZoom(8);
                            } else {

                            }
                          });
                        }
                        if (alSwitch == false) {
                          alSwitch = true;
                          countDown();    //每隔15秒执行函数al

                        }
                        /*
                      $.ajax({
                            type: "POST",
                            dataType: "json",
                            url: "json/vehicleAction_byids.action",
                            data: {ids:-1},
                            success: function(data){
                          	
                            //reEquipmentStatus(data);
                        },
                            error: function() {
                            }
                          });
                          */
                      } else {
                        $.ajax({
                          type: "POST",
                          dataType: "json",
                          url: "json/vehicleAction_byids.action",
                          data: { ids: -1 },
                          success: function (data) {
                            if (data.flag == true) {
                              carList = data;
                              id = ids;
                              idsData = ids;
                              if (typeof (google) == "undefined") {
                                mapType = 1
                                $("#select").hide();
                              }
                              if (mapType == 1) {
                                baiduMap(idsData, true);
                                if (markerObject.markerJson != null && markerObject.markerJson != "") {
                                  showMarkerBaidu(markerObject.markerJson);
                                }
                                var myselect = document.getElementById("select");
                                myselect.options[0].selected = true;
                                if (findbsCookie("isShowCarName") == true) {
                                  $("#isShowCarName").attr("checked", true);
                                  namekg = true;
                                  showCarName();
                                }
                              } else {
                                for (i = 0; i < data.data.length; i++) {
                                  if (data.data[i].positionLast.lat != 0 && data.data[i].positionLast.lng != 0) {
                                    lat = data.data[i].positionLast.lat;
                                    lng = data.data[i].positionLast.lng;
                                    break;
                                  }
                                }
                                if (lat == null && lng == null) {
                                  var mapOptions = {
                                    center: new google.maps.LatLng(31.23, 121.47),
                                    zoom: 4,
                                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                                    mapTypeControlOptions: {
                                      mapTypeIds: [google.maps.MapTypeId.ROADMAP, google.maps.MapTypeId.HYBRID, google.maps.MapTypeId.SATELLITE, "MAPabc"]
                                    }
                                  };
                                  map = new google.maps.Map(document.getElementById("map_canvas"),
                                    mapOptions);

                                  addMAPabc(map);

                                  var geocoder = new google.maps.Geocoder();
                                  geocoder.geocode({ 'address': remote_ip_info.city }, function (results, status) {
                                    if (status == google.maps.GeocoderStatus.OK) {
                                      map.setCenter(results[0].geometry.location);
                                      map.setZoom(8);
                                    } else {
                                      //alert("Geocode was not successful for the following reason: " + status); 
                                    }
                                  });
                                } else {
                                  if (alSwitch == false) {
                                    alSwitch = true;
                                    countDown();    //每隔15秒执行函数al

                                  }
                                  //var obj = getUserStatus();
                                  var zoom;
                                  if (obj == null) {
                                    mapOptions = {
                                      center: new google.maps.LatLng(lat, lng),
                                      zoom: 10,
                                      mapTypeId: google.maps.MapTypeId.ROADMAP,
                                      mapTypeControlOptions: {
                                        mapTypeIds: [google.maps.MapTypeId.ROADMAP, google.maps.MapTypeId.HYBRID, google.maps.MapTypeId.SATELLITE, "MAPabc"]
                                      }
                                    };
                                  } else {
                                    if (obj.gzoom == "" || obj.gzoom == null) {
                                      zoom = 6;
                                    } else {
                                      zoom = obj.gzoom;
                                    }
                                    mapOptions = {
                                      center: new google.maps.LatLng(obj.lat, obj.lng),
                                      zoom: zoom,
                                      mapTypeId: google.maps.MapTypeId.ROADMAP,
                                      mapTypeControlOptions: {
                                        mapTypeIds: [google.maps.MapTypeId.ROADMAP, google.maps.MapTypeId.HYBRID, google.maps.MapTypeId.SATELLITE, "MAPabc"]
                                      }
                                    };
                                  }

                                  map = new google.maps.Map(document.getElementById("map_canvas"),
                                    mapOptions);
                                  addMAPabc(map);

                                  google.maps.event.addListener(map, 'bounds_changed', function () {
                                    drag = true;
                                  });
                                  for (i = 0; i < data.data.length; i++) {
                                    (function (x) {
                                      var myLatlng = new google.maps.LatLng(data.data[x].positionLast.lat, data.data[x].positionLast.lng);

                                      var s = 10;
                                      var condition = data.data[x].positionLast.state2;
                                      var sp = parseInt(data.data[x].positionLast.speed);
                                      if (condition != null) {
                                        if (condition.indexOf("不在线") >= 0 || condition.indexOf("掉线") >= 0)
                                          s = 2;
                                        else {
                                          if (condition.indexOf("速报警") >= 0)
                                            s = 4;
                                          else if (condition.indexOf("报警") >= 0)
                                            s = 3;
                                          else if (sp > 0.5)
                                            s = 0;
                                          else
                                            s = 1;
                                        }
                                        if (s != 4 && s != 3 && condition.indexOf("停车") >= 0
                                          && !condition.indexOf("不在线") >= 0) {
                                          if (condition.indexOf("停车超时") >= 0) {
                                            s = 5;
                                          } else {
                                            s = 6;
                                          }
                                        }
                                      } else {
                                        if (sp > 0.5)
                                          s = 0;
                                        else
                                          s = 1;
                                      }
                                      if (data.data[x].positionLast.av == 0) {
                                        s = 7;
                                      }
                                      var newtime = new Date().getTime();
                                      var ttime = data.data[i].positionLast.recvtime.replace("-", "/");
                                      ttime = ttime.replace("-", "/");
                                      ttime = ttime.replace("T", " ");
                                      var oldtime = new Date(ttime).getTime();
                                      if (newtime - oldtime > 600000) {
                                        s = 2;
                                      }

                                      var state = s;
                                      var pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/red_0.gif";
                                      if (state == 0) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/green_";
                                      else if (state == 1) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/red_";
                                      else if (state == 2) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/gray_";
                                      else if (state == 3) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/yellow_";
                                      else if (state == 4) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/pink_";
                                      else if (state == 5) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/stopalarm";
                                      else if (state == 7) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/blue_";
                                      else pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/red_";
                                      var direction = "";
                                      var t = parseInt(data.data[x].positionLast.direct);
                                      if (t > 27 && t <= 72) {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "45.gif";
                                        }

                                        direction = "东北";
                                      } else if (t > 72 && t <= 117) {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "90.gif";
                                        }

                                        direction = "东";
                                      }
                                      else if (t > 117 && t <= 162) {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "135.gif";
                                        }
                                        direction = "东南";
                                      }
                                      else if (t > 162 && t <= 207) {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "180.gif";
                                        }
                                        direction = "南";
                                      }
                                      else if (t > 207 && t <= 252) {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "225.gif";
                                        }
                                        direction = "西南";
                                      }
                                      else if (t > 252 && t <= 297) {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "270.gif";
                                        }
                                        direction = "西";
                                      }
                                      else if (t > 297 && t <= 342) {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "315.gif";
                                        }
                                        direction = "西北";
                                      }
                                      else {
                                        if (state == 5) {
                                          var image = ".gif";
                                        } else {
                                          var image = "0.gif";
                                        }
                                        direction = "北";
                                      }
                                      var icon_size = real(data.data[x].icon);
                                      var marker = new google.maps.Marker({
                                        position: myLatlng,
                                        map: map,
                                        //  icon: new google.maps.MarkerImage(pngicon+image, new google.maps.Size(40, 40),new google.maps.Point(0,0),new google.maps.Point(10, 10)),
                                        icon: new google.maps.MarkerImage(pngicon + image, new google.maps.Size(icon_size, icon_size), new google.maps.Point(0, 0), new google.maps.Point(10, 10)),
                                        title: data.data[x].vhcCode
                                      });
                                      //var b = new Base64();  
                                      //var carname = b.encode(data.data[x].vhcCode); 
                                      var carname = encodeURI(encodeURI(data.data[x].vhcCode));
                                      //alert(carname);
                                      markersArray.push(marker);
                                      var temp, temp1, temp2, temp3, temp4;
                                      if (data.data[x].positionLast.temperature != null && data.data[x].positionLast.temperature <= 127) {
                                        temp = data.data[x].positionLast.temperature + " ℃";
                                      } else {
                                        temp = "无效";
                                      }
                                      if (data.data[x].positionLast.temp1 != null && data.data[x].positionLast.temp1 <= 127) {
                                        temp1 = data.data[x].positionLast.temp1 + " ℃";
                                      } else {
                                        temp1 = "无效";
                                      }
                                      if (data.data[x].positionLast.temp2 != null && data.data[x].positionLast.temp2 <= 127) {
                                        temp2 = data.data[x].positionLast.temp2 + " ℃";
                                      } else {
                                        temp2 = "无效";
                                      }
                                      if (data.data[x].positionLast.temp3 != null && data.data[x].positionLast.temp3 <= 127) {
                                        temp3 = data.data[x].positionLast.temp3 + " ℃";
                                      } else {
                                        temp3 = "无效";
                                      }
                                      if (data.data[x].positionLast.temp4 != null && data.data[x].positionLast.temp4 <= 127) {
                                        temp4 = data.data[x].positionLast.temp4 + " ℃";
                                      } else {
                                        temp4 = "无效";
                                      }
                                      var contentString = "";
                                      if (isHasPBackAut()) {
                                        contentString = "<div id='app_" + data.data[x].id + "'><p>" +
                                          "<div id='app1_" + data.data[x].id + "' style='display:block'><b>设备名称：</b>" + data.data[x].vhcCode + "</br></div>"
                                          + "<div id='app18_" + data.data[x].id + "' style='display:block'><b>设备ID：</b>" + data.data[x].gprsCode + "</br></div>"
                                          + "<div id='app16_" + data.data[x].id + "' style='display:block'><b>到期时间：</b>" + (data.data[x].overduetime != null && data.data[x].overduetime.indexOf("19") != 0 ? data.data[x].overduetime : "") + "</br></div>"
                                          + "<div id='app17_" + data.data[x].id + "' style='display:block'><b>启用时间：</b>" + (data.data[x].posavtime != null && data.data[x].posavtime.indexOf("19") != 0 ? data.data[x].posavtime : "") + "</br></div>"

                                          + "<div id='app14_" + data.data[x].id + "' style='display:block'><b>备注：</b>" + data.data[x].remark + "</br></div>"
                                          + "<div id='app15_" + data.data[x].id + "' style='display:block'><b>经纬度：</b>" + data.data[x].positionLast.lng + "," + data.data[x].positionLast.lat + "</br></div>"
                                          + "<div id='app11_" + data.data[x].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[x].simCode + "</br></div>"
                                          + "<div id='app2_" + data.data[x].id + "' style='display:block'><b>服务器时间：</b>" + data.data[x].positionLast.recvtime + "</br></div>"
                                          + "<div id='app12_" + data.data[x].id + "' style='display:block'><b>GPS时间：</b>" + data.data[x].positionLast.gpstime + "</br></div>"
                                          + "<div id='app3_" + data.data[x].id + "' style='display:block'><b>速度：</b>" + data.data[x].positionLast.speed + " km/h </br></div>"
                                          + "<div id='app4_" + data.data[x].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                          + "<div id='app5_" + data.data[x].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + "</br></div>"
                                          + "<div id='app6_" + data.data[x].id + "' style='display:block'><b>油量：</b>" + data.data[x].positionLast.oilMN1 + " L</br></div>"
                                          + "<div id='app7_" + data.data[x].id + "' style='display:block'><b>当日里程：</b>" + data.data[x].positionLast.distance + " km</br></div>"
                                          + "<div id='app8_" + data.data[x].id + "' style='display:block'><b>总里程：</b>" + data.data[x].positionLast.totalDistance + " km</br></div>"
                                          + "<div id='app9_" + data.data[x].id + "' style='display:block'><b>状态：</b>" + data.data[x].positionLast.state2 + "</br></div>"
                                          + "<div id='app10_" + data.data[x].id + "' style='display:block'><b>位置：</b>" + data.data[x].positionLast.memo + "</br></div>"
                                          + "<div id='app13_" + data.data[x].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[x].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                          + "<a href='javascript:streeViewObject.open(" + data.data[x].id + "," + data.data[x].positionLast.lat + "," + data.data[x].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[x].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='" + url + "gpsonline/jsp/monitor/playBack.jsp?carid=" + data.data[x].id + "&carname=" + carname + "&icon=" + data.data[x].icon + "' target='_blank'><font color='#0000FF'>回放</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[x].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[x].id + ");\" >刷新位置</font> | </a>  <a id='more_" + data.data[x].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼</font></a></p></div>";


                                      } else {
                                        contentString = "<div id='app_" + data.data[x].id + "'><p>" +
                                          "<div id='app1_" + data.data[x].id + "' style='display:block'><b>设备名称：</b>" + data.data[x].vhcCode + "</br></div>"
                                          + "<div id='app18_" + data.data[x].id + "' style='display:block'><b>设备ID：</b>" + data.data[x].gprsCode + "</br></div>"
                                          + "<div id='app16_" + data.data[x].id + "' style='display:block'><b>到期时间：</b>" + (data.data[x].overduetime != null && data.data[x].overduetime.indexOf("19") != 0 ? data.data[x].overduetime : "") + "</br></div>"
                                          + "<div id='app17_" + data.data[x].id + "' style='display:block'><b>启用时间：</b>" + (data.data[x].posavtime != null && data.data[x].posavtime.indexOf("19") != 0 ? data.data[x].posavtime : "") + "</br></div>"

                                          + "<div id='app14_" + data.data[x].id + "' style='display:block'><b>备注：</b>" + data.data[x].remark + "</br></div>"
                                          + "<div id='app15_" + data.data[x].id + "' style='display:block'><b>经纬度：</b>" + data.data[x].positionLast.lng + "," + data.data[x].positionLast.lat + "</br></div>"
                                          + "<div id='app11_" + data.data[x].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[x].simCode + "</br></div>"
                                          + "<div id='app2_" + data.data[x].id + "' style='display:block'><b>服务器时间：</b>" + data.data[x].positionLast.recvtime + "</br></div>"
                                          + "<div id='app12_" + data.data[x].id + "' style='display:block'><b>GPS时间：</b>" + data.data[x].positionLast.gpstime + "</br></div>"
                                          + "<div id='app3_" + data.data[x].id + "' style='display:block'><b>速度：</b>" + data.data[x].positionLast.speed + " km/h </br></div>"
                                          + "<div id='app4_" + data.data[x].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                          + "<div id='app5_" + data.data[x].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + "</br></div>"
                                          + "<div id='app6_" + data.data[x].id + "' style='display:block'><b>油量：</b>" + data.data[x].positionLast.oilMN1 + " L</br></div>"
                                          + "<div id='app7_" + data.data[x].id + "' style='display:block'><b>当日里程：</b>" + data.data[x].positionLast.distance + " km</br></div>"
                                          + "<div id='app8_" + data.data[x].id + "' style='display:block'><b>总里程：</b>" + data.data[x].positionLast.totalDistance + " km</br></div>"
                                          + "<div id='app9_" + data.data[x].id + "' style='display:block'><b>状态：</b>" + data.data[x].positionLast.state2 + "</br></div>"
                                          + "<div id='app10_" + data.data[x].id + "' style='display:block'><b>位置：</b>" + data.data[x].positionLast.memo + "</br></div>"
                                          + "<div id='app13_" + data.data[x].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[x].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                          + "<a href='javascript:streeViewObject.open(" + data.data[x].id + "," + data.data[x].positionLast.lat + "," + data.data[x].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[x].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[x].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[x].id + ");\" >刷新位置</font> | </a>  <a id='more_" + data.data[x].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼</font></a></p></div>";


                                      }


                                      //infowindow.setContent(contentString);
                                      var infowindow = new google.maps.InfoWindow({
                                        content: contentString
                                        //,zIndex:10
                                      });
                                      /* google.maps.event.addListener(marker, 'click', function() {
                                         infowindow.open(map,marker);
                                       });*/



                                      //var infowindow = new InfoBox(myOptions);
                                      google.maps.event.addListener(marker, "click", function (e) {
                                        //	$("#1_"+data.data[x].id).hide();

                                        markerObject.closeInfowindow();//关闭打开的标注弹出框

                                        if (menu != null) {
                                          menu.hide();
                                        }

                                        for (var i = 0; i < vehicles.length; i++) {
                                          vehicles[i].infowindow.close();
                                        }

                                        infowindow.open(map, this);
                                        var WinShowParms = getCurUserWinShowParms();

                                        if (WinShowParms != null) {

                                          var app1_ = document.getElementById("app1_" + data.data[x].id);

                                          app1_.style.display = "none";
                                          var app2_ = document.getElementById("app2_" + data.data[x].id);
                                          app2_.style.display = "none";
                                          var app3_ = document.getElementById("app3_" + data.data[x].id);
                                          app3_.style.display = "none";
                                          var app4_ = document.getElementById("app4_" + data.data[x].id);
                                          app4_.style.display = "none";
                                          var app5_ = document.getElementById("app5_" + data.data[x].id);
                                          app5_.style.display = "none";
                                          var app6_ = document.getElementById("app6_" + data.data[x].id);
                                          app6_.style.display = "none";
                                          var app7_ = document.getElementById("app7_" + data.data[x].id);
                                          app7_.style.display = "none";
                                          var app8_ = document.getElementById("app8_" + data.data[x].id);
                                          app8_.style.display = "none";
                                          var app9_ = document.getElementById("app9_" + data.data[x].id);
                                          app9_.style.display = "none";
                                          var app10_ = document.getElementById("app10_" + data.data[x].id);
                                          app10_.style.display = "none";
                                          var app11_ = document.getElementById("app11_" + data.data[x].id);
                                          app11_.style.display = "none";
                                          var app12_ = document.getElementById("app12_" + data.data[x].id);
                                          app12_.style.display = "none";
                                          var app13_ = document.getElementById("app13_" + data.data[x].id);
                                          app13_.style.display = "none";
                                          var app14_ = document.getElementById("app14_" + data.data[x].id);
                                          app14_.style.display = "none";
                                          var app15_ = document.getElementById("app15_" + data.data[x].id);
                                          app15_.style.display = "none";
                                          var app16_ = document.getElementById("app16_" + data.data[x].id);
                                          app16_.style.display = "none";
                                          var app17_ = document.getElementById("app17_" + data.data[x].id);
                                          app17_.style.display = "none";
                                          var app18_ = document.getElementById("app18_" + data.data[x].id);
                                          app18_.style.display = "none";
                                          for (var ws = 0; ws < WinShowParms.length; ws++) {
                                            if (WinShowParms[ws] == 1) {
                                              app1_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 2) {
                                              app2_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 3) {
                                              app3_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 4) {
                                              app4_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 5) {
                                              app5_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 6) {
                                              app6_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 7) {
                                              app7_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 8) {
                                              app8_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 9) {
                                              app9_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 10) {
                                              app10_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 11) {
                                              app11_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 12) {
                                              app12_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 13) {
                                              app13_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 14) {
                                              app14_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 15) {
                                              app15_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 16) {
                                              app16_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 17) {
                                              app17_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 18) {
                                              app18_.style.display = "block";
                                            }
                                          }
                                          var app_ = document.getElementById("app_" + data.data[x].id);
                                          infowindow.setContent(app_);
                                        }



                                        document.getElementById('weizhi').innerHTML = data.data[x].vhcCode + "： " + data.data[x].positionLast.memo;
                                        document.getElementById('weizhi').title = data.data[x].vhcCode + "： " + data.data[x].positionLast.memo;

                                        msgid = data.data[x].id;
                                        msgname = data.data[x].vhcCode;

                                      });

                                      var vehicle = new Object();
                                      vehicle.id = data.data[x].id;
                                      vehicle.vhcCode = data.data[x].vhcCode;
                                      vehicle.remark = data.data[x].remark;
                                      vehicle.label = new LableMarker(map, data.data[x].vhcCode, myLatlng);
                                      vehicle.label.setMap(null);
                                      vehicle.marker = marker;
                                      vehicle.icon = data.data[x].icon;
                                      vehicle.infowindow = infowindow;
                                      vehicle.latlng = myLatlng;
                                      vehicle.simCode = data.data[x].simCode;
                                      vehicle.overduetime = data.data[x].overduetime;
                                      vehicle.posavtime = data.data[x].posavtime;
                                      //if( (data.data[x].positionLast.lat == 0 &&data.data[x].positionLast.lng == 0) || data.data[x].positionLast.av == 0 ){
                                      if (data.data[x].positionLast.lat == 0 && data.data[x].positionLast.lng == 0) {
                                        //vehicle.marker.setMap(null);
                                        //vehicle.label.setMap(null);
                                      }
                                      vehicles.push(vehicle);
                                    })(i);
                                  }
                                  //showCarName();
                                  if (findbsCookie("isShowCarName") == true) {
                                    $("#isShowCarName").attr("checked", true);
                                    namekg = true;
                                    showCarName();
                                  }
                                }
                              }


                            } else {

                            }
                          },
                          error: function () {

                          }
                        });

                      }


                    }

                    var counter = 0;
                    var timestamp = 0;
                    var gids = "";
                    var min = "";
                    var max = "";
                    var cishu = -1;
                    function al() {
                      var WinShowParms = getCurUserWinShowParms();
                      //console.info("A");
                      if (drag == true) {
                        drag = false;
                        timestamp = 0;
                      }
                      if (pagingRefreshObject.isPaging) {
                        cishu++;
                        if (cishu >= pageIdArray.length) {
                          cishu = 0;
                        }
                        min = pageIdArray[cishu].min;
                        max = pageIdArray[cishu].max;
                        timestamp = pageTimeArray[cishu];
                      }
                      if (isLargeData == true) {
                        if (0 < carIds.length) {
                          gids = "";
                          for (var i = 0; i < carIds.length; i++) {
                            gids = gids + "" + carIds[i];
                            if (i < carIds.length - 1) {
                              gids = gids + ",";
                            }
                          }
                        }
                        id = cartIds;
                      }
                      var p = new Object();
                      if (mapType == 1) {
                        p.leftLat = baidMap.getBounds().getSouthWest().lat - 0.05;
                        p.leftLng = baidMap.getBounds().getSouthWest().lng - 0.05;
                        p.rightLat = baidMap.getBounds().getNorthEast().lat + 0.05;
                        p.rightLng = baidMap.getBounds().getNorthEast().lng + 0.05;
                      } else {
                        p.leftLat = map.getBounds().getSouthWest().lat() - 0.05;
                        p.leftLng = map.getBounds().getSouthWest().lng() - 0.05;
                        p.rightLat = map.getBounds().getNorthEast().lat() + 0.05;
                        p.rightLng = map.getBounds().getNorthEast().lng() + 0.05;
                      }
                      if (cartIdsArr.length <= 500) {
                        if (cartIds != "" && cartIds != null) {
                          $.ajax({
                            type: "POST",
                            dataType: "json",
                            async: true,
                            url: "json/vehicleAction_onlinevids.action",
                            data: {
                              ids: -1,
                              timestamp: timestamp,
                              gids: gids,
                              pagesize: max,
                              offset: min
                            },
                            success: function (data) {
                              if (data.flag == true) {
                                counter = 0;
                                newdata = data;
                                reEquipmentStatus(newdata);
                                timestamp = data.timestamp;
                                if (pagingRefreshObject.isPaging) {
                                  pageTimeArray[cishu] = data.timestamp;
                                }
                                if (data.data.length > 0) {
                                  if (carList) {
                                    for (var i = 0; i < data.data.length; i++) {
                                      for (var j = 0; j < carList.data.length; j++) {
                                        if (data.data[i].vehicleId == carList.data[j].id) {
                                          carList.data[j].positionLast = null;
                                          carList.data[j].positionLast = data.data[i];
                                        }
                                      }
                                    }
                                  }
                                  streeViewObject.update();
                                  if (mapType == 1) {
                                    updateBaiduMap();
                                  } else {
                                    for (var i = 0; i < data.data.length; i++) {
                                      /*if(msgid== data.data[i].vehicleId){
                                        document.getElementById('weizhi').innerHTML = msgname+"： " + data.data[i].memo;
                                      document.getElementById('weizhi').title = msgname+"： " + data.data[i].memo;
                                      }*/
                                      for (var k = 0; k < vehicles.length; k++) {
                                        if (data.data[i].vehicleId == vehicles[k].id) {
                                          if (msgid == data.data[i].vehicleId) {
                                            document.getElementById('weizhi').innerHTML = vehicles[k].vhcCode + "： " + data.data[i].memo;
                                            document.getElementById('weizhi').title = vehicles[k].vhcCode + "： " + data.data[i].memo;
                                          }

                                          //if(data.data[i].vehicleId == vehicles[k].id && data.data[i].lat != 0 && data.data[i].lng !=0){
                                          var myLatlng = new google.maps.LatLng(data.data[i].lat, data.data[i].lng);
                                          var s = 10;
                                          var condition = data.data[i].state2;
                                          var sp = parseInt(data.data[i].speed);
                                          if (condition != null) {
                                            if (condition.indexOf("不在线") >= 0 || condition.indexOf("掉线") >= 0)
                                              s = 2;
                                            else {
                                              if (condition.indexOf("速报警") >= 0)
                                                s = 4;
                                              else if (condition.indexOf("报警") >= 0)
                                                s = 3;
                                              else if (sp > 0.5)
                                                s = 0;
                                              else
                                                s = 1;
                                            }
                                            if (s != 4 && s != 3 && condition.indexOf("停车") >= 0
                                              && !condition.indexOf("不在线") >= 0) {
                                              if (condition.indexOf("停车超时") >= 0) {
                                                s = 5;
                                              } else {
                                                s = 6;
                                              }
                                            }
                                          } else {

                                            if (sp > 0.5)
                                              s = 0;
                                            else
                                              s = 1;
                                          }
                                          if (data.data[i].av == 0) {
                                            s = 7;
                                          }
                                          var newtime = new Date().getTime();
                                          var ttime = data.data[i].recvtime.replace("-", "/");
                                          ttime = ttime.replace("-", "/");
                                          ttime = ttime.replace("T", " ");
                                          var oldtime = new Date(ttime).getTime();
                                          //alert(newtime-oldtime);
                                          if (newtime - oldtime > 600000) {
                                            s = 2;
                                          }

                                          var state = s;
                                          var pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/red_0.gif";
                                          if (state == 0) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/green_";
                                          else if (state == 1) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/red_";
                                          else if (state == 2) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/gray_";
                                          else if (state == 3) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/yellow_";
                                          else if (state == 4) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/pink_";
                                          else if (state == 5) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/stopalarm";
                                          else if (state == 7) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/blue_";
                                          else pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/red_";
                                          var direction = "";
                                          var t = parseInt(data.data[i].direct);
                                          if (t > 27 && t <= 72) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "45.gif";
                                            }
                                            direction = "东北";
                                          } else if (t > 72 && t <= 117) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "90.gif";
                                            }

                                            direction = "东";
                                          }
                                          else if (t > 117 && t <= 162) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "135.gif";
                                            }
                                            direction = "东南";
                                          }
                                          else if (t > 162 && t <= 207) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "180.gif";
                                            }
                                            direction = "南";
                                          }
                                          else if (t > 207 && t <= 252) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "225.gif";
                                            }
                                            direction = "西南";
                                          }
                                          else if (t > 252 && t <= 297) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "270.gif";
                                            }
                                            direction = "西";
                                          }
                                          else if (t > 297 && t <= 342) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "315.gif";
                                            }
                                            direction = "西北";
                                          }
                                          else {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "0.gif";
                                            }
                                            direction = "北";
                                          }
                                          //	var b = new Base64();  
                                          //	var carname = b.encode(vehicles[k].vhcCode);  
                                          var carname = encodeURI(encodeURI(vehicles[k].vhcCode));
                                          var temp, temp1, temp2, temp3, temp4;
                                          if (data.data[i].temperature != null && data.data[i].temperature <= 127) {
                                            temp = data.data[i].temperature + " ℃";
                                          } else {
                                            temp = "无效";
                                          }
                                          if (data.data[i].temp1 != null && data.data[i].temp1 <= 127) {
                                            temp1 = data.data[i].temp1 + " ℃";
                                          } else {
                                            temp1 = "无效";
                                          }
                                          if (data.data[i].temp2 != null && data.data[i].temp2 <= 127) {
                                            temp2 = data.data[i].temp2 + " ℃";
                                          } else {
                                            temp2 = "无效";
                                          }
                                          if (data.data[i].temp3 != null && data.data[i].temp3 <= 127) {
                                            temp3 = data.data[i].temp3 + " ℃";
                                          } else {
                                            temp3 = "无效";
                                          }
                                          if (data.data[i].temp4 != null && data.data[i].temp4 <= 127) {
                                            temp4 = data.data[i].temp4 + " ℃";
                                          } else {
                                            temp4 = "无效";
                                          }

                                          if (isHasPBackAut()) {
                                            var contentString = "<div id='app_" + data.data[i].vehicleId + "'><p>" +
                                              "<div id='app1_" + data.data[i].vehicleId + "' style='display:block'><b>设备名称：</b>" + vehicles[k].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].vehicleId + "' style='display:block'><b>设备ID：</b>" + vehicles[k].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].vehicleId + "' style='display:block'><b>到期时间：</b>" + (vehicles[k].overduetime != null && vehicles[k].overduetime.indexOf("19") != 0 ? vehicles[k].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].vehicleId + "' style='display:block'><b>启用时间：</b>" + (vehicles[k].posavtime != null && vehicles[k].posavtime.indexOf("19") != 0 ? vehicles[k].posavtime : "") + "</br></div>"

                                              + "<div id='app14_" + data.data[i].vehicleId + "' style='display:block'><b>备注：</b>" + vehicles[k].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].vehicleId + "' style='display:block'><b>经纬度：</b>" + data.data[i].lng + "," + data.data[i].lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].vehicleId + "' style='display:block'><b>SIM卡号：</b>" + vehicles[k].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].vehicleId + "' style='display:block'><b>服务器时间：</b>" + data.data[i].recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].vehicleId + "' style='display:block'><b>GPS时间：</b>" + data.data[i].gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].vehicleId + "' style='display:block'><b>速度：</b>" + data.data[i].speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].vehicleId + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].vehicleId + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + "  | <b>温度3：</b>" + temp3 + "  | <b>温度4：</b>" + temp4 + "</br></div>"
                                              + "<div id='app6_" + data.data[i].vehicleId + "' style='display:block'><b>油量：</b>" + data.data[i].oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].vehicleId + "' style='display:block'><b>当日里程：</b>" + data.data[i].distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].vehicleId + "' style='display:block'><b>总里程：</b>" + data.data[i].totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].vehicleId + "' style='display:block'><b>状态：</b>" + data.data[i].state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].vehicleId + "' style='display:block'><b>位置：</b>" + data.data[i].memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].vehicleId + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].vehicleId + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].vehicleId + "," + data.data[i].lat + "," + data.data[i].lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + vehicles[k].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='" + url + "gpsonline/jsp/monitor/playBack.jsp?carid=" + vehicles[k].id + "&carname=" + carname + "&icon=" + vehicles[k].icon + "' target='_blank'><font color='#0000FF'>回放</font>  |</a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + vehicles[k].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + vehicles[k].id + ");\" >刷新位置</font> | </a>  <a id='more_" + vehicles[k].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          } else {

                                            var contentString = "<div id='app_" + data.data[i].vehicleId + "'><p>" +
                                              "<div id='app1_" + data.data[i].vehicleId + "' style='display:block'><b>设备名称：</b>" + vehicles[k].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].vehicleId + "' style='display:block'><b>设备ID：</b>" + vehicles[k].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].vehicleId + "' style='display:block'><b>到期时间：</b>" + (vehicles[k].overduetime != null && vehicles[k].overduetime.indexOf("19") != 0 ? vehicles[k].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].vehicleId + "' style='display:block'><b>启用时间：</b>" + (vehicles[k].posavtime != null && vehicles[k].posavtime.indexOf("19") != 0 ? vehicles[k].posavtime : "") + "</br></div>"

                                              + "<div id='app14_" + data.data[i].vehicleId + "' style='display:block'><b>备注：</b>" + vehicles[k].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].vehicleId + "' style='display:block'><b>经纬度：</b>" + data.data[i].lng + "," + data.data[i].lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].vehicleId + "' style='display:block'><b>SIM卡号：</b>" + vehicles[k].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].vehicleId + "' style='display:block'><b>服务器时间：</b>" + data.data[i].recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].vehicleId + "' style='display:block'><b>GPS时间：</b>" + data.data[i].gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].vehicleId + "' style='display:block'><b>速度：</b>" + data.data[i].speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].vehicleId + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].vehicleId + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + "  | <b>温度3：</b>" + temp3 + "  | <b>温度4：</b>" + temp4 + "</br></div>"
                                              + "<div id='app6_" + data.data[i].vehicleId + "' style='display:block'><b>油量：</b>" + data.data[i].oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].vehicleId + "' style='display:block'><b>当日里程：</b>" + data.data[i].distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].vehicleId + "' style='display:block'><b>总里程：</b>" + data.data[i].totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].vehicleId + "' style='display:block'><b>状态：</b>" + data.data[i].state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].vehicleId + "' style='display:block'><b>位置：</b>" + data.data[i].memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].vehicleId + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].vehicleId + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].vehicleId + "," + data.data[i].lat + "," + data.data[i].lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + vehicles[k].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + vehicles[k].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + vehicles[k].id + ");\" >刷新位置</font> | </a>  <a id='more_" + vehicles[k].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          }



                                          var icon_size = real(vehicles[k].icon);

                                          vehicles[k].marker.setIcon(new google.maps.MarkerImage(pngicon + image, new google.maps.Size(icon_size, icon_size), new google.maps.Point(0, 0), new google.maps.Point(10, 10)));
                                          vehicles[k].infowindow.setContent(contentString);
                                          var WinShowParms = getCurUserWinShowParms();

                                          if (WinShowParms != null) {
                                            var app1_ = document.getElementById("app1_" + data.data[i].vehicleId);
                                            if (app1_ != null) {
                                              app1_.style.display = "none";
                                              var app2_ = document.getElementById("app2_" + data.data[i].vehicleId);
                                              app2_.style.display = "none";
                                              var app3_ = document.getElementById("app3_" + data.data[i].vehicleId);
                                              app3_.style.display = "none";
                                              var app4_ = document.getElementById("app4_" + data.data[i].vehicleId);
                                              app4_.style.display = "none";
                                              var app5_ = document.getElementById("app5_" + data.data[i].vehicleId);
                                              app5_.style.display = "none";
                                              var app6_ = document.getElementById("app6_" + data.data[i].vehicleId);
                                              app6_.style.display = "none";
                                              var app7_ = document.getElementById("app7_" + data.data[i].vehicleId);
                                              app7_.style.display = "none";
                                              var app8_ = document.getElementById("app8_" + data.data[i].vehicleId);
                                              app8_.style.display = "none";
                                              var app9_ = document.getElementById("app9_" + data.data[i].vehicleId);
                                              app9_.style.display = "none";
                                              var app10_ = document.getElementById("app10_" + data.data[i].vehicleId);
                                              app10_.style.display = "none";
                                              var app11_ = document.getElementById("app11_" + data.data[i].vehicleId);
                                              app11_.style.display = "none";
                                              var app12_ = document.getElementById("app12_" + data.data[i].vehicleId);
                                              app12_.style.display = "none";
                                              var app13_ = document.getElementById("app13_" + data.data[i].vehicleId);
                                              app13_.style.display = "none";
                                              var app14_ = document.getElementById("app14_" + data.data[i].vehicleId);
                                              app14_.style.display = "none";
                                              var app15_ = document.getElementById("app15_" + data.data[i].vehicleId);
                                              app15_.style.display = "none";
                                              var app16_ = document.getElementById("app16_" + data.data[i].vehicleId);
                                              app16_.style.display = "none";
                                              var app17_ = document.getElementById("app17_" + data.data[i].vehicleId);
                                              app17_.style.display = "none";
                                              var app18_ = document.getElementById("app18_" + data.data[i].vehicleId);
                                              app18_.style.display = "none";
                                              for (var ws = 0; ws < WinShowParms.length; ws++) {
                                                if (WinShowParms[ws] == 1) {
                                                  app1_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 2) {
                                                  app2_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 3) {
                                                  app3_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 4) {
                                                  app4_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 5) {
                                                  app5_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 6) {
                                                  app6_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 7) {
                                                  app7_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 8) {
                                                  app8_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 9) {
                                                  app9_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 10) {
                                                  app10_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 11) {
                                                  app11_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 12) {
                                                  app12_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 13) {
                                                  app13_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 14) {
                                                  app14_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 15) {
                                                  app15_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 16) {
                                                  app16_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 17) {
                                                  app17_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 18) {
                                                  app18_.style.display = "block";
                                                }
                                              }
                                              var app_ = document.getElementById("app_" + data.data[i].vehicleId);
                                              vehicles[k].infowindow.setContent(app_);
                                            }

                                          }


                                          if (data.data[i].lat == 0 && data.data[i].lng == 0) {
                                            //vehicles[k].marker.setMap(null);
                                            //vehicles[k].label.setMap(null);
                                          } else {
                                            vehicles[k].latlng = myLatlng;
                                            vehicles[k].marker.setPosition(myLatlng);
                                            vehicles[k].label.setMap(null);
                                            vehicles[k].label = new LableMarker(map, vehicles[k].vhcCode, myLatlng);
                                            vehicles[k].marker.setMap(map);

                                            if (namekg == true) {
                                              vehicles[k].label.setMap(null);
                                            } else {
                                              vehicles[k].label.setMap(map);
                                            }

                                          }

                                        }
                                      }
                                    }
                                  }
                                }
                              } else {
                                counter++;
                                if (counter >= 4) {
                                  window.location.replace("http://114.215.194.254:89/mygpsonline/gpsonline/jsp/login.jsp");
                                }
                              }
                              gids = "";
                            },
                            error: function () {
                              gids = "";
                              counter++;
                              if (counter >= 4) {
                                window.location.replace("http://114.215.194.254:89/mygpsonline/gpsonline/jsp/login.jsp");
                              }
                            }
                          });
                        }
                      } else {
                        if (cartIds != "" && cartIds != null) {
                          $.ajax({
                            type: "POST",
                            dataType: "json",
                            async: true,
                            url: "json/vehicleAction_onlinevids.action",
                            data: {
                              ids: -1,
                              'p.leftLat': p.leftLat,
                              'p.leftLng': p.leftLng,
                              'p.rightLat': p.rightLat,
                              'p.rightLng': p.rightLng,
                              timestamp: timestamp,
                              gids: gids,
                              pagesize: max,
                              offset: min
                            },
                            success: function (data) {
                              if (data.flag == true) {
                                counter = 0;
                                newdata = data;
                                reEquipmentStatus(newdata);
                                timestamp = data.timestamp;
                                if (pagingRefreshObject.isPaging) {
                                  pageTimeArray[cishu] = data.timestamp;
                                }
                                if (data.data.length > 0) {
                                  if (carList) {
                                    for (var i = 0; i < data.data.length; i++) {
                                      for (var j = 0; j < carList.data.length; j++) {
                                        if (data.data[i].vehicleId == carList.data[j].id) {
                                          carList.data[j].positionLast = null;
                                          carList.data[j].positionLast = data.data[i];
                                        }
                                      }
                                    }
                                  }



                                  streeViewObject.update();
                                  if (mapType == 1) {
                                    updateBaiduMap();
                                  } else {
                                    for (var i = 0; i < data.data.length; i++) {

                                      for (var k = 0; k < vehicles.length; k++) {
                                        if (data.data[i].vehicleId == vehicles[k].id) {

                                          if (msgid == data.data[i].vehicleId) {
                                            document.getElementById('weizhi').innerHTML = vehicles[k].vhcCode + "： " + data.data[i].memo;
                                            document.getElementById('weizhi').title = vehicles[k].vhcCode + "： " + data.data[i].memo;
                                          }

                                          //if(data.data[i].vehicleId == vehicles[k].id && data.data[i].lat != 0 && data.data[i].lng !=0){
                                          var myLatlng = new google.maps.LatLng(data.data[i].lat, data.data[i].lng);
                                          var s = 10;
                                          var condition = data.data[i].state2;
                                          var sp = parseInt(data.data[i].speed);
                                          if (condition != null) {
                                            if (condition.indexOf("不在线") >= 0 || condition.indexOf("掉线") >= 0)
                                              s = 2;
                                            else {
                                              if (condition.indexOf("速报警") >= 0)
                                                s = 4;
                                              else if (condition.indexOf("报警") >= 0)
                                                s = 3;
                                              else if (sp > 0.5)
                                                s = 0;
                                              else
                                                s = 1;
                                            }
                                            if (s != 4 && s != 3 && condition.indexOf("停车") >= 0
                                              && !condition.indexOf("不在线") >= 0) {
                                              if (condition.indexOf("停车超时") >= 0) {
                                                s = 5;
                                              } else {
                                                s = 6;
                                              }
                                            }
                                          } else {
                                            if (sp > 0.5)
                                              s = 0;
                                            else
                                              s = 1;
                                          }
                                          if (data.data[i].av == 0) {
                                            s = 7;
                                          }
                                          var newtime = new Date().getTime();
                                          var ttime = data.data[i].recvtime.replace("-", "/");
                                          ttime = ttime.replace("-", "/");
                                          ttime = ttime.replace("T", " ");
                                          var oldtime = new Date(ttime).getTime();
                                          //alert(newtime-oldtime);
                                          if (newtime - oldtime > 600000) {
                                            s = 2;
                                          }

                                          var state = s;
                                          var pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/red_0.gif";
                                          if (state == 0) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/green_";
                                          else if (state == 1) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/red_";
                                          else if (state == 2) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/gray_";
                                          else if (state == 3) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/yellow_";
                                          else if (state == 4) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/pink_";
                                          else if (state == 5) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/stopalarm";
                                          else if (state == 7) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/blue_";
                                          else pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + vehicles[k].icon + "/red_";
                                          var direction = "";
                                          var t = parseInt(data.data[i].direct);
                                          if (t > 27 && t <= 72) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "45.gif";
                                            }
                                            direction = "东北";
                                          } else if (t > 72 && t <= 117) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "90.gif";
                                            }

                                            direction = "东";
                                          }
                                          else if (t > 117 && t <= 162) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "135.gif";
                                            }
                                            direction = "东南";
                                          }
                                          else if (t > 162 && t <= 207) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "180.gif";
                                            }
                                            direction = "南";
                                          }
                                          else if (t > 207 && t <= 252) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "225.gif";
                                            }
                                            direction = "西南";
                                          }
                                          else if (t > 252 && t <= 297) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "270.gif";
                                            }
                                            direction = "西";
                                          }
                                          else if (t > 297 && t <= 342) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "315.gif";
                                            }
                                            direction = "西北";
                                          }
                                          else {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "0.gif";
                                            }
                                            direction = "北";
                                          }
                                          //	var b = new Base64();  
                                          //	var carname = b.encode(vehicles[k].vhcCode);  
                                          var carname = encodeURI(encodeURI(vehicles[k].vhcCode));
                                          var temp, temp1, temp2, temp3, temp4;
                                          if (data.data[i].temperature != null && data.data[i].temperature <= 127) {
                                            temp = data.data[i].temperature + " ℃";
                                          } else {
                                            temp = "无效";
                                          }
                                          if (data.data[i].temp1 != null && data.data[i].temp1 <= 127) {
                                            temp1 = data.data[i].temp1 + " ℃";
                                          } else {
                                            temp1 = "无效";
                                          }
                                          if (data.data[i].temp2 != null && data.data[i].temp2 <= 127) {
                                            temp2 = data.data[i].temp2 + " ℃";
                                          } else {
                                            temp2 = "无效";
                                          }
                                          if (data.data[i].temp3 != null && data.data[i].temp3 <= 127) {
                                            temp3 = data.data[i].temp3 + " ℃";
                                          } else {
                                            temp3 = "无效";
                                          }
                                          if (data.data[i].temp4 != null && data.data[i].temp4 <= 127) {
                                            temp4 = data.data[i].temp4 + " ℃";
                                          } else {
                                            temp4 = "无效";
                                          }
                                          var contentString = "";
                                          if (isHasPBackAut()) {
                                            contentString = "<div id='app_" + data.data[i].vehicleId + "'><p>" +
                                              "<div id='app1_" + data.data[i].vehicleId + "' style='display:block'><b>设备名称：</b>" + vehicles[k].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].vehicleId + "' style='display:block'><b>设备ID：</b>" + vehicles[k].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].vehicleId + "' style='display:block'><b>到期时间：</b>" + (vehicles[k].overduetime != null && vehicles[k].overduetime.indexOf("19") != 0 ? vehicles[k].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].vehicleId + "' style='display:block'><b>启用时间：</b>" + (vehicles[k].posavtime != null && vehicles[k].posavtime.indexOf("19") != 0 ? vehicles[k].posavtime : "") + "</br></div>"

                                              + "<div id='app14_" + data.data[i].vehicleId + "' style='display:block'><b>备注：</b>" + vehicles[k].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].vehicleId + "' style='display:block'><b>经纬度：</b>" + data.data[i].lng + "," + data.data[i].lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].vehicleId + "' style='display:block'><b>SIM卡号：</b>" + vehicles[k].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].vehicleId + "' style='display:block'><b>服务器时间：</b>" + data.data[i].recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].vehicleId + "' style='display:block'><b>GPS时间：</b>" + data.data[i].gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].vehicleId + "' style='display:block'><b>速度：</b>" + data.data[i].speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].vehicleId + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].vehicleId + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + "</br></div>"
                                              + "<div id='app6_" + data.data[i].vehicleId + "' style='display:block'><b>油量：</b>" + data.data[i].oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].vehicleId + "' style='display:block'><b>当日里程：</b>" + data.data[i].distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].vehicleId + "' style='display:block'><b>总里程：</b>" + data.data[i].totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].vehicleId + "' style='display:block'><b>状态：</b>" + data.data[i].state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].vehicleId + "' style='display:block'><b>位置：</b>" + data.data[i].memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].vehicleId + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].vehicleId + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].vehicleId + "," + data.data[i].lat + "," + data.data[i].lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + vehicles[k].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='" + url + "gpsonline/jsp/monitor/playBack.jsp?carid=" + vehicles[k].id + "&carname=" + carname + "&icon=" + vehicles[k].icon + "' target='_blank'><font color='#0000FF'>回放</font>  |</a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + vehicles[k].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + vehicles[k].id + ");\" >刷新位置</font> | </a> <a id='more_" + vehicles[k].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          } else {
                                            contentString = "<div id='app_" + data.data[i].vehicleId + "'><p>" +
                                              "<div id='app1_" + data.data[i].vehicleId + "' style='display:block'><b>设备名称：</b>" + vehicles[k].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].vehicleId + "' style='display:block'><b>设备ID：</b>" + vehicles[k].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].vehicleId + "' style='display:block'><b>到期时间：</b>" + (vehicles[k].overduetime != null && vehicles[k].overduetime.indexOf("19") != 0 ? vehicles[k].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].vehicleId + "' style='display:block'><b>启用时间：</b>" + (vehicles[k].posavtime != null && vehicles[k].posavtime.indexOf("19") != 0 ? vehicles[k].posavtime : "") + "</br></div>"

                                              + "<div id='app14_" + data.data[i].vehicleId + "' style='display:block'><b>备注：</b>" + vehicles[k].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].vehicleId + "' style='display:block'><b>经纬度：</b>" + data.data[i].lng + "," + data.data[i].lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].vehicleId + "' style='display:block'><b>SIM卡号：</b>" + vehicles[k].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].vehicleId + "' style='display:block'><b>服务器时间：</b>" + data.data[i].recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].vehicleId + "' style='display:block'><b>GPS时间：</b>" + data.data[i].gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].vehicleId + "' style='display:block'><b>速度：</b>" + data.data[i].speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].vehicleId + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].vehicleId + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + "</br></div>"
                                              + "<div id='app6_" + data.data[i].vehicleId + "' style='display:block'><b>油量：</b>" + data.data[i].oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].vehicleId + "' style='display:block'><b>当日里程：</b>" + data.data[i].distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].vehicleId + "' style='display:block'><b>总里程：</b>" + data.data[i].totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].vehicleId + "' style='display:block'><b>状态：</b>" + data.data[i].state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].vehicleId + "' style='display:block'><b>位置：</b>" + data.data[i].memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].vehicleId + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].vehicleId + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].vehicleId + "," + data.data[i].lat + "," + data.data[i].lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + vehicles[k].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + vehicles[k].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + vehicles[k].id + ");\" >刷新位置</font> | </a> <a id='more_" + vehicles[k].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          }


                                          vehicles[k].marker.setIcon(new google.maps.MarkerImage(pngicon + image, new (25, 25), new google.maps.Point(0, 0), new google.maps.Point(10, 10)));
                                          vehicles[k].infowindow.setContent(contentString);

                                          var WinShowParms = getCurUserWinShowParms();

                                          if (WinShowParms != null) {
                                            var app1_ = document.getElementById("app1_" + data.data[i].vehicleId);
                                            if (app1_ != null) {
                                              app1_.style.display = "none";
                                              var app2_ = document.getElementById("app2_" + data.data[i].vehicleId);
                                              app2_.style.display = "none";
                                              var app3_ = document.getElementById("app3_" + data.data[i].vehicleId);
                                              app3_.style.display = "none";
                                              var app4_ = document.getElementById("app4_" + data.data[i].vehicleId);
                                              app4_.style.display = "none";
                                              var app5_ = document.getElementById("app5_" + data.data[i].vehicleId);
                                              app5_.style.display = "none";
                                              var app6_ = document.getElementById("app6_" + data.data[i].vehicleId);
                                              app6_.style.display = "none";
                                              var app7_ = document.getElementById("app7_" + data.data[i].vehicleId);
                                              app7_.style.display = "none";
                                              var app8_ = document.getElementById("app8_" + data.data[i].vehicleId);
                                              app8_.style.display = "none";
                                              var app9_ = document.getElementById("app9_" + data.data[i].vehicleId);
                                              app9_.style.display = "none";
                                              var app10_ = document.getElementById("app10_" + data.data[i].vehicleId);
                                              app10_.style.display = "none";
                                              var app11_ = document.getElementById("app11_" + data.data[i].vehicleId);
                                              app11_.style.display = "none";
                                              var app12_ = document.getElementById("app12_" + data.data[i].vehicleId);
                                              app12_.style.display = "none";
                                              var app13_ = document.getElementById("app13_" + data.data[i].vehicleId);
                                              app13_.style.display = "none";
                                              var app14_ = document.getElementById("app14_" + data.data[i].vehicleId);
                                              app14_.style.display = "none";
                                              var app15_ = document.getElementById("app15_" + data.data[i].vehicleId);
                                              app15_.style.display = "none";
                                              var app16_ = document.getElementById("app16_" + data.data[i].vehicleId);
                                              app16_.style.display = "none";
                                              var app17_ = document.getElementById("app17_" + data.data[i].vehicleId);
                                              app17_.style.display = "none";
                                              var app18_ = document.getElementById("app18_" + data.data[i].vehicleId);
                                              app18_.style.display = "none";
                                              for (var ws = 0; ws < WinShowParms.length; ws++) {
                                                if (WinShowParms[ws] == 1) {
                                                  app1_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 2) {
                                                  app2_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 3) {
                                                  app3_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 4) {
                                                  app4_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 5) {
                                                  app5_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 6) {
                                                  app6_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 7) {
                                                  app7_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 8) {
                                                  app8_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 9) {
                                                  app9_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 10) {
                                                  app10_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 11) {
                                                  app11_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 12) {
                                                  app12_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 13) {
                                                  app13_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 14) {
                                                  app14_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 15) {
                                                  app15_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 16) {
                                                  app16_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 17) {
                                                  app17_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 18) {
                                                  app18_.style.display = "block";
                                                }
                                              }
                                              var app_ = document.getElementById("app_" + data.data[i].vehicleId);
                                              vehicles[k].infowindow.setContent(app_);
                                            }

                                          }


                                          //if((data.data[i].lat == 0 &&data.data[i].lng == 0) || data.data[i].av == 0){
                                          if (data.data[i].lat == 0 && data.data[i].lng == 0) {
                                            //vehicles[k].marker.setMap(null);
                                            //vehicles[k].label.setMap(null);
                                          } else {
                                            vehicles[k].latlng = myLatlng;
                                            vehicles[k].marker.setPosition(myLatlng);
                                            vehicles[k].label.setMap(null);
                                            vehicles[k].label = new LableMarker(map, vehicles[k].vhcCode, myLatlng);
                                            vehicles[k].marker.setMap(map);

                                            if (namekg == true) {
                                              vehicles[k].label.setMap(null);
                                            } else {
                                              vehicles[k].label.setMap(map);
                                            }

                                          }

                                        }
                                      }
                                    }
                                  }
                                }
                              } else {
                                counter++;
                                if (counter >= 4) {
                                  window.location.replace("http://114.215.194.254:89/mygpsonline/gpsonline/jsp/login.jsp");
                                }
                              }
                              gids = "";
                            },
                            error: function () {
                              gids = "";
                              counter++;
                              if (counter >= 4) {
                                window.location.replace("http://114.215.194.254:89/mygpsonline/gpsonline/jsp/login.jsp");
                              }
                            }
                          });
                        }
                      }


                    }

                    function setContentString() {
                      if (msgid != null && msgid != "") {
                        centerMap(msgid, 0, "");
                      }

                    }

                    function updateMarkerData(id) {
                      centerMap(id, 1, true);
                    }

                    var isUpdate = false;
                    function centerMap(id, db, isDatabase) {

                      msgid = id;
                      isUpdate = false;
                      markerObject.closeInfowindow();//关闭打开的标注弹出框
                      if (menu != null) {
                        menu.hide();
                      }
                      var tdata = 1;
                      if (isDatabase == true) {
                        tdata = 0;
                      }
                      $.ajax({
                        type: "POST",
                        dataType: "json",
                        async: true,
                        url: "json/vehicleAction_byids.action",
                        data: { ids: id, t: tdata },
                        success: function (data) {
                          if (data.flag == true) {
                            if (data.data.length > 0) {
                              var isCf = false;
                              for (var i = 0; i < carIds.length; i++) {
                                if (carIds[i] == id) {
                                  isCf = true;
                                }
                              }
                              if (isCf == false) {
                                carIds.push(id);
                              }
                              if (isLargeData == true) {
                                if (carList == "null" || carList == "" || carList == null) {
                                  carList = data;
                                } else {
                                  for (var i = 0; i < data.data.length; i++) {
                                    for (var j = 0; j < carList.data.length; j++) {
                                      if (data.data[i].id == carList.data[j].id) {
                                        carList.data[j] = data.data[i];
                                        isUpdate = true;
                                      }
                                    }
                                    if (isUpdate == false) {
                                      carList.data.push(data.data[0]);
                                    }
                                  }
                                }
                              } else {
                                for (var i = 0; i < data.data.length; i++) {
                                  for (var j = 0; j < carList.data.length; j++) {
                                    if (data.data[i].id == carList.data[j].id) {
                                      carList.data[j] = data.data[i];
                                    }
                                  }
                                }
                              }
                              for (var i = 0; i < data.data.length; i++) {
                                //if(data.data[i].positionLast.lat != 0 &&data.data[i].positionLast.lng != 0 && data.data[i].positionLast.av == 1){
                                //if(data.data[i].positionLast.lat != 0 && data.data[i].positionLast.lng != 0){
                                if (mapType == 2) {
                                  streeViewObject.show(data.data[i].id, data.data[i].positionLast.lat, data.data[i].positionLast.lng, parseInt(data.data[i].positionLast.direct), 5);
                                } else {
                                  streeViewObject.show(data.data[i].id, data.data[i].positionLast.blat, data.data[i].positionLast.blng, parseInt(data.data[i].positionLast.direct), 3);
                                }
                                if (mapType == 1) {
                                  centerBaiduMap(data, db);
                                } else {

                                  if (isLargeData == true) {
                                    if (vehicles.length > 0) {
                                      for (var j = 0; j < vehicles.length; j++) {
                                        vehicles[j].infowindow.close();
                                      }
                                      for (var k = 0; k < vehicles.length; k++) {
                                        if (data.data[i].id == vehicles[k].id) {
                                          vehicles[k].vhcCode = data.data[i].vhcCode;
                                          isUpdate = true;
                                          var myLatlng = new google.maps.LatLng(data.data[i].positionLast.lat, data.data[i].positionLast.lng);
                                          var s = 10;
                                          var condition = data.data[i].positionLast.state2;
                                          var sp = parseInt(data.data[i].positionLast.speed);
                                          if (condition != null) {
                                            if (condition.indexOf("不在线") >= 0 || condition.indexOf("掉线") >= 0)
                                              s = 2;
                                            else {
                                              if (condition.indexOf("速报警") >= 0)
                                                s = 4;
                                              else if (condition.indexOf("报警") >= 0)
                                                s = 3;
                                              else if (sp > 0.5)
                                                s = 0;
                                              else
                                                s = 1;
                                            }
                                            if (s != 4 && s != 3 && condition.indexOf("停车") >= 0
                                              && !condition.indexOf("不在线") >= 0) {
                                              if (condition.indexOf("停车超时") >= 0) {
                                                s = 5;
                                              } else {
                                                s = 6;
                                              }
                                            }
                                          } else {
                                            if (sp > 0.5)
                                              s = 0;
                                            else
                                              s = 1;
                                          }
                                          if (data.data[i].positionLast.av == 0) {
                                            s = 7;
                                          }
                                          var newtime = new Date().getTime();
                                          var ttime = data.data[i].positionLast.recvtime.replace("-", "/");
                                          ttime = ttime.replace("-", "/");
                                          ttime = ttime.replace("T", " ");
                                          var oldtime = new Date(ttime).getTime();

                                          //alert(newtime-oldtime);
                                          if (newtime - oldtime > 600000) {

                                            s = 2;
                                          }

                                          var state = s;
                                          var pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/red_0.gif";
                                          if (state == 0) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/green_";
                                          else if (state == 1) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/red_";
                                          else if (state == 2) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/gray_";
                                          else if (state == 3) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/yellow_";
                                          else if (state == 4) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/pink_";
                                          else if (state == 5) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/stopalarm";
                                          else if (state == 7) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/blue_";
                                          else pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/red_";
                                          var direction = "";
                                          var t = parseInt(data.data[i].positionLast.direct);
                                          if (t > 27 && t <= 72) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "45.gif";
                                            }

                                            direction = "东北";
                                          } else if (t > 72 && t <= 117) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "90.gif";
                                            }

                                            direction = "东";
                                          }
                                          else if (t > 117 && t <= 162) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "135.gif";
                                            }
                                            direction = "东南";
                                          }
                                          else if (t > 162 && t <= 207) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "180.gif";
                                            }
                                            direction = "南";
                                          }
                                          else if (t > 207 && t <= 252) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "225.gif";
                                            }
                                            direction = "西南";
                                          }
                                          else if (t > 252 && t <= 297) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "270.gif";
                                            }
                                            direction = "西";
                                          }
                                          else if (t > 297 && t <= 342) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "315.gif";
                                            }
                                            direction = "西北";
                                          }
                                          else {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "0.gif";
                                            }
                                            direction = "北";
                                          }

                                          // var marker = addMarker(myLatlng,carList.data[x].vhcCode,pngicon+image);
                                          //var b = new Base64();  
                                          //var carname = b.encode(data.data[i].vhcCode);  
                                          var carname = encodeURI(encodeURI(data.data[i].vhcCode));
                                          var temp, temp1, temp2, temp3, temp4;
                                          if (data.data[i].positionLast.temperature != null && data.data[i].positionLast.temperature <= 127) {
                                            temp = data.data[i].positionLast.temperature + " ℃";
                                          } else {
                                            temp = "无效";
                                          }
                                          if (data.data[i].positionLast.temp1 != null && data.data[i].positionLast.temp1 <= 127) {
                                            temp1 = data.data[i].positionLast.temp1 + " ℃";
                                          } else {
                                            temp1 = "无效";
                                          }
                                          if (data.data[i].positionLast.temp2 != null && data.data[i].positionLast.temp2 <= 127) {
                                            temp2 = data.data[i].positionLast.temp2 + " ℃";
                                          } else {
                                            temp2 = "无效";
                                          }
                                          if (data.data[i].positionLast.temp3 != null && data.data[i].positionLast.temp3 <= 127) {
                                            temp3 = data.data[i].positionLast.temp3 + " ℃";
                                          } else {
                                            temp3 = "无效";
                                          }
                                          if (data.data[i].positionLast.temp4 != null && data.data[i].positionLast.temp4 <= 127) {
                                            temp4 = data.data[i].positionLast.temp4 + " ℃";
                                          } else {
                                            temp4 = "无效";
                                          }
                                          var contentString = "";
                                          if (isHasPBackAut()) {
                                            contentString = "<div id='app_" + data.data[i].id + "'><p>" +
                                              "<div id='app1_" + data.data[i].id + "' style='display:block'><b>设备名称：</b>" + data.data[i].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].id + "' style='display:block'><b>设备ID：</b>" + data.data[i].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].id + "' style='display:block'><b>到期时间：</b>" + (data.data[i].overduetime != null && data.data[i].overduetime.indexOf("19") != 0 ? data.data[i].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].id + "' style='display:block'><b>启用时间：</b>" + (data.data[i].posavtime != null && data.data[i].posavtime.indexOf("19") != 0 ? data.data[i].posavtime : "") + "</br></div>"

                                              + "<div id='app14_" + data.data[i].id + "' style='display:block'><b>备注：</b>" + data.data[i].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].id + "' style='display:block'><b>经纬度：</b>" + data.data[i].positionLast.lng + "," + data.data[i].positionLast.lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[i].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].id + "' style='display:block'><b>服务器时间：</b>" + data.data[i].positionLast.recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].id + "' style='display:block'><b>GPS时间：</b>" + data.data[i].positionLast.gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].id + "' style='display:block'><b>速度：</b>" + data.data[i].positionLast.speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + " </br></div>"
                                              + "<div id='app6_" + data.data[i].id + "' style='display:block'><b>油量：</b>" + data.data[i].positionLast.oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].id + "' style='display:block'><b>当日里程：</b>" + data.data[i].positionLast.distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].id + "' style='display:block'><b>总里程：</b>" + data.data[i].positionLast.totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].id + "' style='display:block'><b>状态：</b>" + data.data[i].positionLast.state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].id + "' style='display:block'><b>位置：</b>" + data.data[i].positionLast.memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].id + "," + data.data[i].positionLast.lat + "," + data.data[i].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[i].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='" + url + "gpsonline/jsp/monitor/playBack.jsp?carid=" + data.data[i].id + "&carname=" + carname + "&icon=" + data.data[i].icon + "' target='_blank'><font color='#0000FF'>回放</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[i].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[i].id + ");\" >刷新位置</font> | </a> <a id='more_" + data.data[i].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          } else {
                                            contentString = "<div id='app_" + data.data[i].id + "'><p>" +
                                              "<div id='app1_" + data.data[i].id + "' style='display:block'><b>设备名称：</b>" + data.data[i].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].id + "' style='display:block'><b>设备ID：</b>" + data.data[i].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].id + "' style='display:block'><b>到期时间：</b>" + (data.data[i].overduetime != null && data.data[i].overduetime.indexOf("19") != 0 ? data.data[i].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].id + "' style='display:block'><b>启用时间：</b>" + (data.data[i].posavtime != null && data.data[i].posavtime.indexOf("19") != 0 ? data.data[i].posavtime : "") + "</br></div>"
                                              + "<div id='app14_" + data.data[i].id + "' style='display:block'><b>备注：</b>" + data.data[i].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].id + "' style='display:block'><b>经纬度：</b>" + data.data[i].positionLast.lng + "," + data.data[i].positionLast.lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[i].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].id + "' style='display:block'><b>服务器时间：</b>" + data.data[i].positionLast.recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].id + "' style='display:block'><b>GPS时间：</b>" + data.data[i].positionLast.gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].id + "' style='display:block'><b>速度：</b>" + data.data[i].positionLast.speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + " </br></div>"
                                              + "<div id='app6_" + data.data[i].id + "' style='display:block'><b>油量：</b>" + data.data[i].positionLast.oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].id + "' style='display:block'><b>当日里程：</b>" + data.data[i].positionLast.distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].id + "' style='display:block'><b>总里程：</b>" + data.data[i].positionLast.totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].id + "' style='display:block'><b>状态：</b>" + data.data[i].positionLast.state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].id + "' style='display:block'><b>位置：</b>" + data.data[i].positionLast.memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].id + "," + data.data[i].positionLast.lat + "," + data.data[i].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[i].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[i].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[i].id + ");\" >刷新位置</font> | </a> <a id='more_" + data.data[i].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          }

                                          var icon_size = real(data.data[i].icon);
                                          vehicles[k].marker.setIcon(new google.maps.MarkerImage(pngicon + image, new google.maps.Size(icon_size, icon_size), new google.maps.Point(0, 0), new google.maps.Point(10, 10)));



                                          if (data.data[i].positionLast.lat != 0 && data.data[i].positionLast.lng != 0) {
                                            vehicles[k].latlng = myLatlng;
                                            vehicles[k].marker.setPosition(myLatlng);
                                            vehicles[k].label.setMap(null);
                                            vehicles[k].label = new LableMarker(map, data.data[i].vhcCode, myLatlng);

                                          }
                                          if (namekg == true) {
                                            vehicles[k].label.setMap(null);
                                          }

                                          vehicles[k].infowindow.open(map, vehicles[k].marker);
                                          var WinShowParms = getCurUserWinShowParms();

                                          if (WinShowParms != null) {
                                            var app1_ = document.getElementById("app1_" + data.data[i].id);
                                            app1_.style.display = "none";
                                            var app2_ = document.getElementById("app2_" + data.data[i].id);
                                            app2_.style.display = "none";
                                            var app3_ = document.getElementById("app3_" + data.data[i].id);
                                            app3_.style.display = "none";
                                            var app4_ = document.getElementById("app4_" + data.data[i].id);
                                            app4_.style.display = "none";
                                            var app5_ = document.getElementById("app5_" + data.data[i].id);
                                            app5_.style.display = "none";
                                            var app6_ = document.getElementById("app6_" + data.data[i].id);
                                            app6_.style.display = "none";
                                            var app7_ = document.getElementById("app7_" + data.data[i].id);
                                            app7_.style.display = "none";
                                            var app8_ = document.getElementById("app8_" + data.data[i].id);
                                            app8_.style.display = "none";
                                            var app9_ = document.getElementById("app9_" + data.data[i].id);
                                            app9_.style.display = "none";
                                            var app10_ = document.getElementById("app10_" + data.data[i].id);
                                            app10_.style.display = "none";
                                            var app11_ = document.getElementById("app11_" + data.data[i].id);
                                            app11_.style.display = "none";
                                            var app12_ = document.getElementById("app12_" + data.data[i].id);
                                            app12_.style.display = "none";
                                            var app13_ = document.getElementById("app13_" + data.data[i].id);
                                            app13_.style.display = "none";
                                            var app14_ = document.getElementById("app14_" + data.data[i].id);
                                            app14_.style.display = "none";
                                            var app15_ = document.getElementById("app15_" + data.data[i].id);
                                            app15_.style.display = "none";
                                            var app16_ = document.getElementById("app16_" + data.data[i].id);
                                            app16_.style.display = "none";
                                            var app17_ = document.getElementById("app17_" + data.data[i].id);
                                            app17_.style.display = "none";
                                            var app18_ = document.getElementById("app18_" + data.data[i].id);
                                            app18_.style.display = "none";
                                            for (var ws = 0; ws < WinShowParms.length; ws++) {
                                              if (WinShowParms[ws] == 1) {
                                                app1_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 2) {
                                                app2_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 3) {
                                                app3_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 4) {
                                                app4_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 5) {
                                                app5_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 6) {
                                                app6_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 7) {
                                                app7_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 8) {
                                                app8_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 9) {
                                                app9_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 10) {
                                                app10_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 11) {
                                                app11_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 12) {
                                                app12_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 13) {
                                                app13_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 14) {
                                                app14_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 15) {
                                                app15_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 16) {
                                                app16_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 17) {
                                                app17_.style.display = "block";
                                              }
                                              if (WinShowParms[ws] == 18) {
                                                app18_.style.display = "block";
                                              }
                                            }
                                            var app_ = document.getElementById("app_" + data.data[i].id);
                                            vehicles[k].infowindow.setContent(app_);
                                          }
                                          document.getElementById('weizhi').innerHTML = data.data[i].vhcCode + "： " + data.data[0].positionLast.memo;
                                          document.getElementById('weizhi').title = data.data[i].vhcCode + "： " + data.data[0].positionLast.memo;
                                          msgid = data.data[i].id;
                                          msgname = data.data[i].vhcCode;
                                          if (map.getZoom() < 13) {
                                            map.setZoom(13);
                                          }

                                          if (db == 1) {
                                            map.setCenter(new google.maps.LatLng(data.data[0].positionLast.lat, data.data[0].positionLast.lng));
                                          }
                                        }
                                      }
                                    }
                                    if (isUpdate == false || vehicles.length == 0) {

                                      for (i = 0; i < data.data.length; i++) {
                                        (function (x) {
                                          var myLatlng = new google.maps.LatLng(data.data[x].positionLast.lat, data.data[x].positionLast.lng);

                                          var s = 10;
                                          var condition = data.data[x].positionLast.state2;
                                          var sp = parseInt(data.data[x].positionLast.speed);
                                          if (condition != null) {
                                            if (condition.indexOf("不在线") >= 0 || condition.indexOf("掉线") >= 0)
                                              s = 2;
                                            else {
                                              if (condition.indexOf("速报警") >= 0)
                                                s = 4;
                                              else if (condition.indexOf("报警") >= 0)
                                                s = 3;
                                              else if (sp > 0.5)
                                                s = 0;
                                              else
                                                s = 1;
                                            }
                                            if (s != 4 && s != 3 && condition.indexOf("停车") >= 0
                                              && !condition.indexOf("不在线") >= 0) {
                                              if (condition.indexOf("停车超时") >= 0) {
                                                s = 5;
                                              } else {
                                                s = 6;
                                              }
                                            }
                                          } else {
                                            if (sp > 0.5)
                                              s = 0;
                                            else
                                              s = 1;
                                          }
                                          if (data.data[i].positionLast.av == 0) {
                                            s = 7;
                                          }
                                          var newtime = new Date().getTime();
                                          var ttime = data.data[i].positionLast.recvtime.replace("-", "/");
                                          ttime = ttime.replace("-", "/");
                                          ttime = ttime.replace("T", " ");
                                          var oldtime = new Date(ttime).getTime();
                                          if (newtime - oldtime > 600000) {
                                            s = 2;
                                          }

                                          var state = s;
                                          var pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/red_0.gif";
                                          if (state == 0) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/green_";
                                          else if (state == 1) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/red_";
                                          else if (state == 2) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/gray_";
                                          else if (state == 3) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/yellow_";
                                          else if (state == 4) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/pink_";
                                          else if (state == 5) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/stopalarm";
                                          else if (state == 7) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/blue_";
                                          else pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[x].icon + "/red_";
                                          var direction = "";
                                          var t = parseInt(data.data[x].positionLast.direct);
                                          if (t > 27 && t <= 72) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "45.gif";
                                            }

                                            direction = "东北";
                                          } else if (t > 72 && t <= 117) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "90.gif";
                                            }

                                            direction = "东";
                                          }
                                          else if (t > 117 && t <= 162) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "135.gif";
                                            }
                                            direction = "东南";
                                          }
                                          else if (t > 162 && t <= 207) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "180.gif";
                                            }
                                            direction = "南";
                                          }
                                          else if (t > 207 && t <= 252) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "225.gif";
                                            }
                                            direction = "西南";
                                          }
                                          else if (t > 252 && t <= 297) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "270.gif";
                                            }
                                            direction = "西";
                                          }
                                          else if (t > 297 && t <= 342) {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "315.gif";
                                            }
                                            direction = "西北";
                                          }
                                          else {
                                            if (state == 5) {
                                              var image = ".gif";
                                            } else {
                                              var image = "0.gif";
                                            }
                                            direction = "北";
                                          }
                                          var icon_size = real(data.data[i].icon);
                                          var marker = new google.maps.Marker({
                                            position: myLatlng,
                                            map: map,
                                            icon: new google.maps.MarkerImage(pngicon + image, new google.maps.Size(icon_size, icon_size), new google.maps.Point(0, 0), new google.maps.Point(10, 10)),
                                            title: data.data[x].vhcCode
                                          });
                                          //var b = new Base64();  
                                          //var carname = b.encode(data.data[x].vhcCode); 
                                          var carname = encodeURI(encodeURI(data.data[x].vhcCode));
                                          //alert(carname);
                                          markersArray.push(marker);
                                          var temp, temp1, temp2, temp3, temp4;
                                          if (data.data[i].positionLast.temperature != null && data.data[i].positionLast.temperature <= 127) {
                                            temp = data.data[i].positionLast.temperature + " ℃";
                                          } else {
                                            temp = "无效";
                                          }
                                          if (data.data[i].positionLast.temp1 != null && data.data[i].positionLast.temp1 <= 127) {
                                            temp1 = data.data[i].positionLast.temp1 + " ℃";
                                          } else {
                                            temp1 = "无效";
                                          }
                                          if (data.data[i].positionLast.temp2 != null && data.data[i].positionLast.temp2 <= 127) {
                                            temp2 = data.data[i].positionLast.temp2 + " ℃";
                                          } else {
                                            temp2 = "无效";
                                          }
                                          if (data.data[i].positionLast.temp3 != null && data.data[i].positionLast.temp3 <= 127) {
                                            temp3 = data.data[i].positionLast.temp3 + " ℃";
                                          } else {
                                            temp3 = "无效";
                                          }
                                          if (data.data[i].positionLast.temp4 != null && data.data[i].positionLast.temp4 <= 127) {
                                            temp4 = data.data[i].positionLast.temp4 + " ℃";
                                          } else {
                                            temp4 = "无效";
                                          }
                                          if (isHasPBackAut()) {
                                            contentString = "<div id='app_" + data.data[i].id + "'><p>" +
                                              "<div id='app1_" + data.data[i].id + "' style='display:block'><b>设备名称：</b>" + data.data[i].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].id + "' style='display:block'><b>设备ID：</b>" + data.data[i].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].id + "' style='display:block'><b>到期时间：</b>" + (data.data[i].overduetime != null && data.data[i].overduetime.indexOf("19") != 0 ? data.data[i].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].id + "' style='display:block'><b>启用时间：</b>" + (data.data[i].posavtime != null && data.data[i].posavtime.indexOf("19") != 0 ? data.data[i].posavtime : "") + "</br></div>"

                                              + "<div id='app14_" + data.data[i].id + "' style='display:block'><b>备注：</b>" + data.data[i].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].id + "' style='display:block'><b>经纬度：</b>" + data.data[i].positionLast.lng + "," + data.data[i].positionLast.lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[i].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].id + "' style='display:block'><b>服务器时间：</b>" + data.data[i].positionLast.recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].id + "' style='display:block'><b>GPS时间：</b>" + data.data[i].positionLast.gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].id + "' style='display:block'><b>速度：</b>" + data.data[i].positionLast.speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + " </br></div>"
                                              + "<div id='app6_" + data.data[i].id + "' style='display:block'><b>油量：</b>" + data.data[i].positionLast.oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].id + "' style='display:block'><b>当日里程：</b>" + data.data[i].positionLast.distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].id + "' style='display:block'><b>总里程：</b>" + data.data[i].positionLast.totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].id + "' style='display:block'><b>状态：</b>" + data.data[i].positionLast.state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].id + "' style='display:block'><b>位置：</b>" + data.data[i].positionLast.memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].id + "," + data.data[i].positionLast.lat + "," + data.data[i].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[i].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='" + url + "gpsonline/jsp/monitor/playBack.jsp?carid=" + data.data[i].id + "&carname=" + carname + "&icon=" + data.data[i].icon + "' target='_blank'><font color='#0000FF'>回放</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[i].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[i].id + ");\" >刷新位置</font> | </a> <a id='more_" + data.data[i].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          } else {
                                            contentString = "<div id='app_" + data.data[i].id + "'><p>" +
                                              "<div id='app1_" + data.data[i].id + "' style='display:block'><b>设备名称：</b>" + data.data[i].vhcCode + "</br></div>"
                                              + "<div id='app18_" + data.data[i].id + "' style='display:block'><b>设备ID：</b>" + data.data[i].gprsCode + "</br></div>"
                                              + "<div id='app16_" + data.data[i].id + "' style='display:block'><b>到期时间：</b>" + (data.data[i].overduetime != null && data.data[i].overduetime.indexOf("19") != 0 ? data.data[i].overduetime : "") + "</br></div>"
                                              + "<div id='app17_" + data.data[i].id + "' style='display:block'><b>启用时间：</b>" + (data.data[i].posavtime != null && data.data[i].posavtime.indexOf("19") != 0 ? data.data[i].posavtime : "") + "</br></div>"

                                              + "<div id='app14_" + data.data[i].id + "' style='display:block'><b>备注：</b>" + data.data[i].remark + "</br></div>"
                                              + "<div id='app15_" + data.data[i].id + "' style='display:block'><b>经纬度：</b>" + data.data[i].positionLast.lng + "," + data.data[i].positionLast.lat + "</br></div>"
                                              + "<div id='app11_" + data.data[i].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[i].simCode + "</br></div>"
                                              + "<div id='app2_" + data.data[i].id + "' style='display:block'><b>服务器时间：</b>" + data.data[i].positionLast.recvtime + "</br></div>"
                                              + "<div id='app12_" + data.data[i].id + "' style='display:block'><b>GPS时间：</b>" + data.data[i].positionLast.gpstime + "</br></div>"
                                              + "<div id='app3_" + data.data[i].id + "' style='display:block'><b>速度：</b>" + data.data[i].positionLast.speed + " km/h </br></div>"
                                              + "<div id='app4_" + data.data[i].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                              + "<div id='app5_" + data.data[i].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + " </br></div>"
                                              + "<div id='app6_" + data.data[i].id + "' style='display:block'><b>油量：</b>" + data.data[i].positionLast.oilMN1 + " L</br></div>"
                                              + "<div id='app7_" + data.data[i].id + "' style='display:block'><b>当日里程：</b>" + data.data[i].positionLast.distance + " km</br></div>"
                                              + "<div id='app8_" + data.data[i].id + "' style='display:block'><b>总里程：</b>" + data.data[i].positionLast.totalDistance + " km</br></div>"
                                              + "<div id='app9_" + data.data[i].id + "' style='display:block'><b>状态：</b>" + data.data[i].positionLast.state2 + "</br></div>"
                                              + "<div id='app10_" + data.data[i].id + "' style='display:block'><b>位置：</b>" + data.data[i].positionLast.memo + "</br></div>"
                                              + "<div id='app13_" + data.data[i].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                              + "<a href='javascript:streeViewObject.open(" + data.data[i].id + "," + data.data[i].positionLast.lat + "," + data.data[i].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[i].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[i].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[i].id + ");\" >刷新位置</font> | </a> <a id='more_" + data.data[i].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                          }



                                          var infowindow = new google.maps.InfoWindow({
                                            content: contentString
                                            //,zIndex:10
                                          });
                                          //var infowindow = new InfoBox(myOptions);
                                          google.maps.event.addListener(marker, "click", function (e) {
                                            //alert($(boxText).css("height"));

                                            markerObject.closeInfowindow();//关闭打开的标注弹出框
                                            if (menu != null) {
                                              menu.hide();
                                            }

                                            for (var i = 0; i < vehicles.length; i++) {
                                              vehicles[i].infowindow.close();
                                            }
                                            infowindow.open(map, this);
                                            var WinShowParms = getCurUserWinShowParms();

                                            if (WinShowParms != null) {
                                              var app1_ = document.getElementById("app1_" + data.data[i].id);
                                              app1_.style.display = "none";
                                              var app2_ = document.getElementById("app2_" + data.data[i].id);
                                              app2_.style.display = "none";
                                              var app3_ = document.getElementById("app3_" + data.data[i].id);
                                              app3_.style.display = "none";
                                              var app4_ = document.getElementById("app4_" + data.data[i].id);
                                              app4_.style.display = "none";
                                              var app5_ = document.getElementById("app5_" + data.data[i].id);
                                              app5_.style.display = "none";
                                              var app6_ = document.getElementById("app6_" + data.data[i].id);
                                              app6_.style.display = "none";
                                              var app7_ = document.getElementById("app7_" + data.data[i].id);
                                              app7_.style.display = "none";
                                              var app8_ = document.getElementById("app8_" + data.data[i].id);
                                              app8_.style.display = "none";
                                              var app9_ = document.getElementById("app9_" + data.data[i].id);
                                              app9_.style.display = "none";
                                              var app10_ = document.getElementById("app10_" + data.data[i].id);
                                              app10_.style.display = "none";
                                              var app11_ = document.getElementById("app11_" + data.data[i].id);
                                              app11_.style.display = "none";
                                              var app12_ = document.getElementById("app12_" + data.data[i].id);
                                              app12_.style.display = "none";
                                              var app13_ = document.getElementById("app13_" + data.data[i].id);
                                              app13_.style.display = "none";
                                              var app14_ = document.getElementById("app14_" + data.data[i].id);
                                              app14_.style.display = "none";
                                              var app15_ = document.getElementById("app15_" + data.data[i].id);
                                              app15_.style.display = "none";
                                              var app16_ = document.getElementById("app16_" + data.data[i].id);
                                              app16_.style.display = "none";
                                              var app17_ = document.getElementById("app17_" + data.data[i].id);
                                              app17_.style.display = "none";
                                              var app18_ = document.getElementById("app18_" + data.data[i].id);
                                              app18_.style.display = "none";
                                              for (var ws = 0; ws < WinShowParms.length; ws++) {
                                                if (WinShowParms[ws] == 1) {
                                                  app1_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 2) {
                                                  app2_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 3) {
                                                  app3_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 4) {
                                                  app4_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 5) {
                                                  app5_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 6) {
                                                  app6_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 7) {
                                                  app7_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 8) {
                                                  app8_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 9) {
                                                  app9_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 10) {
                                                  app10_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 11) {
                                                  app11_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 12) {
                                                  app12_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 13) {
                                                  app13_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 14) {
                                                  app14_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 15) {
                                                  app15_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 16) {
                                                  app16_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 17) {
                                                  app17_.style.display = "block";
                                                }
                                                if (WinShowParms[ws] == 18) {
                                                  app18_.style.display = "block";
                                                }
                                              }
                                              var app_ = document.getElementById("app_" + data.data[i].id);
                                              infowindow.setContent(app_);
                                            }
                                            document.getElementById('weizhi').innerHTML = data.data[x].vhcCode + "： " + data.data[x].positionLast.memo;
                                            document.getElementById('weizhi').title = data.data[x].vhcCode + "： " + data.data[x].positionLast.memo;

                                          });


                                          //var infowindow = new InfoBox(myOptions);

                                          var vehicle = new Object();
                                          vehicle.id = data.data[x].id;
                                          vehicle.vhcCode = data.data[x].vhcCode;
                                          vehicle.label = new LableMarker(map, data.data[x].vhcCode, myLatlng);
                                          vehicle.label.setMap(null);
                                          vehicle.marker = marker;
                                          vehicle.icon = data.data[x].icon;
                                          vehicle.infowindow = infowindow;
                                          vehicle.latlng = myLatlng;
                                          //if((data.data[x].positionLast.lat == 0 &&data.data[x].positionLast.lng == 0) || data.data[i].av == 0){
                                          if (data.data[x].positionLast.lat == 0 && data.data[x].positionLast.lng == 0) {
                                            //vehicle.marker.setMap(null);
                                            //vehicle.label.setMap(null);
                                          }
                                          if (namekg == false) {
                                            vehicle.label.setMap(map);
                                          }
                                          vehicles.push(vehicle);
                                          infowindow.open(map, marker);
                                          document.getElementById('weizhi').innerHTML = data.data[i].vhcCode + "： " + data.data[0].positionLast.memo;
                                          document.getElementById('weizhi').title = data.data[i].vhcCode + "： " + data.data[0].positionLast.memo;
                                          if (map.getZoom() < 13) {
                                            map.setZoom(13);
                                          }
                                          if (db == 1) {
                                            map.setCenter(new google.maps.LatLng(data.data[0].positionLast.lat, data.data[0].positionLast.lng));
                                          }

                                        })(i);
                                      }

                                    }
                                  } else {
                                    for (var j = 0; j < vehicles.length; j++) {
                                      vehicles[j].infowindow.close();
                                    }
                                    for (var k = 0; k < vehicles.length; k++) {
                                      if (data.data[i].id == vehicles[k].id) {
                                        vehicles[k].vhcCode = data.data[i].vhcCode;
                                        var myLatlng = new google.maps.LatLng(data.data[i].positionLast.lat, data.data[i].positionLast.lng);
                                        var s = 10;
                                        var condition = data.data[i].positionLast.state2;
                                        var sp = parseInt(data.data[i].positionLast.speed);
                                        if (condition != null) {
                                          if (condition.indexOf("不在线") >= 0 || condition.indexOf("掉线") >= 0)
                                            s = 2;
                                          else {
                                            if (condition.indexOf("速报警") >= 0)
                                              s = 4;
                                            else if (condition.indexOf("报警") >= 0)
                                              s = 3;
                                            else if (sp > 0.5)
                                              s = 0;
                                            else
                                              s = 1;
                                          }
                                          if (s != 4 && s != 3 && condition.indexOf("停车") >= 0
                                            && !condition.indexOf("不在线") >= 0) {
                                            if (condition.indexOf("停车超时") >= 0) {
                                              s = 5;
                                            } else {
                                              s = 6;
                                            }
                                          }
                                        } else {
                                          if (sp > 0.5)
                                            s = 0;
                                          else
                                            s = 1;
                                        }
                                        if (data.data[i].positionLast.av == 0) {
                                          s = 7;
                                        }
                                        var newtime = new Date().getTime();
                                        var ttime = data.data[i].positionLast.recvtime.replace("-", "/");
                                        ttime = ttime.replace("-", "/");
                                        ttime = ttime.replace("T", " ");
                                        var oldtime = new Date(ttime).getTime();

                                        //alert(newtime-oldtime);
                                        if (newtime - oldtime > 600000) {

                                          s = 2;
                                        }

                                        var state = s;
                                        var pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/red_0.gif";
                                        if (state == 0) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/green_";
                                        else if (state == 1) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/red_";
                                        else if (state == 2) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/gray_";
                                        else if (state == 3) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/yellow_";
                                        else if (state == 4) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/pink_";
                                        else if (state == 5) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/stopalarm";
                                        else if (state == 7) pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/blue_";
                                        else pngicon = "http://114.215.194.254:89/mygpsonline/gpsonline/image/pic/" + data.data[i].icon + "/red_";
                                        var direction = "";
                                        var t = parseInt(data.data[i].positionLast.direct);
                                        if (t > 27 && t <= 72) {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "45.gif";
                                          }

                                          direction = "东北";
                                        } else if (t > 72 && t <= 117) {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "90.gif";
                                          }

                                          direction = "东";
                                        }
                                        else if (t > 117 && t <= 162) {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "135.gif";
                                          }
                                          direction = "东南";
                                        }
                                        else if (t > 162 && t <= 207) {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "180.gif";
                                          }
                                          direction = "南";
                                        }
                                        else if (t > 207 && t <= 252) {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "225.gif";
                                          }
                                          direction = "西南";
                                        }
                                        else if (t > 252 && t <= 297) {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "270.gif";
                                          }
                                          direction = "西";
                                        }
                                        else if (t > 297 && t <= 342) {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "315.gif";
                                          }
                                          direction = "西北";
                                        }
                                        else {
                                          if (state == 5) {
                                            var image = ".gif";
                                          } else {
                                            var image = "0.gif";
                                          }
                                          direction = "北";
                                        }


                                        var carname = encodeURI(encodeURI(data.data[i].vhcCode));

                                        var temp, temp1, temp2, temp3, temp4;
                                        if (data.data[i].positionLast.temperature != null && data.data[i].positionLast.temperature <= 127) {
                                          temp = data.data[i].positionLast.temperature + " ℃";
                                        } else {
                                          temp = "无效";
                                        }
                                        if (data.data[i].positionLast.temp1 != null && data.data[i].positionLast.temp1 <= 127) {
                                          temp1 = data.data[i].positionLast.temp1 + " ℃";
                                        } else {
                                          temp1 = "无效";
                                        }
                                        if (data.data[i].positionLast.temp2 != null && data.data[i].positionLast.temp2 <= 127) {
                                          temp2 = data.data[i].positionLast.temp2 + " ℃";
                                        } else {
                                          temp2 = "无效";
                                        }
                                        if (data.data[i].positionLast.temp3 != null && data.data[i].positionLast.temp3 <= 127) {
                                          temp3 = data.data[i].positionLast.temp3 + " ℃";
                                        } else {
                                          temp3 = "无效";
                                        }
                                        if (data.data[i].positionLast.temp4 != null && data.data[i].positionLast.temp4 <= 127) {
                                          temp4 = data.data[i].positionLast.temp4 + " ℃";
                                        } else {
                                          temp4 = "无效";
                                        }
                                        var contentString = "";
                                        if (isHasPBackAut()) {
                                          contentString = "<div id='app_" + data.data[i].id + "'><p>" +
                                            "<div id='app1_" + data.data[i].id + "' style='display:block'><b>设备名称：</b>" + data.data[i].vhcCode + "</br></div>"
                                            + "<div id='app18_" + data.data[i].id + "' style='display:block'><b>设备ID：</b>" + data.data[i].gprsCode + "</br></div>"
                                            + "<div id='app16_" + data.data[i].id + "' style='display:block'><b>到期时间：</b>" + (data.data[i].overduetime != null && data.data[i].overduetime.indexOf("19") != 0 ? data.data[i].overduetime : "") + "</br></div>"
                                            + "<div id='app17_" + data.data[i].id + "' style='display:block'><b>启用时间：</b>" + (data.data[i].posavtime != null && data.data[i].posavtime.indexOf("19") != 0 ? data.data[i].posavtime : "") + "</br></div>"

                                            + "<div id='app14_" + data.data[i].id + "' style='display:block'><b>备注：</b>" + data.data[i].remark + "</br></div>"
                                            + "<div id='app15_" + data.data[i].id + "' style='display:block'><b>经纬度：</b>" + data.data[i].positionLast.lng + "," + data.data[i].positionLast.lat + "</br></div>"
                                            + "<div id='app11_" + data.data[i].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[i].simCode + "</br></div>"
                                            + "<div id='app2_" + data.data[i].id + "' style='display:block'><b>服务器时间：</b>" + data.data[i].positionLast.recvtime + "</br></div>"
                                            + "<div id='app12_" + data.data[i].id + "' style='display:block'><b>GPS时间：</b>" + data.data[i].positionLast.gpstime + "</br></div>"
                                            + "<div id='app3_" + data.data[i].id + "' style='display:block'><b>速度：</b>" + data.data[i].positionLast.speed + " km/h </br></div>"
                                            + "<div id='app4_" + data.data[i].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                            + "<div id='app5_" + data.data[i].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + " </br></div>"
                                            + "<div id='app6_" + data.data[i].id + "' style='display:block'><b>油量：</b>" + data.data[i].positionLast.oilMN1 + " L</br></div>"
                                            + "<div id='app7_" + data.data[i].id + "' style='display:block'><b>当日里程：</b>" + data.data[i].positionLast.distance + " km</br></div>"
                                            + "<div id='app8_" + data.data[i].id + "' style='display:block'><b>总里程：</b>" + data.data[i].positionLast.totalDistance + " km</br></div>"
                                            + "<div id='app9_" + data.data[i].id + "' style='display:block'><b>状态：</b>" + data.data[i].positionLast.state2 + "</br></div>"
                                            + "<div id='app10_" + data.data[i].id + "' style='display:block'><b>位置：</b>" + data.data[i].positionLast.memo + "</br></div>"
                                            + "<div id='app13_" + data.data[i].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                            + "<a href='javascript:streeViewObject.open(" + data.data[i].id + "," + data.data[i].positionLast.lat + "," + data.data[i].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[i].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='" + url + "gpsonline/jsp/monitor/playBack.jsp?carid=" + data.data[i].id + "&carname=" + carname + "&icon=" + data.data[i].icon + "' target='_blank'><font color='#0000FF'>回放</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[i].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[i].id + ");\" >刷新位置</font> | </a> <a id='more_" + data.data[i].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                        } else {
                                          contentString = "<div id='app_" + data.data[i].id + "'><p>" +
                                            "<div id='app1_" + data.data[i].id + "' style='display:block'><b>设备名称：</b>" + data.data[i].vhcCode + "</br></div>"
                                            + "<div id='app18_" + data.data[i].id + "' style='display:block'><b>设备ID：</b>" + data.data[i].gprsCode + "</br></div>"
                                            + "<div id='app16_" + data.data[i].id + "' style='display:block'><b>到期时间：</b>" + (data.data[i].overduetime != null && data.data[i].overduetime.indexOf("19") != 0 ? data.data[i].overduetime : "") + "</br></div>"
                                            + "<div id='app17_" + data.data[i].id + "' style='display:block'><b>启用时间：</b>" + (data.data[i].posavtime != null && data.data[i].posavtime.indexOf("19") != 0 ? data.data[i].posavtime : "") + "</br></div>"

                                            + "<div id='app14_" + data.data[i].id + "' style='display:block'><b>备注：</b>" + data.data[i].remark + "</br></div>"
                                            + "<div id='app15_" + data.data[i].id + "' style='display:block'><b>经纬度：</b>" + data.data[i].positionLast.lng + "," + data.data[i].positionLast.lat + "</br></div>"
                                            + "<div id='app11_" + data.data[i].id + "' style='display:block'><b>SIM卡号：</b>" + data.data[i].simCode + "</br></div>"
                                            + "<div id='app2_" + data.data[i].id + "' style='display:block'><b>服务器时间：</b>" + data.data[i].positionLast.recvtime + "</br></div>"
                                            + "<div id='app12_" + data.data[i].id + "' style='display:block'><b>GPS时间：</b>" + data.data[i].positionLast.gpstime + "</br></div>"
                                            + "<div id='app3_" + data.data[i].id + "' style='display:block'><b>速度：</b>" + data.data[i].positionLast.speed + " km/h </br></div>"
                                            + "<div id='app4_" + data.data[i].id + "' style='display:block'><b>方向：</b>" + direction + "</br></div>"
                                            + "<div id='app5_" + data.data[i].id + "' style='display:block'><b>温度：</b>" + temp + " | <b>温度1：</b>" + temp1 + " | <b>温度2：</b>" + temp2 + " | <b>温度3：</b>" + temp3 + " | <b>温度4：</b>" + temp4 + " </br></div>"
                                            + "<div id='app6_" + data.data[i].id + "' style='display:block'><b>油量：</b>" + data.data[i].positionLast.oilMN1 + " L</br></div>"
                                            + "<div id='app7_" + data.data[i].id + "' style='display:block'><b>当日里程：</b>" + data.data[i].positionLast.distance + " km</br></div>"
                                            + "<div id='app8_" + data.data[i].id + "' style='display:block'><b>总里程：</b>" + data.data[i].positionLast.totalDistance + " km</br></div>"
                                            + "<div id='app9_" + data.data[i].id + "' style='display:block'><b>状态：</b>" + data.data[i].positionLast.state2 + "</br></div>"
                                            + "<div id='app10_" + data.data[i].id + "' style='display:block'><b>位置：</b>" + data.data[i].positionLast.memo + "</br></div>"
                                            + "<div id='app13_" + data.data[i].id + "' style='display:block'><b>OBD/CAN数据：</b><a href='javascript:opobd(" + data.data[i].id + ");'><font color='#0000FF'>详细</font></a></br></div>"
                                            + "<a href='javascript:streeViewObject.open(" + data.data[i].id + "," + data.data[i].positionLast.lat + "," + data.data[i].positionLast.lng + "," + t + "," + 5 + ");'><font color='#0000FF'>街景</font> | </a><a href='" + url + "gpsonline/jsp/TrackMap.jsp?carid=" + data.data[i].id + "&mapType=2' target='_blank'><font color='#0000FF'>跟踪</font> | </a><a href='javascript:;' ><font color='#0000FF' onclick=\"openDriverInfo(" + data.data[i].id + ");\" >驾驶员</font> | </a> <a href='javascript:;' ><font color='#0000FF' onclick=\"updateWeizhi(" + data.data[i].id + ");\" >刷新位置</font> | </a> <a id='more_" + data.data[i].id + "' href='javascript:;' onclick=\"showSecondMenu(this,event);\"><font color='#0000FF'>更多▼ </font></a></p></div>";

                                        }

                                        var icon_size = real(data.data[i].icon);
                                        vehicles[k].marker.setIcon(new google.maps.MarkerImage(pngicon + image, new google.maps.Size(icon_size, icon_size), new google.maps.Point(0, 0), new google.maps.Point(10, 10)));



                                        if (data.data[i].positionLast.lat != 0 && data.data[i].positionLast.lng != 0) {
                                          //vehicle.marker.setMap(null);
                                          //vehicle.label.setMap(null);
                                          vehicles[k].latlng = myLatlng;
                                          vehicles[k].marker.setPosition(myLatlng);
                                          vehicles[k].label.setMap(null);
                                          vehicles[k].label = new LableMarker(map, data.data[i].vhcCode, myLatlng);

                                        }
                                        if (namekg == true) {
                                          vehicles[k].label.setMap(null);
                                        }
                                        //vehicles[k].infowindow.setContent(contentString);
                                        vehicles[k].infowindow.open(map, vehicles[k].marker);
                                        var WinShowParms = getCurUserWinShowParms();
                                        vehicles[k].infowindow.setContent(contentString);
                                        if (WinShowParms != null) {
                                          var app1_ = document.getElementById("app1_" + data.data[i].id);
                                          app1_.style.display = "none";
                                          var app2_ = document.getElementById("app2_" + data.data[i].id);
                                          app2_.style.display = "none";
                                          var app3_ = document.getElementById("app3_" + data.data[i].id);
                                          app3_.style.display = "none";
                                          var app4_ = document.getElementById("app4_" + data.data[i].id);
                                          app4_.style.display = "none";
                                          var app5_ = document.getElementById("app5_" + data.data[i].id);
                                          app5_.style.display = "none";
                                          var app6_ = document.getElementById("app6_" + data.data[i].id);
                                          app6_.style.display = "none";
                                          var app7_ = document.getElementById("app7_" + data.data[i].id);
                                          app7_.style.display = "none";
                                          var app8_ = document.getElementById("app8_" + data.data[i].id);
                                          app8_.style.display = "none";
                                          var app9_ = document.getElementById("app9_" + data.data[i].id);
                                          app9_.style.display = "none";
                                          var app10_ = document.getElementById("app10_" + data.data[i].id);
                                          app10_.style.display = "none";
                                          var app11_ = document.getElementById("app11_" + data.data[i].id);
                                          app11_.style.display = "none";
                                          var app12_ = document.getElementById("app12_" + data.data[i].id);
                                          app12_.style.display = "none";
                                          var app13_ = document.getElementById("app13_" + data.data[i].id);
                                          app13_.style.display = "none";
                                          var app14_ = document.getElementById("app14_" + data.data[i].id);
                                          app14_.style.display = "none";
                                          var app15_ = document.getElementById("app15_" + data.data[i].id);
                                          app15_.style.display = "none";
                                          var app16_ = document.getElementById("app16_" + data.data[i].id);
                                          app16_.style.display = "none";
                                          var app17_ = document.getElementById("app17_" + data.data[i].id);
                                          app17_.style.display = "none";
                                          var app18_ = document.getElementById("app18_" + data.data[i].id);
                                          app18_.style.display = "none";
                                          for (var ws = 0; ws < WinShowParms.length; ws++) {
                                            if (WinShowParms[ws] == 1) {
                                              app1_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 2) {
                                              app2_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 3) {
                                              app3_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 4) {
                                              app4_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 5) {
                                              app5_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 6) {
                                              app6_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 7) {
                                              app7_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 8) {
                                              app8_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 9) {
                                              app9_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 10) {
                                              app10_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 11) {
                                              app11_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 12) {
                                              app12_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 13) {
                                              app13_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 14) {
                                              app14_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 15) {
                                              app15_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 16) {
                                              app16_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 17) {
                                              app17_.style.display = "block";
                                            }
                                            if (WinShowParms[ws] == 18) {
                                              app18_.style.display = "block";
                                            }
                                          }
                                          var app_ = document.getElementById("app_" + data.data[i].id);
                                          vehicles[k].infowindow.setContent(app_);
                                        }
                                        //document.getElementById('weizhi').innerHTML = data.data[i].vhcCode+"： " + data.data[0].positionLast.memo;
                                        //document.getElementById('weizhi').title  = data.data[i].vhcCode+"： " + data.data[0].positionLast.memo;
                                        if (map.getZoom() < 13) {
                                          map.setZoom(13);
                                        }
                                        if (db == 1) {
                                          map.setCenter(new google.maps.LatLng(data.data[0].positionLast.lat, data.data[0].positionLast.lng));
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                            updateCurMenu(data);
                          }
                        },
                        error: function () {

                        }
                      });
                    }

                    function showCarName() {
                      if (namekg == false) {
                        setbsCookie("isShowCarName", false);
                        namekg = true;
                        if (mapType == 1) {
                          for (var j = 0; j < markers.length; j++) {
                            if (markers[j].label != null) {
                              baidMap.removeOverlay(markers[j].label);
                            }
                          }
                        } else {
                          for (var j = 0; j < vehicles.length; j++) {
                            vehicles[j].label.setMap(null);
                          }
                        }
                      } else {
                        namekg = false;
                        setbsCookie("isShowCarName", true);
                        if (mapType == 1) {
                          for (var j = 0; j < markers.length; j++) {
                            if (markers[j].label != null) {
                              //markers[j].label.setMap(null);
                              baidMap.addOverlay(markers[j].label);
                            }
                          }
                        } else {
                          for (var j = 0; j < vehicles.length; j++) {
                            vehicles[j].label.setMap(map);
                          }
                        }
                      }
                    }
                    var mapshowkg = false;
                    function showMap() {
                      if (mapshowkg == false) {
                        mapshowkg = true;
                        document.getElementById("idx_top").style.display = "none";
                        //  alert(222);
                        document.getElementById("index_main").className = "cpageShowCanvas";
                        $(".list_main").height($(window).height() - $(".idx_top").height() - 40);
                        $("#closefullscreenbtn").hide();
                        $("#fullscreenbtn").show();
                      } else {
                        mapshowkg = false;
                        document.getElementById("idx_top").style.display = "";
                        document.getElementById("index_main").className = "pageShowCanvas";
                        $(".list_main").height($(window).height() - ($(".main_top").height() + $(".idx_top").height()) - 20);
                        $("#closefullscreenbtn").show();
                        $("#fullscreenbtn").hide();
                      }
                    }
                    var countnum;
                    function setCount() {
                      clearTimeout(countnum);
                      num_s = getRefreshTime();
                      countDown();
                    }
                    function countDown() {
                      //console.info(num_s >= 0);
                      if (num_s >= 0) {
                        /*alert(num == 10 && newdata!= null);
                        if(num == 10 && newdata!= null){
                          //reEquipmentStatus(newdata);
                        }
                          var str = '';
                          str = "<font color='red'>"+ num+" </font>" + "秒后刷新 ";
                          document.getElementById('autoDir').innerHTML ="";
                          document.getElementById('autoDir').innerHTML = str;*/
                        //  alert(num_s);
                        document.getElementById('autoDir').innerHTML = "<font color='red'>" + num_s + "</font>" + " 秒后刷新 ";
                        num_s--;
                        countnum = setTimeout(countDown, 1000);
                      } else {
                        num_s = getRefreshTime();
                        if (alSwitch == true) {
                          al();
                        }
                        countDown();
                      }
                    }
                    /////////////////////////显示车牌号码begin/////////////////////////////
                    function LableMarker(map, text, latLng) {
                      this.map_ = map;
                      this.text_ = '<div class="iconTheStyle" style="background:#f5fcb8;  font-size:12px; color:#000000; font-weight:bold; white-space:nowrap; border:1px solid #666666;">' + text + '</div>';
                      this.latLng_ = latLng;
                      this.div_ = null;
                      this.setMap(map);

                    }
                    try {
                      // 继承自  google.maps.OverlayView
                      LableMarker.prototype = new google.maps.OverlayView();
                    } catch (e) { }
                    // 当准备将 悬浮层 添加到地图上时 调用
                    LableMarker.prototype.onAdd = function () {
                      var div = document.createElement('DIV');
                      div.style.border = 'none';
                      div.style.position = 'absolute';
                      div.innerHTML = this.text_;
                      this.div_ = div;
                      var panes = this.getPanes();
                      panes.overlayLayer.appendChild(div);
                    };

                    // 当第一次在地图上显示时 调用
                    LableMarker.prototype.draw = function () {
                      var overlayProjection = this.getProjection();
                      var latLng = overlayProjection.fromLatLngToDivPixel(this.latLng_);
                      // 设置层的大小 和 位置
                      var div = this.div_;
                      var size = new google.maps.Size(10, -10); // 修正坐标的值;
                      div.style.left = (latLng.x + size.width) + 'px';
                      div.style.top = (latLng.y + size.height) + 'px';
                    };
                    // 当设置 悬浮层的 setMap(null) 会自动调用 
                    LableMarker.prototype.onRemove = function () {
                      this.div_.parentNode.removeChild(this.div_);
                      this.div_ = null;
                    };

                    //地图添加MAPabc
                    function addMAPabc(map) {//添加MAPabc的瓦片 参数为地图对象  
                      var _tileSize = new google.maps.Size(256, 256);
                      var getTileUrl = function (tile, zoom) {
                        return "http://emap" + ((tile.x + tile.y) % 4) + ".mapabc.com/mapabc/maptile?v=w2.99&x=" + tile.x + "&y=" + tile.y + "&zoom=" + (17 - zoom);
                      };
                      var imageMapType = new google.maps.ImageMapType({ alt: "MAPabc", isPng: true, maxZoom: 18, minZoom: 1, name: "MAPabc", tileSize: new google.maps.Size(256, 256), opacity: 1.0, getTileUrl: getTileUrl });
                      map.mapTypes.set('MAPabc', imageMapType);
                    }
                    //显示路况信息

                    var isShowTraffic = true;
                    var trafficLayer = null;
                    function showTraffic() {
                      if (mapType == 2) {
                        if (isShowTraffic) {
                          document.getElementById("traffic-switcher").className = "maplibTcBtn google";
                          trafficLayer = new google.maps.TrafficLayer();
                          trafficLayer.setMap(map);
                          isShowTraffic = false;
                        } else {
                          document.getElementById("traffic-switcher").className = "maplibTcBtnOff maplibTcBtn google";
                          trafficLayer.setMap(null);
                          isShowTraffic = true;
                        }
                      } else {
                        addOrDelTra();
                      }
                    }

                    var temp = 0;
                    var traffic = new BMap.TrafficLayer();
                    function addOrDelTra() {
                      // 创建交通流量图层实例
                      temp = temp + 1;
                      if (temp > 2) {
                        temp = 1;
                      }
                      if (temp == 1) {
                        document.getElementById("traffic-switcher").className = "maplibTcBtn google";
                        baidMap.addTileLayer(traffic)
                      }
                      if (temp == 2) {
                        document.getElementById("traffic-switcher").className = "maplibTcBtnOff maplibTcBtn google";
                        baidMap.removeTileLayer(traffic)
                      }
                    }


                    /////////////////////////显示车牌号码end/////////////////////////////

                    var isShowToolPane = false;
                    function showtoolPanel() {
                      isShowToolPane = true;
                      $("#tools_box").show();
                    }
                    function hidetoolPanel() {
                      setTimeout(function () {
                        if (!isShowToolPane) {
                          $("#tools_box").hide();
                          isShowToolPane = false;
                          $("#showHistoryWin").animate({ width: 0 }, 200);
                          $("#showHistoryWin").hide();
                          historyQuery.isShowHistoryWin = false;
                        }
                      }, 500);
                    }
                    function updateWeizhi(id) {
                      $.ajax({
                        type: "POST",
                        dataType: "json",
                        url: "json/vehicleAction_refreshPostion.action",
                        data: { ids: id },
                        success: function (json) {
                        },
                        error: function () {
                        }
                      });
                    }
                    var obd_id = 0;
                    function getObdData() {

                      $.ajax({
                        type: "POST",
                        dataType: "json",
                        url: "json/obdAction_getOBDdata.action",
                        data: { vid: obd_id },
                        success: function (json) {
                          //if(json.data != null){
                          if (json.data.length > 0) {
                            var html = "";
                            var obd = json.data[0];
                            if (json.type == 1) {
                              html = "<ul><li>电量百分比：" + obd[0] + "</li>"
                                + "<li>母线电压：" + obd[1] + "</li>"
                                + "<li>电机温度：" + obd[2] + "</li>"
                                + "<li>控制器温度：" + obd[3] + "</li>"
                                + "<li>母线电流：" + obd[4] + "</li>"
                                + "<li>档位：" + obd[5] + "</li>"
                                + "<li>ACC：" + obd[6] + "</li>"
                                + "<li>最高电压电池号：" + obd[7] + "</li>"
                                + "<li>最高电压单体编号：" + obd[8] + "</li>"
                                + "<li>最高单体电压：" + obd[9] + "</li>"
                                + "<li>最低电压电池号：" + obd[10] + "</li>"
                                + "<li>最低电压单体编号：" + obd[11] + "</li>"
                                + "<li>最低单体电压：" + obd[12] + "</li>"
                                + "<li>最高温度电池号：" + obd[13] + "</li>"
                                + "<li>最高温度单体编号：" + obd[14] + "</li>"
                                + "<li>最高温度：" + obd[15] + "</li>"
                                + "<li>最低温度电池号：" + obd[16] + "</li>"
                                + "<li>最低温度单体编号：" + obd[17] + "</li>"
                                + "<li>最低温度：" + obd[18] + "</li></ul>";
                            } else if (json.type == 3) {
                              html = "<ul><li>电压：" + obd[0] + "</li>"
                                + "<li>电流：" + obd[1] + "</li>"
                                + "<li>最大电压：" + obd[2] + "</li>"
                                + "<li>最小电压：" + obd[3] + "</li>"
                                + "<li>最大电压电池号：" + obd[4] + "</li>"
                                + "<li>最小电压电池号：" + obd[5] + "</li>"
                                + "<li>最高温度：" + obd[6] + "</li>"
                                + "<li>最大温度电池号：" + obd[7] + "</li>"
                                + "<li>最小温度：" + obd[8] + "</li>"
                                + "<li>最小温度电池号：" + obd[9] + "</li>"
                                + "<li>故障等级：" + obd[10] + "</li>"
                                + "<li>故障代码：" + obd[11] + "</li>"
                                + "<li>充电状态：" + obd[12] + "</li>"
                                + "<li>平均温度：" + obd[13] + "</li>"
                                + "<li>电量百分比：" + obd[14] + "</li>"
                                + "<li>绝缘状态：" + obd[15] + "</li>"
                                + "<li>功率：" + obd[16] + "</li>"
                                + "<li>快速充电电流：" + obd[17] + "</li>"
                                + "<li>慢速充电电流：" + obd[18] + "</li></ul>";
                            } else if (json.type == 4) {
                              html = "<ul><li>行驶里程：" + obd[0] + "</li>"
                                + "<li>总里程：" + obd[1] + "</li>"
                                + "<li>瞬时油耗：" + obd[2] + "</li>"
                                + "<li>百公里油耗：" + obd[3] + "</li>"
                                + "<li>平均油耗：" + obd[4] + "</li>"
                                + "<li>本次油耗：" + obd[5] + "</li>"
                                + "<li>累计油耗：" + obd[6] + "</li>"
                                + "<li>累计行驶时间：" + obd[7] + "</li>"
                                + "<li>累计怠速时间：" + obd[8] + "</li>"
                                + "<li>平均热车时间：" + obd[9] + "</li>"
                                + "<li>行驶时间：" + obd[10] + "</li>"
                                + "<li>车速：" + obd[11] + "</li>"
                                + "<li>发动机转速：" + obd[12] + "</li>"
                                + "<li>平均速度：" + obd[13] + "</li>"
                                + "<li>最高速度：" + obd[14] + "</li>"
                                + "<li>发动机最高转速：" + obd[15] + "</li>"
                                + "<li>水温：" + obd[16] + "</li>"
                                + "<li>冷却液温度：" + obd[17] + "</li>"
                                + "<li>发动机负荷：" + obd[18] + "</li>"
                                + "<li>节气门开度：" + obd[19] + "</li>"
                                + "<li>点火次数：" + obd[20] + "</li>"
                                + "<li>碰撞预警：" + obd[21] + "</li>"
                                + "<li>车身故障码：" + obd[22] + "</li>"
                                + "<li>电瓶电压：" + obd[23] + "</li></ul>";
                            } else {
                              html = "累积里程：" + obd[0] + " km<br/>"
                                + "瞬时油耗：" + obd[1] + "<br/>"
                                + "平均油耗：" + obd[2] + "<br/>"
                                + "行驶时间：" + obd[3] + "<br/>"
                                + "车速：" + obd[4] + " km/h<br/>"
                                + "动力负荷：" + obd[5] + "<br/>"
                                + "水温：" + obd[6] + " ℃<br/>"
                                + "节气门开度：" + obd[7] + "<br/>"
                                + "发动机转速：" + obd[8] + "<br/>"
                                + "蓄电池电压：" + obd[9] + " V<br/>"
                                + "故障码：" + obd[10] + "<br/>";
                            }

                            $("#obdinfo").html(html);
                          } else {
                            $("#obd_null").show();
                            $("#obd_nonull").hide();

                          }
                        },
                        error: function () {

                        }
                      });
                    }
                    function opobd(vid) {
                      //alert($("#trackContentWin_obd"));
                      //alert(vid);
                      $("#obd_nonull").show();
                      $("#obd_null").hide();
                      $("#obdinfo").html("");
                      $("#trackContentWin_obd").fadeIn("fast");
                      $("#trackContentWin_obd").center();

                      obd_id = vid;
                      getObdData(vid);
                    }
                  </script>


                  <style type="text/css">
                    .address {
                      width: 420px;
                      height: 20px;
                      line-height: 20px;
                      position: absolute;
                      z-index: 10;
                      background: none repeat scroll 0 0 #F7F7F7;
                    }

                    .address span {
                      display: inline-block;
                      float: left;
                    }

                    .address .map_time {
                      margin-left: 5px;
                      margin-right: 15px;
                    }


                    /*--map 弹出框--*/
                    .map_tanchu_wrap p {
                      margin: 0;
                      padding: 5px 10px;
                      font-size: 12px;
                      background: #fff;
                    }

                    .map_tanchu_areaQuery_wrap {
                      background: transparent;
                      background-color: #FFFFFF;
                      width: 300px;
                      height: 150px;
                      margin: 0 3px;
                      /*margin-left:100px;*/
                      box-shadow: 0px 2px 2px #d9d7d4
                    }

                    .map_tanchu_areaQuery_wrap p {
                      margin: 0;
                      padding: 5px 10px;
                      font-size: 12px;
                      background: #fff;
                    }

                    .map_tanchu_areaQuery_wrap p b {
                      display: block;
                      overflow: hidden;
                      margin-bottom: 5px;
                    }

                    .areaQuery_img {
                      margin-top: -2px;
                      display: inlin-block;
                    }


                    .baiduareaQuery_img {
                      margin-top: -2px;
                      display: block;
                      float: left;
                    }


                    .xboxcontent_areaQuery {
                      display: block;
                      border: 0 solid #c2c1be;
                      border-width: 0 1px;
                      background-color: #FFFFFF;
                      height: 120px;
                      margin-top: 22px;
                      overflow: auto;
                      width: 298px;
                    }

                    .baiduboxcontent_areaQuery {
                      display: block;
                      height: 100px;
                      margin-top: 22px;
                      overflow: auto;
                      width: 300px;
                    }

                    .baiduboxcontent_areaQuery p b {
                      display: block;
                      overflow: hidden;
                      margin-bottom: 5px;
                    }


                    .baiduboxcontent_areaQuery p p {
                      margin: 0;
                      padding: 5px 10px;
                      font-size: 12px;
                      background: #fff;
                    }

                    .map_tanchu_wrap {
                      background: transparent;
                      width: 300px;
                      overflow: hidden;
                      height: auto;
                      margin: 0 3px;
                      margin-left: 100px;
                      box-shadow: 0px 2px 2px #d9d7d4
                    }

                    .xtop,
                    .xbottom {
                      display: block;
                      background: transparent;
                      font-size: 1px;
                    }

                    .xb1,
                    .xb2,
                    .xb3,
                    .xb4 {
                      display: block;
                      overflow: hidden;
                    }

                    .xb1,
                    .xb2,
                    .xb3 {
                      height: 1px;
                    }

                    .xb2,
                    .xb3,
                    .xb4 {
                      background: #fff;
                      border-left: 1px solid #c2c1be;
                      border-right: 1px solid #c2c1be;
                    }

                    .xb1 {
                      margin: 0 5px;
                      background: #c2c1be;
                    }

                    .xb2 {
                      margin: 0 3px;
                      border-width: 0 2px;
                    }

                    .xb3 {
                      margin: 0 2px;
                    }

                    .xb4 {
                      height: 2px;
                      margin: 0 1px;
                    }

                    .xboxcontent {
                      display: block;
                      border: 0 solid #c2c1be;
                      border-width: 0 1px;
                      height: auto;

                    }

                    span {
                      _overflow: hidden;
                    }

                    .arrow {
                      position: absolute;
                      margin-top: -2px;
                      margin-left: 50px;
                      width: 0;
                      height: 0;
                      font-size: 0;
                      border-width: 12px;
                      border-style: solid dashed dashed dashed;
                      border-color: #ffffff transparent transparent transparent;
                      z-index: 20;
                    }

                    .arrow_bg {
                      position: absolute;
                      margin-top: -1px;
                      margin-left: 50px;
                      width: 0;
                      height: 0;
                      font-size: 0;
                      border-width: 12px;
                      border-style: solid dashed dashed dashed;
                      border-color: #c2c1be transparent transparent transparent;
                      z-index: 15;
                    }

                    .maplibTcBtn {
                      background-color: #8EA8E0;
                      border: 1px solid #8BA4DC;
                      border-radius: 3px;
                      box-shadow: 2px 2px 3px rgba(0, 0, 0, 0.35);
                      color: #FFFFFF;
                      cursor: pointer;
                      margin: 0;
                      padding: 2px 6px;
                      position: absolute;
                      right: 90px;
                      text-align: center;
                      top: 55px;
                      white-space: nowrap;
                      width: 60px;
                      z-index: 10;
                    }

                    .maplibTcBtn.google {
                      right: 100px;
                      top: 45px;
                    }

                    .maplibTcBtnOff {
                      background-color: #FFFFFF;
                      color: #000000;
                    }

                    .maplibTcBtn span {
                      font: 12px/1.3em arial, simsun, sans-serif;
                    }
                  </style>
                </head>

                <body>
                  <div class="map_message">
                    <div style="float:right">
                      <ul>
                        <li>
                          <select id="select" onchange="cutoverMap();" style="font-weight: normal; color: #C33;">
                            <option value="1">百度地图</option>
                            <option value="2" selected>谷歌地图</option>
                            <!-- <option value="3" selected>高德地图</option> -->
                          </select>
                        </li>
                        <li style="margin:0px 10px;"><span class="marker_fenge_line"></span></li>
                        <li id="markerPermissionsPanelBtn">
                          <a href="javascript:;" onclick="openmarkerPanel(1);">
                            <span class="marker_biaozhu"></span>
                            标注
                          </a>
                        </li>
                        <li id="fencePermissionsPanelBtn" style="display: none;">
                          <a href="javascript:;" onclick="openmarkerPanel(2);">
                            <span class="weilan"></span>
                            围栏
                          </a>
                        </li>
                        <li>
                          <a href="javascript:;" onmouseover="showtoolPanel();"
                            onmouseout="isShowToolPane=false;hidetoolPanel();">
                            <span class="marker_gongju"></span>
                            <span>工具</span>
                            <span class="marker_gongju_xiala" style="margin-left:7px; margin-right:0px;"></span>
                          </a>

                          <!--工具条-->
                          <div onmouseout="isShowToolPane=false;hidetoolPanel();" onmouseover="showtoolPanel();"
                            class="gongju_main" id="tools_box" style="display:none;">
                            <a href="javascript:;" onclick="isShowToolPane=false;openDistance();">
                              <span class="marker_ceju"></span>
                              测距
                            </a>
                            <a href="javascript:;" onclick="isShowToolPane=false;addRectangShape();">
                              <span class="marker_quyu"></span>
                              当前区域查寻
                              <!-- 
                                <label onclick="historyQuery.showHistoryWin(event);" style="display: inline;">
                                	<img src="/mygpsonline/gpsonline/image/tool/dot_2.gif" style="display: inline-block; height: 8px; width: 8px;"></img>
                                </label> -->
                            </a>
                            <a href="javascript:isShowToolPane=false;historyQuery.toHistoryQuery(null);">
                              <span class="area_history_query"></span>
                              历史区域查询
                            </a>
                          </div>

                          <div class="gongju_main"
                            style="width: 0px;position: absolute;;margin-left: 80px;margin-top:28px;display:none;"
                            id="showHistoryWin" onmouseover="isShowToolPane=true;historyQuery.isShowHistoryWin=true;"
                            onmouseout="isShowToolPane=false;historyQuery.isShowHistoryWin=false;historyQuery.closeHistoryWin(event);">
                            <a href="javascript:historyQuery.toHistoryQuery(null);">
                              历史区域查询
                            </a>
                          </div>
                          <!--工具条 end-->
                        </li>
                        <li>
                          <a href="javascript:showMap()" id="closefullscreenbtn" style="display:none">
                            <span class="marker_quanping"></span>
                            全屏地图
                          </a>
                          <a href="javascript:showMap();" id="fullscreenbtn" style="display:none">
                            <span class="marker_quanping_out"></span>
                            退出全屏
                          </a>
                        </li>
                        <li><span class="marker_fenge_line"></span></li>
                        <span class="marker_shebei" style="display: none;">
                          <input style="display: none;" id="largeDateShowVehicle" type="checkbox" name="checkbox1"
                            value="checkbox" onclick="largeDataShowAllVechileonMap(this)">数据过多时仍显示所有设备
                        </span>

                        <li>
                          <span class="marker_shebei">
                            <input type="checkbox" name="checkboxcarname" value="checkbox" id="isShowCarName"
                              onclick="showCarName();">显示设备名
                          </span>
                        </li>
                        <li id="markerNamePermissionsPanelBtn">
                          <span class="marker_shebei">
                            <input id="bzShowNamekbox" name="bzcheckbox" type="checkbox" value="checkbox"
                              onclick="showMarkerName(this);">显示标注名
                          </span>
                        </li>
                      </ul>

                    </div>

                    <!--  <div id="weizhi" > </div> -->
                    <span id="weizhi"
                      style='float: left;white-space:nowrap;display:inline-block; overflow:hidden;text-overflow: ellipsis;width: 410px;position: absolute;'
                      title=""></span>
                  </div>

                  <div class="map_canvas">
                    <div class="address" style="width:auto;z-index:10;">
                      <span id="autoDir" class="map_time"></span>
                    </div>
                    <div id="container" style="display:none;"></div>

                    <div id="map_canvas" style="width:100% !important; height:100% !important;position: absolute;">
                    </div>

                    <div id="close_stree" style="right: 5px;top:3px; z-index: 999999;position: absolute;display: none;">
                      <a href="javascript:;" title="关闭" class="close_stree_view" onclick="streeViewObject.close();"></a>
                    </div>
                    <div id="pano_container"
                      style="height: 100%;width: 50%;float:right;background-color:#f7f8f9; display: none;"></div>

                    <div id="tencMap" style="width:100%; height:100%;position: absolute;display: none;">
                    </div>

                  </div>

                  <div id="traffic-switcher" onClick="showTraffic();" class="maplibTcBtnOff maplibTcBtn google">
                    <span>路况信息</span>
                  </div>

                  <div id="fence-msg" class="maplibTcBtnOff maplibTcBtn google"
                    style="width: 240px;right: 42%;display: none;">
                    <span id="fence_lien" style="display: none;">电子围栏---规划路线<span
                        style="color: red;">(ctrl+左键,ECS结束)</span></span>
                    <span id="fence_poly" style="display: none;">电子围栏---多边形<span
                        style="color: red;">(ECS键结束)</span></span>
                  </div>

                  <form id="toHistoryQuery" action="/mygpsonline/gpsonline/jsp/monitor/historyQuery.jsp" target="_blank"
                    method="post">
                    <!-- <input id="toHistoryQuery_ids" name="ids" value="" type="hidden"/> -->
                    <input id="toHistoryQuery_center_lng" name="center_lng" value="" type="hidden" />
                    <input id="toHistoryQuery_center_lat" name="center_lat" value="" type="hidden" />
                    <input id="toHistoryQuery_mapType" name="mapType" value="" type="hidden" />
                    <input id="toHistoryQuery_zoom" name="zoom" value="" type="hidden" />
                  </form>
                  <!-- 
	<script type="text/javascript" src="http://ditu.google.cn/maps/api/js?sensor=false&libraries=drawing&key=AIzaSyDZis631eei5VArZqB-lP2DDOSgPrhLR5A"></script>
  -->
                </body>

                </html>
              </div>
            </div>
            <!--right end-->
          </div>
          <!--main end-->
        </div>
      </b>
    </b>
  </div>
  <!-- 电子围栏弹出菜单开始 -->
  <div id="electronicFence_tree_Menu" style="z-index: 900;">
    <ul>
      <li id="electronicFence_tree_Menu_refresh" onclick="electronicFence.tree.menu.refresh();"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">刷新围栏</li>

      <li id="electronicFence_tree_Menu_add" onclick="electronicFence.tree.menu.add();"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">增加围栏</li>
      <!-- 
				<li id="he_1">
					<div style="overflow:hidden;background:#999;height:1px;"></div>
				</li>
				-->
      <li id="electronicFence_tree_Menu_update" onclick="electronicFence.tree.menu.update();"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">修改名称</li>
      <!-- 
				<li id="he_2"  style="padding-top: 0px;">
					<div style="overflow:hidden;background:#999;height:1px;"></div>
				</li>
				-->
      <li id="electronicFence_tree_Menu_del" onclick="electronicFence.tree.menu.del();"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">删除对象</li>
      <!-- 
				<li id="he_3"  style="padding-top: 0px;">
					<div style="overflow:hidden;background:#999;height:1px;"></div>
				</li>
				 -->
      <li id="electronicFence_tree_Menu_event" onclick="electronicFence.tree.menu.editEvent();"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">编辑事件</li>

      <li id="electronicFence_tree_Menu_bingding" onclick="electronicFence.tree.menu.bingding();"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">绑定设备</li>
    </ul>
  </div>
  <!-- 电子围栏弹出菜单结束 -->


  <!-- 标注弹出菜单开始 -->
  <div id="marker_tree_Menu" style="z-index: 900;">
    <ul>
      <!-- 
				<li id="he_1">
					<div style="overflow:hidden;background:#999;height:1px;"></div>
				</li>
				-->
      <li id="marker_tree_Menu_update" markerId="" onclick="MarkerTreeMenu.update(this);"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">修改标注</li>
      <!-- 
				<li id="he_2"  style="padding-top: 0px;">
					<div style="overflow:hidden;background:#999;height:1px;"></div>
				</li>
				-->
      <li id="marker_tree_Menu_del" markerId="" onclick="MarkerTreeMenu.del(this);"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">删除标注</li>
      <!-- 
				<li id="he_3"  style="padding-top: 0px;">
					<div style="overflow:hidden;background:#999;height:1px;"></div>
				</li>
				 -->
      <li id="marker_tree_Menu_bingding" markerId="" onclick="MarkerTreeMenu.bingding(this);"
        onmouseover="this.style.color='#f00';" onmouseout="this.style.color=''">绑定设备</li>
    </ul>
  </div>
  <!-- 标注弹出菜单结束 -->

  <!-- 标注车辆绑定窗口开始 -->
  <div class="marker_vehicle_binding_Box" id="marker_vehicle_binding_ContentWin"
    style="display: none;font-weight: normal;">
    <div class="top"></div>
    <div class="center">
      <h3 id="move_marker_vehicle_binding_Win">
        <a href="javascript:;" title="关闭" class="message_close" id="close_marker_vehicle_binding_Win"></a>
        <span id="markerBangdingVehicleTitle">标注绑定设备</span>
      </h3>
      <div id="marker_vehicle_binding_main">
        <table border="0" style="line-height:45px;">
          <tr>
            <td>
              <span style="margin-left: 30px; display: block;">
                <span style="margin-left: 30px;">
                  所属分组: <select id="marker_vehicle_group" style="margin-right: 50px;"
                    onchange="showVechiletoMarkerbangdingTable($(this).val().split('_')[0])"></select>
                </span>
              </span>
            </td>
          </tr>
          <tr>
            <td>
              <div id="marker_vehicle_table_title">
                <table border="0" align="center" cellpadding="0" cellspacing="0" class="marker_table_style"
                  style="line-height: 25px;width: 100%;">
                  <thead>
                    <tr id="marker_table_title">
                      <th scope="col" style="width: 100px;">
                        车牌号码
                      </th>
                      <th scope="col" style="width: 100px;">
                        驶入报警
                      </th>
                      <th scope="col" style="width: 100px;">
                        驶出报警
                      </th>
                      <th scope="col" style="width: 100px;">
                        记录出入
                      </th>
                      <th scope="col">
                        停车超时(分钟)
                      </th>
                    </tr>
                  </thead>
                </table>
                <div id="marker_vehicle_content"
                  style="display: block; overflow-y: auto;overflow-x: hidden; top: 60px;height: 156px;overflow:auto;border-bottom: 1px solid #e8e8e8; ">

                  <table id="marker_vehicle_table_content" border="0" align="center" cellpadding="0" cellspacing="0"
                    class="marker_table_style" style="line-height: 25px;">
                    <tbody>
                    </tbody>
                  </table>
                </div>
              </div>
      </div>
      </td>
      </tr>
      <tr>
        <td>
          <span style="color: red; margin-left: 100px; position: absolute;" id="markersaveMsg"></span>
          <input type="button" id="saveMarkerBtn" markerId="" value="确定" onclick="savebingdingVehicletoMarker(this)"
            style="width:80px; height:30px; margin-left:43%; margin-top:10px;margin-bottom: 10px;" />
        </td>
      </tr>
      </table>
    </div>
  </div>
  <div class="bot"></div>
  </div>
  <!-- 标注车辆绑定窗口结束 -->



  <!-- 电子围栏窗口开始 -->
  <div class="electronicFence_Box" id="electronicFence_ContentWin" style="display: none;">
    <div class="top"></div>
    <div class="center">
      <h3 id="move_electronicFence_Win">
        <a href="javascript:;" title="关闭" class="message_close" id="close_electronicFence_Win"></a>
        <span>电子围栏属性</span>
      </h3>
      <div class="electronicFence_main" id="electronicFence_main">

        <table width="100%" border="0" style="line-height:35px;">
          <tr>
            <td style="width:60px;">围栏名称: </td>
            <td style="width:120px;">
              <input type="text" id="electronicFence_name"></input>
              <input type="hidden" id="electronicFence_type" value="0"></input>
            </td>
            <td style="width:60px;"><span style="color:rgb(153, 153, 153);" id="fenceAddNameMsg">*不能为空</span></td>
          </tr>
          <tr>
            <td></td>
            <td>
              <input type="button" id="saveFenceBtn_" value="确定" onclick="electronicFence.win.add();"
                style="width:80px; height:30px; margin-left:30px; margin-top:20px;" />
              <input type="button" id="updateFenceBtn_" value="修改" onclick="electronicFence.win.update();"
                style="width:80px; height:30px; margin-left:30px; margin-top:20px;display: none;" />
            </td>
            <td></td>
          </tr>
        </table>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 电子围栏窗口结束 -->

  <!-- 电子围编辑事件窗口开始 -->
  <div class="electronicFence_event_Box" id="electronicFence_event_ContentWin" style="display: none;">
    <div class="top"></div>
    <div class="center">
      <h3 id="move_electronicFence_event_Win">
        <a href="javascript:;" title="关闭" class="message_close" id="close_electronicFence_event_Win"></a>
        <span>编辑事件</span>
      </h3>
      <div class="electronicFence_event_main" id="electronicFence_event_main">

        <table width="100%" border="0" style="line-height:35px;">
          <tr>
            <td>
              <div style="border: 1px solid #CCC; width: 150px;height: 250px;">
                <div id="electronicFence_event_tree_canvas" style="width: 140px; height: 240px; overflow-y: auto;">
                  <ul id="electronicFence_event_tree" class="ztree"></ul>
                </div>
              </div>
            </td>
            <td>
              <div style="border: 0px solid #CCC; width: 200px;height: 250px;padding: 2px 2px 2px 2px;">
                <div style="height: 40%;">
                  拍照间隔<input type="text" id="photo_time" style="width: 100px;" value="5"> </input>分钟<br />
                  最大拍照次数<input type="text" id="photo_times" style="width: 100px;" value="1"> </input>次
                </div>
                <div style="height: 60%;">
                  <fieldset style="border: 1px solid #CCC;padding: 2px 2px 2px 2px;">
                    <legend style="margin-left: 10px;">触发条件</legend>
                    <input type="checkbox" value="1" name="triggeringCondition">进区域报警时</input>
                    <input type="checkbox" value="2" name="triggeringCondition">在区域/在路线</input><br />
                    <input type="checkbox" value="3" name="triggeringCondition">出区域报警时</input><br />

                    起<input type="text" name="fence_startTime" id="fence_start" value="00:00:00" style="width: 70px;"
                      onkeydown="return false" onkeyup="return false" oncontextmenu="return false" class="Wdate"
                      onclick="WdatePicker({isShowClear:false,isShowToday:false,el:$dp.$('d12'),skin:'simple',dateFmt:'HH:mm:ss',maxDate:'#F{$dp.$D(\'fence_end\')}'})" />
                    &nbsp;

                    止<input type="text" name="fence_endTime" id="fence_end" value="23:23:59" style="width:70px;"
                      onkeydown="return false" onkeyup="return false" oncontextmenu="return false" class="Wdate"
                      onclick="WdatePicker({isShowClear:false,isShowToday:false,el:$dp.$('d12'),skin:'simple',dateFmt:'HH:mm:ss',minDate:'#F{$dp.$D(\'fence_start\')}'})" />

                  </fieldset>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <td>
            </td>
            <td>
              <input type="button" value="保存" onclick="saveFenceEvent()"></input>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 电子围栏编辑事件窗口结束 -->


  <!-- 电子围栏车辆绑定窗口开始 -->
  <div class="electronicFence_vehicle_binding_Box" id="electronicFence_vehicle_binding_ContentWin"
    style="display: none;font-weight: normal;">
    <div class="top"></div>
    <div class="center">
      <h3 id="move_electronicFence_vehicle_binding_Win">
        <a href="javascript:;" title="关闭" class="message_close" id="close_electronicFence_vehicle_binding_Win"></a>
        <span>电子围栏绑定设备</span>
      </h3>
      <div id="electronicFence_vehicle_binding_main">
        <table width="100%" border="0" style="line-height:45px;">
          <tr>
            <td>
              <span style="margin-left: 30px; display: block;">
                <input type="radio" onchange="changefenceTypeRadio(1);" name="electronicFence_type_radio"
                  id="electronicFence_type_polyArea" value="1">多边形区域</input>
                <input type="radio" onchange="changefenceTypeRadio(2);" name="electronicFence_type_radio"
                  id="electronicFence_type_line" style="margin-left: 30px;display: none;" value="2"><span
                  style="display: none;">规划行驶路线</span></input>
                <span style="margin-left: 30px;">
                  所属分组: <select id="fence_vehicle_group" style="margin-right: 50px;width: 100px;"
                    onchange="showVechiletoFenceTable($(this).val().split('_')[2])"></select>
                </span>
                <span style="">
                  选择围栏: <select id="fence_selecte_id" onchange="changefence()" style="width: 100px;"></select>
                </span>
              </span>
            </td>
          </tr>
          <tr>
            <td>
              <div id="electronicFence_vehicle_table_title">
                <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="table_style"
                  style="line-height: 25px;">
                  <thead>
                    <tr id="fence_lien_table_title" style="display: none;">
                      <th scope="col">
                        车牌号码
                      </th>
                      <th width="90px;" scope="col">
                        偏离距离(米)
                      </th>
                      <th scope="col">
                        超时停车(分钟)
                      </th>
                      <th scope="col">
                        最高速度(km/h)
                      </th>
                      <th scope="col">
                        开始时间
                      </th>
                      <th scope="col">
                        结束时间
                      </th>
                    </tr>
                    <tr id="fence_poly_table_title" style="display: none;">
                      <th scope="col">
                        车牌号码
                      </th>
                      <th scope="col">
                        报警类型
                      </th>
                      <th scope="col">
                        围栏内限速
                      </th>
                      <th scope="col">
                        开始时间
                      </th>
                      <th scope="col">
                        结束时间
                      </th>
                    </tr>
                  </thead>
                </table>
                <div id="electronicFence_vehicle_content"
                  style="display: block; overflow-y: auto;overflow-x: hidden; top: 60px;height: 156px;overflow:auto;border-bottom: 1px solid #e8e8e8; ">

                  <table id="electronicFence_vehicle_table_content" width="100%" border="0" align="center"
                    cellpadding="0" cellspacing="0" class="table_style" style="line-height: 25px;">
                    <tbody>
                    </tbody>
                  </table>
                </div>
              </div>
      </div>
      </td>
      </tr>
      <tr>
        <td>
          <span style="color: red; margin-left: 100px; position: absolute;" id="fencesaveMsg"></span>
          <input type="button" id="saveFenceBtn" value="确定" onclick="savebingdingVehicletoFence()"
            style="width:80px; height:30px; margin-left:230px; margin-top:10px;margin-bottom: 10px;" />
          <input type="button" id="cancleFenceBtn" value="全部取消" onclick="cancleFencebingdingVehicletoFence()"
            style="width:80px; margin-left:50px;  height:30px; margin-top:10px;" />
        </td>
      </tr>
      </table>
    </div>
  </div>
  <div class="bot"></div>
  </div>
  <!-- 电子围栏车辆绑定窗口结束 -->





  <!-- 弹出菜单开始 -->
  <div class="downMenus" id="downMenus" style="display: none;">
    <div class="secondMenus" id="secondMenus" style="z-index:10000;">
      <ul>
        <!-- <li>设备信息</li>-->
        <li id="order">
          <span style="float:right">&gt;&gt;</span>
          设备指令
        </li>
        <li id="fortification">
          <span style="float:right">&gt;&gt;</span>
          原地设防
        </li>
        <li onclick="openReport(this);">统计报表</li>
        <li onclick="loadtrack(this);" id="down_back_item">下载轨迹</li>
        <li onclick="trafficViolation(this);">违章查询</li>
        <li onclick="VhcImg.openWin2(this);">设备图库</li>
        <li onclick="showCarOwiner(this);">车主信息</li>
        <li onclick="showCarBaseinfo(this);">设备基本信息</li>
      </ul>
    </div>
    <div class="thridMenus" id="thridMenus" style="z-index:20000;">
      <div>
        <Li id="thridMenusup">︽</Li>
      </div>
      <ul>
      </ul>
      <div>
        <Li id="thridMenusdown">︾</Li>
      </div>
    </div>
  </div>
  <!-- 弹出菜单结束 -->

  <!-- 修改密码窗口开始 -->
  <div class="updatePasswordBox" id="updatePasswordContentWin" style="display: none;">
    <div class="top"></div>
    <div class="center">
      <h3 id="movePasswordWin">
        <a href="javascript:;" title="关闭" class="message_close" id="closePasswordWin"></a>
        <span>修改密码</span>
      </h3>
      <div class="passwordMessage_main" id="passwordMessage_main">

        <ul>
          <li style="text-align:center;"><span id="updatePasswordMsg" style="color:rgb(153, 153, 153);">*密码不能为空!</span>
          </li>
        </ul>
        <table width="100%" border="0" style="line-height:35px;">
          <tr>
            <td>当前密码: </td>
            <td>
              <input type="password" id="curPassword"></input>
            </td>
          </tr>
          <tr>
            <td>新密码: </td>
            <td>
              <input type="password" id="newPassword"></input>
            </td>
          </tr>
          <tr>
            <td>确认密码: </td>
            <td>
              <input type="password" id="renewPassword">
            </td>
          </tr>
          <tr>
            <td></td>
            <td>
              <input type="button" id="updatePassBtn" value="修改" onclick="updatePassword();"
                style="width:80px; height:30px; margin-left:30px; margin-top:20px;" />
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 修改密码窗口结束-->
  <!--设置系统参数窗口开始 -->
  <div class="setSystemBox" id="setSystemContentWin" style="display: none;z-index: 99999;">
    <div class="top"></div>
    <div class="center">
      <h3 id="moveSetSystemWin">
        <a href="javascript:;" title="关闭" class="message_close" id="closeSetSystemWin"></a>
        <span id="syssetting_span_id">设置系统参数</span>
      </h3>
      <div class="tanchu_top" id="mean2">
        <ul>
          <li>
            <a class="tanchu_qh_select" href="javascript:sysSetTab_(2);" id="sysSetT_2">系统参数</a>
            <span>|</span>
          </li>
          <li>
            <a href="javascript:sysSetTab_(1);" id="sysSetT_1">浮动框信息</a>
          </li>
        </ul>
      </div>
      <div class="setSystemMessage_main" id="setSystemMessage_main">
        <table width="88%" border="0" style="line-height:35px;margin-top: 20px;" id="sysSet_span_1">
          <tr>

            <td align="rigth"><input type="checkbox" id="systemParm_map_win_p1" style="float: right;" checked="checked"
                disabled="disabled"></input></td>
            <td align="left" style="width: 55px;">设备名称</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p2"></input></td>
            <td align="left" style="width: 60px;">服务器时间</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p3"></input></td>
            <td align="left" style="width: 55px;">速&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;度</td>
          </tr>
          <tr>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p4"></input></td>
            <td align="left" style="width: 55px;">方&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;向</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p5"></input></td>
            <td align="left" style="width: 55px;">温&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;度</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p6"></input></td>
            <td align="left" style="width: 55px;">油&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;量</td>
          </tr>
          <tr>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p7"></input></td>
            <td align="left" style="width: 55px;">当日里程</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p8"></input></td>
            <td align="left" style="width: 55px;">总里程&nbsp;&nbsp;</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p9"></input></td>
            <td align="left" style="width: 55px;">状&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;态</td>
          </tr>
          <tr>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p10"></input></td>
            <td align="left" style="width: 55px;">位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;置</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p11"></input></td>
            <td align="left" style="width: 55px;">SIM卡号</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p12"></input></td>
            <td align="left" style="width: 55px;">GPS时间</td>
          </tr>
          <tr>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p13"></input></td>
            <td align="left" style="width: 55px;">OBD</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p14"></input></td>
            <td align="left" style="width: 55px;">备注</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p15"></input></td>
            <td align="left" style="width: 55px;">经纬度</td>
          </tr>
          <tr>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p16"></input></td>
            <td align="left" style="width: 80px;">到期时间</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p17"></input></td>
            <td align="left" style="width: 80px;">启用时间</td>
            <td align="rigth"><input type="checkbox" style="float: right;" id="systemParm_map_win_p18"></input></td>
            <td align="left" style="width: 55px;">设备ID</td>
          </tr>
        </table>
        <div id="sysSet_span_2">
          <ul>
            <li style="text-align:center;"><span id="setSystemMsg" style="color:rgb(153, 153, 153);">&nbsp;</span></li>
          </ul>

          <table width="88%" border="0" style="line-height:35px;margin: 0 auto;">
            <tr name="systemSetting">
              <td align="right" style="width: 140px;">登陆页面显示车辆信息:</td>
              <td align="right"><a name="systemPermissionParm_1" id="systemParm_homeLoadLngLat" flag="false"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/no.gif" style="height: 20px;width: 60px;" /></a></td>
            </tr>
            <tr name="systemSetting" style="display: none">
              <td align="right" style="width: 140px;">启动时自动更新:</td>
              <td align="right"><a name="systemPermissionParm_1" id="systemParm_update" flag="false"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/no.gif" style="height: 20px;width: 60px;" /></a></td>
            </tr>
            <tr name="systemSetting">
              <td align="right" style="width: 140px;">显示体验账号:</td>
              <td align="right"><a name="systemPermissionParm_1" id="systemParm_userExperience" flag="false"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/no.gif" style="height: 20px;width: 60px;" /></a></td>
            </tr>
            <tr name="systemSetting">
              <td align="right" style="width: 148px;">企业账号过期后允许登陆:</td>
              <td align="right"><a name="systemPermissionParm_2" id="systemParm_useroverduetime" flag="true"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/no.gif" style="height: 20px;width: 60px;" /></a></td>
            </tr>
            <tr name="systemSetting">
              <td align="right" style="width: 148px;">个人账号过期后允许登陆:</td>
              <td align="right"><a name="systemPermissionParm_2" id="systemParm_vehicleoverduetime" flag="true"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/no.gif" style="height: 20px;width: 60px;" /></a></td>
            </tr>
            <tr name="systemSetting">
              <td align="right" style="width: 148px;">个人账号允许发送命令:</td>
              <td align="right"><a name="systemPermissionParm_1" id="systemParm_persionCmdPermitFlag" flag="false"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/no.gif" style="height: 20px;width: 60px;" /></a></td>
            </tr>
            <tr>
              <td align="right" style="width: 148px;">登录后提示过期设备:</td>
              <td align="right"><a name="overTimeVehicleRemind" id="remind_vehicleoverduetime" flag="false"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/yes.gif" style="height: 20px;width: 60px;" /></a>
              </td>
            </tr>
            <tr>
              <td align="right" style="width: 148px;">显示分组所属客户:</td>
              <td align="right"><a name="showClientGroup" id="systemParm_showClientGroup" flag="false"><img
                    src="/mygpsonline/gpsonline/image/monitor/tool/yes.gif" style="height: 20px;width: 60px;" /></a>
              </td>
            </tr>
            <tr name="systemSetting">
              <td align="right" style="width: 140px;">百度地图key值:</td>
              <td align="right">
                <input type="text" id="baiduMapKey" disabled="disabled" style="height: 20px;width: 90px;">
                <input type="button" id="baiduMapKeyEditBtn" value="编辑" style="height: 21px;width: 60px;"></input>
                <input type="button" id="baiduMapKeySaveBtn" value="保存"
                  style="display: none;height: 21px;width: 60px;"></input>
              </td>
            </tr>
            <tr>
              <td align="right" style="width: 140px;">刷新间隔(最小5秒):</td>
              <td align="right">
                <input type="text" id="refreshTime" disabled="disabled" placeholder="最小为5的整数"
                  style="height: 20px;width: 90px;"
                  onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"
                  onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"
                  onfocus="this.value='';">
                <input type="button" id="refreshTimeEditBtn" value="编辑" style="height: 21px;width: 60px;"></input>
                <input type="button" id="refreshTimeSaveBtn" value="保存"
                  style="display: none;height: 21px;width: 60px;"></input>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 设置系统参数窗口结束-->
  <!-- obd -->
  <div class="box" id="trackContentWin_obd" style="display: none">
    <div class="top"></div>
    <div class="center">
      <h3 id="movetrackWin">
        <a href="javascript:;" title="关闭" class="message_close" onclick="closeTrackWin_obd();"></a>
        OBD/CAN数据
      </h3>
      <div class="message_main" style="width:550px; height:auto; padding-bottom:30px;">
        <div style="" id="obd_nonull">
          <h6 style="border-bottom:1px solid #d6d6d6; color:#000; font-size:14px; padding:0px 5px;"></h6>
          <div id="obdinfo" style="line-height:30px; color:#666;margin: 0px 20px; overflow:hidden">

          </div>

          <div style="text-align:center"><input type="button" value="刷新"
              style="width: 80px;height: 30px; margin-top: 30px;" onclick="getObdData();" /></div>
        </div>

        <div id="obd_null" style="display:none; text-align:center; margin-top:100px; font-size:14px; color:#f00">*
          暂不支持该功能！</div>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- obd  -->


  <!-- 导入标注-->
  <div class="box" id="trackContentWin_addmarker" style="display: none">
    <div class="top"></div>
    <div class="center">
      <h3 id="movetrackWin">
        <a href="javascript:;" title="关闭" class="message_close" onclick="closeTrackWin_addmarker();"></a>
        导入标注
      </h3>
      <div class="message_main" style="width:100%; margin-top: 0px;">
        <iframe id="iframe_map" name="iframe_map" src="gpsonline/jsp/upload/upload.jsp" width="100%" frameborder="no"
          border="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="yes" height="478"></iframe>

        <div style="" id="addmarker_nonull">
          <h6 style="border-bottom:1px solid #d6d6d6; color:#000; font-size:14px; padding:0px 5px;"></h6>
          <div id="addmarkerinfo" style="line-height:30px; color:#666;margin: 0px 20px;">


          </div>

        </div>


      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- obd  -->
  <!-- 轨迹下载开始 -->
  <script>

    function loadTrackTab(index) {
      for (var i = 0; i < 2; i++) {
        if (index - i == 0) {
          $("#loadTrackTab_" + i).attr("class", "tanchu_qh_select");
          $("#loadTrackPanel_" + i).show();
        } else {
          $("#loadTrackTab_" + i).attr("class", "");
          $("#loadTrackPanel_" + i).hide();
        }
      }
    }

  </script>
  <div class="box" id="trackContentWin" style="display: none;width: 602px;">
    <div class="top"></div>
    <div class="center">
      <h3 id="movetrackWin">
        <a href="javascript:;" title="关闭" class="message_close" onclick="closeTrackWin();"></a>
        下载轨迹
      </h3>
      <div class="tanchu_top">
        <ul>
          <li>
            <a id="loadTrackTab_0" class="tanchu_qh_select" href="javascript:loadTrackTab(0);">路线</a>
          </li>
          <li>
            <span>|</span>
          </li>
          <li>
            <a id="loadTrackTab_1" href="javascript:loadTrackTab(1);">数据</a>
          </li>
        </ul>
      </div>
      <div class="message_main" id="loadTrackPanel_0">
        <form id="trackloadform" action="/mygpsonline/json/vehicleAction_exportTrack.action?kml=1" method="post">
          <div style="background-color: #FFF;height:70% ">
            选择设备:<select name="vhcid" id='trackVId_0'>
            </select>
            <br />

            轨迹日期:<input type="text" name="begin_time" value='' id="kml_start" style="width: 170px;"
              onkeydown="return false" onkeyup="return false" oncontextmenu="return false" class="Wdate"
              onFocus="WdatePicker({lang:'zh-tw',el:$dp.$('d12'),skin:'simple',dateFmt:'yyyy-MM-dd HH:mm:ss',maxDate:'#F{$dp.$D(\'kml_end\')}'})"
              })" />
            -
            <input type="text" name="end_time" value='' id="kml_end" style="width: 170px;" onkeydown="return false"
              onkeyup="return false" oncontextmenu="return false" class="Wdate"
              onFocus="WdatePicker({lang:'zh-tw',el:$dp.$('d12'),skin:'simple',dateFmt:'yyyy-MM-dd HH:mm:ss',minDate:'#F{$dp.$D(\'kml_start\')}'})" />
            <input type="submit" style="width:50px; height:22px;" value="下载" />
            </br>

            <h1>帮助</h1>

            <div class="info">您可以通过“下载轨迹”功能，下载指定设备某一日期内的移动轨迹数据。
            </div>
            <div class="notice">注意：如果单击“下载”按钮， 出现“没有找到有效的轨迹数据!”提示信息，
              表示当前没有你需要下载的数据。</div>
            <div class="info">下载的轨迹文件的格式是Google KML格式，如:“文件名.kml”。
              安装 Google Earth后。双击KML文件，会通过Google Earth工具打开。
              所下载的"KML轨迹文件"会将设备的移动痕迹以红线动态的描绘在Google地图上。</p>
              <a href='http://dl.google.com/earth/client/ge4/release_4_3/googleearth-win-plus-4.3.7284.3916.exe'>»下载
                Google Earth</a>
            </div>
          </div>
        </form>
      </div>
      <div class="message_main" id="loadTrackPanel_1" style="display: none;">
        <form id="trackloadform" action="/mygpsonline/json/vehicleAction_exportTrack.action?excel=1" method="post">
          <div style="background-color: #FFF;height:70% ">
            选择设备:<select name="vhcid" id='trackVId_1'>
            </select>
            <br />

            轨迹日期:<input type="text" name="begin_time" value='' id="excel_start" style="width: 170px;"
              onkeydown="return false" onkeyup="return false" oncontextmenu="return false" class="Wdate"
              onFocus="WdatePicker({lang:'zh-tw',el:$dp.$('d12'),skin:'simple',dateFmt:'yyyy-MM-dd HH:mm:ss',maxDate:'#F{$dp.$D(\'excel_end\')}'})"
              })" />
            -
            <input type="text" name="end_time" value='' id="excel_end" style="width: 170px;" onkeydown="return false"
              onkeyup="return false" oncontextmenu="return false" class="Wdate"
              onFocus="WdatePicker({lang:'zh-tw',el:$dp.$('d12'),skin:'simple',dateFmt:'yyyy-MM-dd HH:mm:ss',minDate:'#F{$dp.$D(\'excel_start\')}'})" />
            <input type="submit" style="width:50px; height:22px;" value="下载" />
            </br>

            <h1>帮助</h1>

            <div class="info">您可以通过“下载轨迹”功能，下载指定设备某一日期内的移动轨迹数据。
            </div>
            <div class="notice">注意：如果单击“下载”按钮， 出现“没有找到有效的轨迹数据!”提示信息，
              表示当前没有你需要下载的数据。</div>
            <div class="info">下载的轨迹文件的格式是Excel格式，如:“文件名.xls”。
              安装 Microsoft Office Excel后。双击excel文件，会通过Excel工具打开。</p>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 轨迹下载结束  -->
  <!-- 命令发送开始 -->
  <div class="cmdbox" id="cmdContentWin" style="display: none;">
    <div class="top"></div>
    <div class="center">
      <h3 id="movecmdWin">
        <a href="javascript:;" title="关闭" class="message_close" id="closecmdWin"></a>
        <span id='cmdName'></span>
      </h3>
      <form id="cmd_form" action="/mygpsonline/json/cmdAction_send.action" method="post">
        <div class="cmdmessage_main" id="cmdmessage_main">
          <span id="cmd_msg"
            style="color: rgb(153, 153, 153);display: block;text-align: center;margin-top: -10px;"></span>
          <input type="hidden" id="cmdid" />
          <input type="hidden" id="mtid" />
          <input type="hidden" id="vid" />
          <span>设备:</span><span id='equipmentName'></span><br />
          <span>描述:</span><span id='equipmentdesc'></span><br />
          <div id="cpcontent">
          </div>
          <input type="button" value="发送" onclick="sendCmd();"
            style="width:80px; height:30px; margin-left:90px; margin-top:20px;" />
          <!-- <a href='javascript:;' onclick='sendCmd();'>发送</a>|<a href='javascript:;' id='cancelCmd'>取消</a> -->
        </div>
      </form>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 命令发送结束  -->
  <!-- 添加组窗口开始 -->
  <div class="addGroupbox" id="addGroupContentWin" style="display: none;">
    <div class="top"></div>
    <div class="center">
      <h3 id="moveGroupWin">
        <a href="javascript:;" title="关闭" class="message_close" id="closeGroupWin"></a>
        <span id="groupPanel">添加组</span>
      </h3>
      <div class="groupmessage_main" id="groupmessage_main">
        <span>组名:</span><input id='markerGroupName'></input><span id="addMarkerGroupmsg"
          style="color:rgb(153, 153, 153);">*不能为空</span><br />
        <input id="addMarkerGroup" type="button" value="添加" onclick="addMarkerGroup();"
          style="width:80px; height:30px; margin-left:90px; margin-top:20px;" />
        <input id="updateMarkerGroup" type="button" value="修改" onclick="updateMarkerGroup();"
          style="width:80px; height:30px; margin-left:90px; margin-top:20px;display: none;" />
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 添加组窗口结束-->

  <!-- 标注图片选择窗口开始 -->
  <div class="selectMarkerPhotobox" id="selectMarkerPhotoWin" style="display: none;">
    <div class="top"></div>
    <div class="center">
      <h3 id="moveSelectMarkerPhotoWin">
        <a href="javascript:;" title="关闭" class="message_close" id="closeSelectMarkerPhotoWin"></a>
        <span>气泡类型</span>
      </h3>
      <div class="selectMarkerPhotomessage_main" id="selectMarkerPhotomessage_main">
        <div id="markerimages" style="height: 500px;overflow: auto;">

        </div>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 标注图片选择结束-->

  <!-- 添加标注开始 -->
  <div class="markerbox" id="markerContentWin" style="display: none;">
    <div class="top"></div>
    <div class="center">
      <h3 id="moveMarkerWin">
        <a href="javascript:;" title="关闭" class="message_close" id="closecmarkerWin"></a>
        <span id='markerName'>添加标注</span>
      </h3>
      <div class="markermessage_main" id="markermessage_main">
        <ul>
          <li style="text-align:center;"><span id="addmarkermsg" style="color:rgb(153, 153, 153);">*标题不能为空</span></li>
        </ul>
        <table width="100%" border="0" style="line-height:35px;">
          <tr id="addMarkerGroupSelect">
            <td><span style="height: 25px;">标注组：</span></td>
            <td>

              <input type="hidden" id="markerId" class="searchinput" />
              <input type="hidden" id="markerGroupId" style="width: 100px;"></input>
              <div class="marker_group_select_box">
                <span class="marker_group_select_txt"></span><a class="marker_group_selet_open"><b></b></a>
                <div class="marker_group_option" id="marker_group_option"
                  style="height:128px;overflow-y:auto;background: white;">
                </div>
              </div>

            </td>
          </tr>
          <tr>
            <td><span style="height: 25px;">标题：</span></td>
            <td>
              <input id='markertitle' class="marker_input"
                style="height: 25px;width: 185px;*height: 23px;height: 23px\9\9"></input>
              <div class="label-icon" style="z-index: 900;">
                <a id="label-icon-edit" href="javascript:;"><span id="markerImagesrc" onclick="openMarkerselectWin();"
                    class="markerImagesrc"></span></a>
                <br>

                <ul id="label-icon-list" style="display: none;z-index: 9999;">
                  <span id="MarkerImgloading" style="padding:10px;color:#0099FF;">loading...</span>

                </ul>
              </div>
            </td>
          </tr>
          <tr>
            <td>客户号：</td>
            <td>
              <div style="width: 185px;*width:187px;vertical-align:middle;">
                <a id="addcustomerNum" href="javascript:;"
                  style="display:block;width:25px;height:25px;text-align: center;vertical-align:middle;background:url(/mygpsonline/gpsonline/image/marker/ico_add.jpg) no-repeat 0 0;float:right;margin-top: 0px;margin-top: 6px\9\0; *margin-top: 6px;margin-right: -2px\9\0;"></a>
                <input id='customerNum' class="marker_input"
                  style="height: 25px;width: 160px;*width: 160px;width: 160px\9\0;*height: 23px;height: 23px\9\9"
                  placeholder="请输入要添加的客户号"></input>
                <div style="clear:left;width:160px;">
                  <div
                    style="display: none;position: absolute;background: #FFF; width: 159px;height: 100px; margin-left: 0px; border: 1px solid #CCC; margin-top: 0px; *margin-top: -3px;margin-top: -3px\9\0;overflow: auto;z-index:9;border-bottom: 2px solid #CCC;"
                    id="customerNumListOutCanvas"></div>
                </div>
              </div>
              <label id="addcustomerNum_Msg"
                style="color:#F00;width:45px;float: right;margin-right: 5px;margin-top: -35px; *margin-right: 0px;margin-right: 0px\9\0;*margin-top:-35px;margin-top:-35px\9\0; ">&nbsp;</label>
            </td>
          </tr>
          <tr>
            <td><span style="height: 25px;">描述：</span></td>
            <td>
              <input id='markerdesc' class="marker_input"
                style="height: 25px;width: 185px;*height: 23px;height: 23px\9\9;"></input>
              <!-- <input type="hidden" id='markerlat' style="width: 60px;"/>
						<input type="hidden" id='markerlng' style="width: 60px;"/> -->
            </td>

          </tr>
          <tr>
            <td><span style="height: 25px;">位置：</span></td>
            <td>
              经度：<input id="markerlng" type="text" / style="width: 55px;" disabled="disabled">&nbsp;纬度：<input
                id="markerlat" type="text" style="width: 55px;" disabled="disabled" />
            </td>

          </tr>
          <tr>
            <td>区域半径：</td>
            <td>
              <div id="markerArea" style="width:160px; display:inline-block; float:left; margin-top:10px;"></div>
              &nbsp;&nbsp;&nbsp;<span id="markersize"
                style="display:-moz-inline-box; display:inline-block; width:50px;">500m</span>
              <input type="hidden" id='leftlat' />
              <input type="hidden" id='leftlng' />
              <input type="hidden" id='rigthlat' />
              <input type="hidden" id='rigthlng' />
            </td>
          </tr>
          <tr>
            <td></td>
            <td>
              <input type="button" value="添加" id="addMarkerButton" onclick="addMarker_Area();"
                style="width:80px; height:30px; margin-left:50px; margin-top:20px;" />
              <input type="button" value="修改" id="updateMarkerButton" onclick="updateMarker();"
                style="width:80px; height:30px; margin-left:50px; margin-top:20px;" />
            </td>
          </tr>

        </table>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 添加标注结束  -->
  <!-- 信息提示窗口开始 -->
  <script type="text/javascript">
    var alarmWinIsMax = false;
    var curShowMsgType = 0;//0报警、1命令、2过期

    function openCloseMsgWin(element) {
      setToggle(element);

      showwarmmsg($("#overTime_vehicle"))
    }

    function setToggle(element) {
      var targetIconId = $(element).find('img').attr('id');
      if (targetIconId == 'icon_close') {
        $("#msg-content").animate({ height: "20px", width: "150px" }, function () {
          $('#tabbox').empty();
          $('#tabbox').removeClass().addClass('tabminbox');
          $('#tabbox').append("<span id='warmtitle' style='margin-left:10px; float:left'>消息</span>" +
            "<a href='javascript:;' onclick='setToggle(this);' style='margin-right: 5px; float: right;' title='最大化'>" +
            "<img id='icon_open_max' src='/mygpsonline/gpsonline/image/monitor/iw_max.gif' />" +
            "</a>" +
            "<a href='javascript:;' onclick='setToggle(this);' style='margin-right: 5px; float: right;' title='展开'>" +
            "<img id='icon_open_expand' src='/mygpsonline/gpsonline/image/monitor/iw_expand.gif' />" +
            "</a>"
          );
        });
        alarmWinIsMax = false;
      } else {
        canclewarmtitle();//取消报警窗口提示信息闪动
        $('#tabbox').empty();
        $('#tabbox').append("<div style='float:left; width: 550px;'>" +
          "<ul class='tabs' id='tabs' >" +
          "<li><a id='warm_msg' onclick='showwarmmsg(event);' href='javascript:;' title='报警信息'>报警信息</a></li>" +
          "<li><a id='comd_msg' onclick='showcmdmsg(event);' href='javascript:;' title='命令信息'>命令信息</a></li>" +
          "<li><a id='overTime_vehicle' onclick='showOverTimeVehicle(event);' href='javascript:;' title='即将过、已过期设备信息'>" + overTimeVehicleItemTitle() + "</a></li>" +
          "</ul>" +
          "<label onclick='cancelPropagation(event);' style='line-height:20px;display:none;' id='alarmVoiceCheckBox'>[" +
          "<input id='chk_voiceItem' onclick='warmvoiceselect();' type='checkbox' style='vertical-align:middle;'" + (flagwarmvoice ? " checked='checked'" : "") + "></input>" +
          "<span> 开启报警声音</span>" +
          "]</label>" +
          "&nbsp;&nbsp;" +
          "<label onclick='cancelPropagation(event);' style='line-height:20px;display:none;' id='alarmFilterBtn'>[" +
          "<a href='javascript:openPopuWin(\"/mygpsonline/pub/vehicleAction_alarmTypeWin.action\");' style='vertical-align:middle;'><span style='color: white;vertical-align: top;'>过滤报警类型</span></a>" +
          "]</label>" +
          overTimeVehicleShowSetCheckInput(2547053) +
          "</div>" +
          "<div style='float: right;width: 80px;display: inline-block;height: 25px;padding-right: 5px;'>" +
          "<a href='javascript:;' onclick='setToggle(this);'  title='最大化' style='margin-right: 5px; display: none; float: right;'><img id='icon_open_max' src='/mygpsonline/gpsonline/image/monitor/iw_max.gif' /></a>" +
          "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" +
          "<a href='javascript:;' onclick='setToggle(this);'  title='还原' style='margin-right: 5px; display: none; float: right;'><img id='icon_open_expand' src='/mygpsonline/gpsonline/image/monitor/iw_expand.gif' /></a>" +
          "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" +
          "<a href='javascript:;' onclick='setToggle(this);'  title='最小化' style='margin-right: 5px; display: none; float: right;'><img id='icon_close' src='/mygpsonline/gpsonline/image/monitor/iw_min.gif' /></a>" +
          "</div>"
        );

        $('#tabbox').removeClass().addClass('tabmaxbox');

        $("#icon_close").parent().show();

        if (targetIconId == 'icon_open_max') {
          $("#msg-content").animate({ height: $(window).height() - $("#idx_top").height() - 7 + "px", width: $(window).width() - $("#leftFrameCanvas").width() - 13 + "px" });
          $("#icon_open_max").parent().hide();
          $("#icon_open_expand").parent().show();
          $("#msg_main").height($(window).height() - $("#idx_top").height() - 30);
          alarmWinIsMax = true;
        } else {
          $("#msg-content").animate({ height: "150px", width: "650px" });
          $("#icon_open_expand").parent().hide();
          $("#icon_open_max").parent().show();
          $("#msg_main").height(125);
          alarmWinIsMax = false;
        }

        $("#tabs li").find("a").each(function () {
          $(this).attr("class", "");
        });


        if (curShowMsgType - 1 == 0) {
          $("#comd_msg").attr("class", "msg_s");
          showAlarmOrEqCheckBox(0);
        } else if (curShowMsgType - 2 == 0) {
          $("#overTime_vehicle").attr("class", "msg_s");
          showAlarmOrEqCheckBox(1);
        } else {
          $("#warm_msg").attr("class", "msg_s");
          showAlarmOrEqCheckBox(0);
        }

      }
      stopWarnSound();//停止报警
    }

    $(function () {
      $(window).resize(function () {
        if (alarmWinIsMax) {
          $("#msg-content").animate({ height: $(window).height() - $("#idx_top").height() - 7 + "px", width: $(window).width() - $("#leftFrameCanvas").width() - 13 + "px" });
          $("#msg_main").height($(window).height() - $("#idx_top").height() - 30);
        }
      });
    })
    function showwarmmsg(event) {
      //event.stopPropagation();
      stopBubble(event);
      $('#comd_msg').attr('class', '');
      $('#warm_msg').attr('class', 'msg_s');
      $('#overTime_vehicle').attr('class', '');

      $('#cmdsgpanel').hide();
      $('#warmmsgpanel').show();
      $('#vehiclePanel').hide();

      showAlarmOrEqCheckBox(0);
      curShowMsgType = 0;
    }
    function showcmdmsg(event) {
      //event.stopPropagation();
      stopBubble(event);
      $('#comd_msg').attr('class', 'msg_s');
      $('#overTime_vehicle').attr('class', '');
      $('#warm_msg').attr('class', '');

      $('#vehiclePanel').hide();
      $('#warmmsgpanel').hide();
      $('#cmdsgpanel').show();
      showAlarmOrEqCheckBox(0);
      curShowMsgType = 1;
    }
    function showOverTimeVehicle(event) {
      //event.stopPropagation();
      stopBubble(event);
      $('#overTime_vehicle').attr('class', 'msg_s');
      $('#warm_msg').attr('class', '');
      $('#comd_msg').attr('class', '');

      $('#cmdsgpanel').hide();
      $('#warmmsgpanel').hide();
      $('#vehiclePanel').show();

      showAlarmOrEqCheckBox(1);
      curShowMsgType = 2;

    }
    function cancelPropagation(event) {
      //event.stopPropagation();
      stopBubble(event);
    }
    function warmvoiceselect() {
      if ($("#chk_voiceItem").attr("checked")) {
        flagwarmvoice = true;
        memoryWarmVoiceStatus(true);
      } else {
        flagwarmvoice = false;
        memoryWarmVoiceStatus(false);
        stopWarnSound();
      }
    }

    function showAlarmOrEqCheckBox(type) {

      var alarmVoiceCheckBox = $('#alarmVoiceCheckBox');
      var promptOvertimeEqCheckBox = $('#promptOvertimeEqCheckBox');
      var alarmFilterBtn = $('#alarmFilterBtn');

      if (type == 0) {
        alarmVoiceCheckBox.show();
        alarmFilterBtn.show();
        if (promptOvertimeEqCheckBox) promptOvertimeEqCheckBox.hide();
      } else {
        alarmVoiceCheckBox.hide();
        alarmFilterBtn.hide();
        if (promptOvertimeEqCheckBox) promptOvertimeEqCheckBox.show();
      }

    }


  </script>
  <div id="msg-content">
    <div id="msg_title" class="msg_header" title="点击收缩">
      <div id="tabbox" class="tabminbox" style="width:100%;">
        <span id='warmtitle' style="margin-left:10px; float:left">消息</span>
        <a href='javascript:;' onclick='setToggle(this);' style='margin-right: 5px; float: right;' title='最大化'>
          <img id='icon_open_max' src='/mygpsonline/gpsonline/image/monitor/iw_max.gif' />
        </a>
        <a href='javascript:;' onclick='setToggle(this);' style='margin-right: 5px; float: right;' title='展开'>
          <img id='icon_open_expand' src='/mygpsonline/gpsonline/image/monitor/iw_expand.gif' />
        </a>
      </div>
    </div>
    <div class="msg_main" id="msg_main">
      <table id="warmmsgpanel" width="100%" border="0" cellspacing="0" cellpadding="0" class="msg_tab">
        <tr>
          <th scope="col" width="100px" style="text-align: center;">设备名称</th>
          <th scope="col" width="150px" style="text-align: center;">报警时间</th>
          <th scope="col" style="text-align: center;">报警内容</th>
          <th scope="col" style="text-align: center;width:50px;">报警次数</th>
          <th scope="col" style="text-align: center;width:80px;">车主信息</th>
          <!-- <th scope="col">速度(km/h)</th>
            <th scope="col">航向</th> -->
          <th scope="col" width="80px" style="text-align: center;">操作
            <!-- [<a href="javascript:;" onclick="clearAllMsg('warmmsgpanel');">清空</a>] -->
          </th>
        </tr>
      </table>
      <table id="cmdsgpanel" style="display: none;" width="100%" border="0" cellspacing="0" cellpadding="0"
        class="msg_tab">
        <tr>
          <th scope="col" width="100px" style="text-align: center;">设备名称</th>
          <th scope="col" width="200px" style="text-align: center;">命令时间</th>
          <th scope="col" style="text-align: center;">命令内容</th>
          <th scope="col" style="text-align: center;width:80px;">车主信息</th>
          <!-- 
            <th scope="col" width="80px" style="text-align: center;">操作[<a href="javascript:;" onclick="clearAllMsg('cmdsgpanel');">清空</a>]</th>
          	 -->
        </tr>
      </table>
      <table id="vehiclePanel" style="display: none;" width="100%" border="0" cellspacing="0" cellpadding="0"
        class="msg_tab">
        <tr>
          <th scope="col" style="text-align: center;width:100px;">设备名称</th>
          <th scope="col" style="text-align: center;width:100px;">SIM号码</th>
          <th scope="col" style="text-align: center;width:150px;">过期时间</th>
          <th scope="col" style="text-align: center;width:100px;">到期天数</th>
          <th scope="col" style="text-align: center;width:100px;">车主信息</th>
        </tr>
      </table>
    </div>
  </div>
  <!-- 信息提示窗口结束 -->
  <!-- 遮罩层开始-->
  <div id="mask" class="mask"></div>
  <div class="content" id="content" style="z-index:100099;">
    <img src="/mygpsonline/gpsonline/image/monitor/loading.gif"></img>
  </div>
  <!--遮罩层结束 -->
  <div class="content" id="areaQueryVechile" style="display: none;">
    <img src="/mygpsonline/gpsonline/image/monitor/guanli/recoderdeleting.gif"></img>
  </div>



  <!-- 遮罩层开始-->
  <div id="maskPanel" class="maskPanel"
    style="display: none;width:100%; position: absolute; top: 0px; filter: alpha(opacity =60); background-color: #B2B2B2; left: 0px; opacity: 0; -moz-opacity: 0; z-index: 999;">
  </div>
  <div class="content" id="maskcontent" style="display: none; z-index: 1000; position: fixed;">
    <img src="/mygpsonline/gpsonline/image/monitor/guanli/recoderdeleting.gif"></img>
  </div>
  <!--遮罩层结束 -->
  <!-- 添加客户开始 -->
  <div class="clientbox" id="clientContentWin" style="display: none; z-index: 1000;">
    <div class="top"></div>
    <div class="center">
      <h3 id="moveClientWin">
        <a href="javascript:;" title="关闭" class="message_close" id="closecclientWin"></a>
        <span id='manager_clientName'>添加客户</span>
      </h3>
      <div class="clientrmessage_main" id="clientmessage_main">
        <ul>
          <li style="text-align: center;">
            <span id="addclientmsg" style="color: rgb(153, 153, 153);">*企业名称不能为空</span>
          </li>
        </ul>
        <table width="100%" border="0" style="line-height: 35px;">
          <tr>
            <td>
              企业名称:
            </td>
            <td>
              <input id="companyName" type="text" style="height: 18px;"></input>
            </td>
          </tr>
          <tr>
            <td>
              企业电话:
            </td>
            <td>
              <input id="companyPhone" type="text" style="height: 18px;"></input>
            </td>
          </tr>
          <tr>
            <td>
              企业地址:
            </td>
            <td>
              <input id="companyAddress" type="text" style="height: 18px;"></input>
            </td>
          </tr>
          <tr>
            <td>
              <input id="clientID" type="hidden"></input>
            </td>
            <td>
              <input type="button" value="添加" id="addClientButton" onclick="managerIframe.ClientMananger.add()"
                style="width: 80px; height: 30px; margin-left: 10px; margin-top: 20px;" />
              <input type="button" value="修改" id="updateClientButton" onclick="managerIframe.ClientMananger.update();"
                style="display: none; width: 80px; height: 30px; margin-left: 10px; margin-top: 20px;" />
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 添加客户结束  -->

  <!-- 添加组开始 -->
  <div class="manager_groupbox" id="manager_groupContentWin" style="display: none; z-index: 1000;">
    <div class="top"></div>
    <div class="center">
      <h3 id="manager_moveGroupWin">
        <a href="javascript:;" title="关闭" class="message_close" id="manager_closecgroupWin"></a>
        <span id='manager_groupName'>添加分组</span>
      </h3>
      <div class="manager_grouptrmessage_main" id="manager_groupmessage_main">
        <ul>
          <li style="text-align: center;">
            <span id="addgroupmsg" style="color: rgb(153, 153, 153);">&nbsp;</span>
          </li>
        </ul>
        <table width="100%" border="0" style="line-height: 35px;">
          <tr>
            <td>
              分组名称:
            </td>
            <td>
              <input id="groupName" type="text" style="height: 18px;"></input>
            </td>
            <td>
              <span id="groupName_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <!-- 
        		<tr>
        			<td>所属客户:</td>
        			<td>
        				<select id="selectClient" style="width: 140px;height:20px;"></select>
        			</td>
        			<td>
        				<span id="selectClient_Msg" style="color:rgb(153, 153, 153);">*不能为空</span>
        			</td>
        		</tr>
        		 -->
          <tr>
            <td>
              用户数量:
            </td>
            <td>
              <input id="userCount" type="text" style="height: 18px;"></input>
            </td>
            <td>
              <span id="userCountMsg" style="color: rgb(153, 153, 153);">*只能是正整数</span>
            </td>
          </tr>
          <tr>
            <td>
              车辆数量:
            </td>
            <td>
              <input id="vechileCount" type="text" style="height: 18px;"></input>
            </td>
            <td>
              <span id="vechileCountMsg" style="color: rgb(153, 153, 153);">*只能是正整数</span>
            </td>
          </tr>
          <tr>
            <td>
              上级可见:
            </td>
            <td>
              <select id="seeNext" style="width: 140px; height: 20px;">
                <option value="0" selected="selected">不可见</option>
                <option value="1">可见</option>
              </select>
            </td>
            <td>
              &nbsp;
            </td>
          </tr>
          <tr>
            <td>
              <input id="groupID" type="hidden"></input>
            </td>
            <td>
              <input type="button" value="添加" id="addGroupButton" onclick="managerIframe.GroupMananger.add()"
                style="width: 80px; height: 30px; margin-left: 40px; margin-top: 20px;" />
              <input type="button" value="修改" id="updateGroupButton" onclick="managerIframe.GroupMananger.update();"
                style="display: none; width: 80px; height: 30px; margin-left: 40px; margin-top: 20px;" />
            </td>
            <td>
              &nbsp;
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 添加组结束  -->

  <!-- 添加设备开始 -->
  <div class="manager_vechilebox" id="manager_vechileContentWin" style="display: none; z-index: 1000;width: 495px;">
    <div class="top"></div>
    <div class="center">
      <h3 id="manager_moveVechileWin">
        <a href="javascript:;" title="关闭" class="message_close" id="manager_closecvechileWin"></a>
        <span id='manager_vechileName'>添加设备</span>
      </h3>
      <div class="manager_vechilemessage_main" id="manager_vechilemessage_main">
        <ul>
          <li style="text-align: center;">
            <span id="addvechilemsg" style="color: rgb(153, 153, 153);">&nbsp;</span>
          </li>
        </ul>
        <table width="100%" border="0" style="line-height: 35px;">
          <tr>
            <td class="inputName">
              车牌号码:
            </td>
            <td>
              <input id="carName" type="text" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="carName_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              所属分组:
            </td>
            <td>
              <input id="vechile_groupId" type="text" readonly="readonly" disabled="disabled"
                style="height: 18px; width: 138px;" value_="" checkboxGroupListPage_="" />

            </td>
            <td>
              <span id="vechile_groupId_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
              <span style="display: inline-block; width: 60px; padding-left: 5px;">
                <a id="openGroupSelectPane_btn"
                  href="javascript:managerIframe.VechileMananger.openGroupSelectPaneManager.openGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none;">选择</a>
                <a id="openUpdateGroupSelectPane_btn"
                  href="javascript:managerIframe.VechileMananger.openGroupSelectPaneManager.openUpdateGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">修改</a>
                <a id="confirmGroupSelectPane_btn"
                  href="javascript:managerIframe.VechileMananger.openGroupSelectPaneManager.confirmGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">保存</a>
                <a id="canacleGroupSelectPane_btn"
                  href="javascript:managerIframe.VechileMananger.openGroupSelectPaneManager.canacleGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">取消</a>
              </span>
              <div id="vechile_groupId_Panels"
                style="background: #fff; border: 1px solid #a3b9d7; padding: 5px; line-height:25px; position: absolute; width: 471px; z-index: 900; margin-left: -310px; margin-top: -5px; display: none; height: 180px; overflow: auto;">
              </div>

            </td>
          </tr>
          <tr>
            <td class="inputName">
              所属客户:
            </td>
            <td>
              <select id="vechile_clientId" style="width: 140px; height: 20px;" value_=""></select>
            </td>
            <td>
              <span id="vechile_clientId_Msg" style="color: rgb(153, 153, 153);">&nbsp;</span>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              设备ID:
            </td>
            <td>
              <input id="gprsID" type="text" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="gprsID_Msg" style="color: rgb(153, 153, 153);">*(3-40)位数字或字母</span>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              SIM号码:
            </td>
            <td>
              <input id="SIMNum" type="text" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="SIMNum_Msg" style="color: rgb(153, 153, 153);">*(5-13)位数字或字母</span>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              车辆图标:
            </td>
            <td colspan="2">
              <a href="javascript:;"><img src="http://mapday.exlive.cn/vhc_icons/pic/0/green_0.gif" title="车辆1"
                  id="vehicleImg" style="vertical-align: middle;" value="0"
                  onclick="managerIframe.VechileMananger.openImgPanleManager.open()" /></a>
              <a id="udpate_vehicle_img_btn" href="javascript:managerIframe.VechileMananger.openImgPanleManager.open();"
                style="color: #0077FF; font-size: 12px; text-decoration: none;">修改</a>
              <div id="vehicle_img_Panels"
                style="background: #fff; border: 1px solid #a3b9d7; padding-top: 5px; line-height25px; position: absolute; width: 280px; z-index: 900; display: none; height: 180px; overflow: auto;">
              </div>

            </td>
          </tr>

          <tr id="vechile_overtime_tr" style="display: none;">
            <td class="inputName">
              过期时间:
            </td>
            <td>
              <select id="vechile_overtime" style="width: 140px; height: 20px;"></select>
            </td>
            <td>
              <span id="vechile_overtime_Msg" style="color: rgb(153, 153, 153);"></span>
            </td>
          </tr>
          <tr id="vechile_color_tr" style="display: none;">
            <td class="inputName">
              车辆颜色:
            </td>
            <td>
              <select id="vechile_color" style="width: 140px; height: 20px;"></select>
            </td>
            <td>
              <span id="vechile_color_Msg" style="color: rgb(153, 153, 153);"></span>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              车机类型:
            </td>
            <td>
              <select id="mobileId" style="width: 140px; height: 20px;"></select>
            </td>
            <td>
              <span id="mobileId_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              车辆类型:
            </td>
            <td>
              <select id="vehicleTypeId" style="width: 140px; height: 20px;"></select>
            </td>
            <td>
              <span id="vehicleTypeId_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              外接设备:
            </td>
            <td>
              <input id="peripheral" type="text" readonly="readonly" disabled="disabled"
                style="height: 18px; width: 138px;" />
            </td>
            <td>
              <span style="display: inline-block; width: 60px; padding-left: 5px;">
                <a id="openperipheralPane_btn"
                  href="javascript:managerIframe.VechileMananger.peripheralPaneManager.openPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none;">选择</a>
                <a id="openUpdateperipheralPane_btn"
                  href="javascript:managerIframe.VechileMananger.peripheralPaneManager.UpdatePane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">修改</a>
                <a id="confirmperipheralPane_btn"
                  href="javascript:managerIframe.VechileMananger.peripheralPaneManager.confirm();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">保存</a>
                <a id="canacleperipheralPane_btn"
                  href="javascript:managerIframe.VechileMananger.peripheralPaneManager.canacle();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">取消</a>
              </span>
              <div id="vechile_peripheral_Panels"
                style="background: #fff; border: 1px solid #a3b9d7; padding: 5px; line-height:20px; position: absolute; width: 471px; z-index: 900; margin-left: -312px; margin-top: -320px; display: none; height: 280px; overflow: auto;">
                <fieldset style="border:  1px solid #CCC">
                  <legend style="margin-left: 20px;">外部设备</legend>
                  <div id="peripheral_ws_Panels"></div>
                </fieldset>
                <fieldset style="border:  1px solid #CCC">
                  <legend style="margin-left: 20px;">报警类型</legend>
                  <div id="peripheral_bj_Panels"></div>
                </fieldset>
              </div>
            </td>
          </tr>
          <tr id="vechile_postime_tr" style="display: none;">
            <td class="inputName">
              启用时间:
            </td>
            <td colspan="2">
              <input id="posavtime_" type="text" style="height: 18px; width: 138px;border: 0px; background-color: #fff;"
                readonly="readonly" disabled="disabled"></input>
            </td>
          </tr>
          <tr id="vechile_overtime_tr_update" style="display: none;">
            <td class="inputName">
              到期时间:
            </td>
            <td colspan="2">
              <input id="overTime_" type="text" style="height: 18px; width: 138px;border: 0px; background-color: #fff;"
                readonly="readonly" disabled="disabled"></input>
            </td>
          </tr>
          <tr>
            <td class="inputName">
              数据转发类型:
            </td>
            <td colspan="2">
              <select id="vechile_data_forward_type" style="width: 140px; height: 20px;"></select>
            </td>
          </tr>
          <tr>
            <td>
              <input id="vechileID" type="hidden"></input>
            </td>
            <td>
              <input type="button" value="添加" id="addVechileButton" onclick="managerIframe.VechileMananger.add()"
                style="width: 80px; height: 30px; margin-left: 30px; margin-top: 20px;" />
              <input type="button" value="修改" id="updateVechileButton" onclick="managerIframe.VechileMananger.update();"
                style="display: none; width: 80px; height: 30px; margin-left: 30px; margin-top: 20px;" />
            </td>
            <td>
              &nbsp;
            </td>
          </tr>

        </table>
      </div>
    </div>
    <div class="bot"></div>
  </div>
  <!-- 添加设备结束  -->

  <!-- 添加用户开始 -->
  <div class="userbox" id="manager_userContentWin" style="display: none; z-index: 1000;">
    <div class="top"></div>
    <div class="center">
      <h3 id="manager_moveUserWin">
        <a href="javascript:;" title="关闭" class="message_close" id="manager_closecUserWin"></a>
        <span id='userName_title'>添加用户</span>
      </h3>
      <div class="usermessage_main" id="usermessage_main">
        <ul>
          <li style="text-align: center;">
            <span id="addUsermsg" style="color: rgb(153, 153, 153);">&nbsp;</span>
          </li>
        </ul>
        <table width="100%" border="0" style="line-height: 35px;">
          <tr>
            <td>
              名 称:
            </td>
            <td>
              <input id="userName" type="text" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="userName_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr id="manager_userType_tr">
            <td>
              类 型:
            </td>
            <td>
              <select id="manager_userType" style="width: 140px; height: 20px;"
                onchange="managerIframe.UserMananger.userTypeChange();"></select>
            </td>
            <td>
              <span id="manager_userType_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr id="userPwd_tr">
            <td>
              密 码:
            </td>
            <td>
              <input id="userPwd" type="password" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="userPwd_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr id="reuserPwd_tr">
            <td>
              确认密码:
            </td>
            <td>
              <input id="reuserPwd" type="password" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="reuserPwd_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr id="user_client_tr">
            <td>
              所属客户:
            </td>
            <td>
              <select id="user_client" style="width: 140px; height: 20px;"></select>
            </td>
            <td>
              <span id="user_client_Msg" style="color: rgb(153, 153, 153);">*不能为空</span>
            </td>
          </tr>
          <tr id="user_group_tr" style="display: none;">
            <td>
              用户分组:
            </td>
            <td>
              <input id="user_group" readonly="readonly" disabled="disabled"
                style="width: 140px; height: 20px;"></input>
            </td>
            <td>
              <span style="display: inline-block; width: 60px; padding-left: 5px;">
                <a id="open_User_GroupSelectPane_btn"
                  href="javascript:managerIframe.UserMananger.openGroupSelectPaneManager.openGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none;">选择</a>
                <a id="openUpdate_User_GroupSelectPane_btn"
                  href="javascript:managerIframe.UserMananger.openGroupSelectPaneManager.openUpdateGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">修改</a>
                <a id="confirm_User_GroupSelectPane_btn"
                  href="javascript:managerIframe.UserMananger.openGroupSelectPaneManager.confirmGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">保存</a>
                <a id="canacle_User_GroupSelectPane_btn"
                  href="javascript:managerIframe.UserMananger.openGroupSelectPaneManager.canacleGroupSelectPane();"
                  style="color: #0077FF; font-size: 12px; text-decoration: none; display: none;">取消</a>
              </span>
              <div id="user_groupId_Panels"
                style="background: #fff; border: 1px solid #a3b9d7; padding-top: 5px; line-height25px; position: absolute; width: 280px; z-index: 900; margin-left: -210px; margin-top: -220px; display: none; height: 180px; overflow: auto;">
              </div>
            </td>
          </tr>
          <tr id="user_group_count_tr" style="display: none;">
            <td>
              分组总数:
            </td>
            <td>
              <input id="user_group_count" type="text" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="user_group_count_Msg" style="color: rgb(153, 153, 153);">*只能是正整数</span>
            </td>
          </tr>
          <tr id="user_moin_count_tr" style="display: none;">
            <td>
              监控员总数:
            </td>
            <td>
              <input id="user_moin_count" type="text" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="user_moin_count_Msg" style="color: rgb(153, 153, 153);">*只能是正整数</span>
            </td>
          </tr>
          <tr id="user_vechile_count_tr" style="display: none;">
            <td>
              车辆总数:
            </td>
            <td>
              <input id="user_vechile_count" type="text" style="height: 18px; width: 138px;"></input>
            </td>
            <td>
              <span id="user_vechile_count_Msg" style="color: rgb(153, 153, 153);">*只能是正整数</span>
            </td>
          </tr>
          <tr>
            <td>
              过期时间:
            </td>
            <td>
              <input type="text" name="add_overTime" id="add_user_overTime" style="width: 140px; display: none;"
                onkeydown="return false" onkeyup="return false" oncontextmenu="return false" class="Wdate" onclick="WdatePicker({el:$dp.$('d12'),isShowClear:false,skin:'simple',dateFmt:'yyyy-MM-dd',minDate:'{%y}-%M-{%d}'})" />
						<input type="text" name="update_overTime"
							id="update_user_overTime" style="width: 140px; display: none;"
							onkeydown="return false" onkeyup="return false"
							oncontextmenu="return false" class="Wdate"
							onclick="WdatePicker({el:$dp.$('d12'),isShowClear:false,skin:'simple',dateFmt:'yyyy-MM-dd'})" />
					</td>
					<td>
					</td>
				</tr>				
				<tr>
					<td>
						<input id="manager_userID" type="hidden"></input>
					</td>
					<td>
						<input type="button" value="添加" id="addUserButton"
							onclick="managerIframe.UserMananger.add()"
							style="width: 80px; height: 30px; margin-left: 25px; margin-top: 20px;" />
						<input type="button" value="修改" id="updateUserButton"
							onclick="managerIframe.UserMananger.update();"
							style="display: none; width: 80px; height: 30px; margin-left: 25px; margin-top: 20px;" />
					</td>
					<td>
						&nbsp;
					</td>
				</tr>
			</table>
		</div>
	</div>
	<div class="bot"></div>
</div>
<!-- 添加客用户结束  -->

<!-- 新后台管理弹出框开始-->
<div id="managerWin" class="managerWin" style="display: none;">

</div>
<!-- 新后台管理弹出框结束 -->

	

	 <div id="street_view" class="streeView"><a style="float: right;">关闭</a>
	 	
	 </div>

<div id="popuWin" class="yijian_fankui_wrap">
</div>
</body>
</html>